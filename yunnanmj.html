<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><script type="text/javascript">
var version = {major: 1, minor: 2, revision: 37, date: new Date("Oct 30, 2005"), extensions: {}};
</script>
<!--
TiddlyWiki 1.2.37 by Jeremy Ruston, (jeremy [at] osmosoft [dot] com)

Published under a BSD open source license

Copyright (c) Osmosoft Limited 2005

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright notice, this
list of conditions and the following disclaimer in the documentation and/or other
materials provided with the distribution.

Neither the name of the Osmosoft Limited nor the names of its contributors may be
used to endorse or promote products derived from this software without specific
prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.
-->


<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>七彩云南 - 彩云之南，梦的方向</title>
<script type="text/javascript">

// ---------------------------------------------------------------------------------
// Configuration repository
// ---------------------------------------------------------------------------------

var config = {
	// Options that can be set in the options panel and/or cookies
	options: {
		chkRegExpSearch: false,
		chkCaseSensitiveSearch: false,
		chkAnimate: true,
		txtUserName: "YourName",
		chkSaveBackups: true,
		chkAutoSave: false,
		chkGenerateAnRssFeed: false,
		chkSaveEmptyTemplate: false,
		chkOpenInNewWindow: true,
		chkToggleLinks: false,
		chkHttpReadOnly: false,
		chkForceMinorUpdate: false,
		txtMainTab: "tabTimeline",
		txtMoreTab: "moreTabAll"
		},
	// List of notification functions to be called when certain tiddlers are changed or deleted
	notifyTiddlers: [
		{name: "StyleSheetColors", notify: refreshStyles},
		{name: "StyleSheetLayout", notify: refreshStyles},
		{name: "StyleSheet", notify: refreshStyles},
		{name: null, notify: refreshMenu},
		{name: null, notify: refreshStory},
		{name: null, notify: refreshTabs},
		{name: "SiteTitle", notify: refreshTitle},
		{name: "SiteSubtitle", notify: refreshSubtitle},
		{name: "SideBarOptions", notify: refreshSidebar}
		],
	// Shadow tiddlers for emergencies
	shadowTiddlers: {
		SideBarOptions: "<<gradient vert #ffffff #cc9900>><<search>><<closeAll>><<permaview>><<saveChanges>><<slider chkSliderOptionsPanel OptionsPanel options 'Change TiddlyWiki advanced options'>>>>",
		OptionsPanel: "These InterfaceOptions for customising TiddlyWiki are saved in your browser\n\nYour username for signing your edits. Write it as a WikiWord (eg JoeBloggs)\n\n<<option txtUserName>>\n<<option chkSaveBackups>> SaveBackups\n<<option chkAutoSave>> AutoSave\n<<option chkGenerateAnRssFeed>> GenerateAnRssFeed\n<<option chkRegExpSearch>> RegExpSearch\n<<option chkCaseSensitiveSearch>> CaseSensitiveSearch\n<<option chkAnimate>> EnableAnimations\n\nSee AdvancedOptions",
		AdvancedOptions: "<<option chkOpenInNewWindow>> OpenLinksInNewWindow\n<<option chkSaveEmptyTemplate>> SaveEmptyTemplate\n<<option chkToggleLinks>> Clicking on links to tiddlers that are already open causes them to close\n^^(override with Control or other modifier key)^^\n<<option chkHttpReadOnly>> HideEditingFeatures when viewed over HTTP\n<<option chkForceMinorUpdate>> Treat edits as MinorChanges by preserving date and time\n^^(override with Shift key when clicking 'done' or by pressing Ctrl-Shift-Enter^^",
		SideBarTabs: "<<tabs txtMainTab Timeline Timeline TabTimeline All 'All tiddlers' TabAll Tags 'All tags' TabTags More 'More lists' TabMore>>",
		TabTimeline: "<<timeline>>",
		TabAll: "<<list all>>",
		TabTags: "<<allTags>>",
		TabMore: "<<tabs txtMoreTab Missing 'Missing tiddlers' TabMoreMissing Orphans 'Orphaned tiddlers' TabMoreOrphans>>",
		TabMoreMissing: "<<list missing>>",
		TabMoreOrphans: "<<list orphans>>"
		},
	// Miscellaneous options
	numRssItems: 20, // Number of items in the RSS feed
	animFast: 0.12, // Speed for animations (lower == slower)
	animSlow: 0.01, // Speed for EasterEgg animations
	// Messages
	messages: {
		customConfigError: "Error in systemConfig tiddler '%1' - %0",
		savedSnapshotError: "It appears that this TiddlyWiki has been incorrectly saved. Please see http://www.tiddlywiki.com/#DownloadSoftware for details",
		subtitleUnknown: "(unknown)",
		undefinedTiddlerToolTip: "The tiddler '%0' doesn't yet exist",
		shadowedTiddlerToolTip: "The tiddler '%0' doesn't yet exist, but has a pre-defined shadow value",
		externalLinkTooltip: "External link to %0",
		noTags: "There are no tagged tiddlers",
		notFileUrlError: "You need to save this TiddlyWiki to a file before you can save changes",
		cantSaveError: "It's not possible to save changes using this browser. Use FireFox if you can",
		invalidFileError: "The original file '%0' does not appear to be a valid TiddlyWiki",
		backupSaved: "Backup saved",
		backupFailed: "Failed to save backup file",
		rssSaved: "RSS feed saved",
		rssFailed: "Failed to save RSS feed file",
		emptySaved: "Empty template saved",
		emptyFailed: "Failed to save empty template file",
		mainSaved: "Main TiddlyWiki file saved",
		mainFailed: "Failed to save main TiddlyWiki file. Your changes have not been saved",
		macroError: "Error executing macro '%0'",
		overwriteWarning: "A tiddler named '%0' already exists. Choose OK to overwrite it",
		unsavedChangesWarning: "WARNING! There are unsaved changes in TiddlyWiki\n\nChoose OK to save\nChoose CANCEL to discard",
		dates: {
			months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November","December"],
			days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]
			}
		},
	views: {
		wikified: {
			tag: {labelNoTags: "no tags", labelTags: "tags: ", tooltip: "Show tiddlers tagged with '%0'", openAllText: "Open all", openAllTooltip: "Open all of these tiddlers", popupNone: "No other tiddlers tagged with '%0'"},
			toolbarClose: {text: "close", tooltip: "Close this tiddler"},
			toolbarEdit: {text: "edit", tooltip: "Edit this tiddler"},
			toolbarPermalink: {text: "permalink", tooltip: "Permalink for this tiddler"},
			toolbarReferences: {text: "references", tooltip: "Show tiddlers that link to this one", popupNone: "No references"},
			defaultText: "The tiddler '%0' doesn't yet exist. Double-click to create it"
			},
		editor: {
			tagPrompt: "Type tags separated with spaces, [[use double square brackets]] if necessary, or add existing",
			tagChooser: {text: "tags", tooltip: "Choose existing tags to add to this tiddler", popupNone: "There are no tags defined", tagTooltip: "Add the tag '%0'"},
			toolbarDone: {text: "done", tooltip: "Save changes to this tiddler"},
			toolbarCancel: {text: "cancel", tooltip: "Undo changes to this tiddler"},
			toolbarDelete: {text: "delete", tooltip: "Delete this tiddler"},
			defaultText: "Type the text for '%0'"
			}
		},
	macros: { // Each has a 'handler' member that is inserted later
		today: {},
		version: {},
		search: {label: "search", prompt: "Search this TiddlyWiki", sizeTextbox: 15, accessKey: "F", successMsg: "%0 tiddlers found matching %1", failureMsg: "No tiddlers found matching %0"},
		tiddler: {},
		tag: {},
		timeline: {dateFormat: "DD MMM YYYY"},
		allTags: {tooltip: "Show tiddlers tagged with '%0'", noTags: "There are no tagged tiddlers"},
		list: {
			all: {prompt: "All tiddlers in alphabetical order"},
			missing: {prompt: "Tiddlers that have links to them but are not defined"},
			orphans: {prompt: "Tiddlers that are not linked to from any other tiddlers"},
			shadowed: {prompt: "Tiddlers shadowed with default contents"}
			},
		closeAll: {label: "close all", prompt: "Close all displayed tiddlers (except any that are being edited)"},
		permaview: {label: "permaview", prompt: "Link to an URL that retrieves all the currently displayed tiddlers"},
		saveChanges: {label: "save changes", prompt: "Save all tiddlers to create a new TiddlyWiki", accessKey: "S"},
		slider: {},
		option: {},
		newTiddler: {label: "new tiddler", prompt: "Create a new tiddler", title: "New Tiddler", accessKey: "N"},
		newJournal: {label: "new journal", prompt: "Create a new tiddler from the current date and time", accessKey: "J"},
		sparkline: {},
		tabs: {},
		gradient: {}
		},
	textPrimitives: {}
};

config.textPrimitives.upperLetter = "[A-Z\u00c0-\u00de\u0150\u0170]";
config.textPrimitives.lowerLetter = "[a-z\u00df-\u00ff_0-9\\-\u0151\u0171]";
config.textPrimitives.anyLetter = "[A-Za-z\u00c0-\u00de\u00df-\u00ff_0-9\\-\u0150\u0170\u0151\u0171]";
config.textPrimitives.anyDigit = "[0-9]";
config.textPrimitives.anyNumberChar = "[0-9\\.E]";
config.textPrimitives.urlPattern = "(?:http|https|mailto|ftp):[^\\s'\"]+(?:/|\\b)";
config.textPrimitives.unWikiLink = "~";
config.textPrimitives.wikiLink = "(?:" + config.textPrimitives.unWikiLink + "{0,1})(?:(?:" + config.textPrimitives.upperLetter + "+" +
											   config.textPrimitives.lowerLetter + "+" +
											   config.textPrimitives.upperLetter +
											   config.textPrimitives.anyLetter + "*)|(?:" +
											   config.textPrimitives.upperLetter + "{2,}" +
											   config.textPrimitives.lowerLetter + "+))";

// ---------------------------------------------------------------------------------
// Shadow stylesheet elements
// ---------------------------------------------------------------------------------

config.shadowTiddlers.StyleSheetColors = "body {\n	background: #fff;\n}\n\n#titleLine {\n	color: #fff;\n	background: #300;\n}\n\n#titleLine a {\n	color: #cf6;\n}\n\n#mainMenu {\n	color: #000;\n}\n\n#mainMenu .tiddlyLink {\n	color: #963;\n}\n\n#mainMenu .tiddlyLink:hover {\n	background: #963;\n	color: #fff;\n}\n\n#mainMenu .externalLink {\n	color: #963;\n}\n\n#mainMenu .externalLink:hover {\n	background: #963;\n	color: #fff;\n}\n\n#mainMenu .button {\n	color: #930;\n}\n\n#mainMenu .button:hover {\n	color: #cf6;\n	background: #930;\n}\n\n#messageArea {\n	background: #930;\n	color: #fff;\n}\n\n#messageArea a:link, #messageArea a:visited {\n	color: #c90;\n}\n\n#messageArea a:hover {\n	color: #963;\n}\n\n#messageArea a:active {\n	color: #fff;\n}\n\n.popup {\n	background: #eea;\n	border: 1px solid #930;\n}\n\n.popup hr {\n	color: #963;\n	background: #963;\n	border: 0;\n}\n\n.popup li.disabled {\n	color: #ba9;\n}\n\n.popup li a, .popup li a:visited {\n	color: #300;\n}\n\n.popup li a:hover {\n	background: #930;\n	color: #eea;\n}\n\n.tabSelected {\n	background: #eea;\n}\n\n.tabUnselected {\n	background: #c90;\n}\n\n.tabContents {\n	background: #eea;\n}\n\n.tiddler .button {\n	color: #930;\n}\n\n.tiddler .button:hover {\n	color: #cf6;\n	background: #930;\n}\n\n.tiddler .button:active {\n	color: #fff;\n	background: #c90;\n}\n\n.toolbar {\n	color: #aaa;\n}\n\n.footer {\n	color: #ddd;\n}\n\n.selectedTiddler .footer {\n	color: #888;\n}\n\n.viewer {\n	color: #000;\n}\n\n.viewer a:link, .body a:visited {\n	color: #963;\n}\n\n.viewer a:hover {\n	color: #fff;\n	background: #963;\n}\n\n.viewer .button {\n	background: #c90;\n	color: #300;\n	border-right: 1px solid #300;\n	border-bottom: 1px solid #300;\n}\n\n.viewer .button:hover {\n	background: #eea;\n	color: #c90;\n}\n\n.viewer blockquote {\n	border-left: 3px solid #666;\n}\n\n.viewer h1,.viewer h2,.viewer h3,.viewer h4,.viewer h5 {\n	background: #cc9;\n}\n\n.viewer table {\n	border: 2px solid #303030;\n}\n\n.viewer th {\n	background: #996;\n	border: 1px solid #606060;\n	color: #fff;\n}\n\n.viewer td, .viewer tr {\n	border: 1px solid #606060;\n}\n\n.viewer pre {\n	color: #000000;\n	border: 1px solid #963;\n	background: #eea;\n}\n\n.viewer code {\n	color: #630;\n}\n\n.viewer hr {\n	border-top: dashed 1px #606060;\n	border-left: none;\n	border-right: none;\n	border-bottom: none;\n	color: #666;\n}\n\n.highlight, .marked {\n	color: #000;\n	background: #ffe72f;\n}\n\n.editor {\n	color: #402C74;\n}\n\n.editor input {\n	border: 1px solid #000000;\n}\n\n.editor textarea {\n	border: 1px solid #000000;\n	width: 100%;\n}\n\n.editorFooter {\n	color: #aaa;\n}\n\n.editorFooter A {\n	color: #930;\n}\n\n.editorFooter A:hover {\n	color: #cf6;\n	background: #930;\n}\n\n.editorFooter A:active {\n	color: #fff;\n	background: #c90;\n}\n\n#sidebar {\n	color: #000;\n}\n\n#sidebarOptions {\n	background: #c90;\n}\n\n#sidebarOptions .button {\n	color: #930;\n}\n\n#sidebarOptions .button:hover {\n	color: #cf6;\n	background: #930;\n}\n\n#sidebarOptions .button:active {\n	color: #930;\n	background: #cf6;\n}\n\n#sidebarOptions .sliderPanel {\n	background: #eea;\n}\n\n#sidebarOptions .sliderPanel A {\n	color: #930;\n}\n\n#sidebarOptions .sliderPanel A:hover {\n	color: #cf6;\n	background: #930;\n}\n\n#sidebarOptions .sliderPanel A:active {\n	color: #930;\n	background: #cf6;\n}\n\n.sidebarSubHeading {\n	color: #300;\n}\n\n#sidebarTabs {\n	background: #c90;\n}\n\n#sidebarTabs .tabSelected {\n	color: #cf6;\n	background: #963;\n}\n\n#sidebarTabs .tabUnselected {\n	color: #cf6;\n	background: #930;\n}\n\n#sidebarTabs .tabContents {\n	background: #963;\n}\n\n\n#sidebarTabs .txtMoreTab .tabSelected {\n	background: #930;\n}\n\n#sidebarTabs .txtMoreTab .tabUnselected {\n	background: #300;\n}\n\n#sidebarTabs .txtMoreTab .tabContents {\n	background: #930;\n}\n\n#sidebarTabs .tabContents .tiddlyLink {\n	color: #cf6;\n}\n\n#sidebarTabs .tabContents .tiddlyLink:hover {\n	background: #ccff66;\n	color: #300;\n}\n\n#sidebarTabs .tabContents .button {\n	color: #cf6;\n}\n\n#sidebarTabs .tabContents .button:hover {\n	color: #300;\n	background: #cf6;\n}\n\n.sparkline {\n	background: #eea;\n	border: 0;\n}\n\n.sparktick {\n	background: #930;\n}\n\n.errorNoSuchMacro {\n	color: #ff0;\n	background: #f00;\n}\n\n.zoomer {\n	color: #963;\n	border: 1px solid #963;\n}";
config.shadowTiddlers.StyleSheetLayout = "body {\n	font-size: 9pt;\n	font-family: verdana,arial,helvetica;\n	margin: 0;\n	padding: 0;\n	position: relative;\n	z-index: 0;\n}\n\na:link, a:visited, a:hover, a:active{\n	text-decoration: none;\n}\n\n#contentWrapper {\n	position: relative;\n}\n\n#titleLine {\n	padding: 5em 1em 1em 1em;\n}\n\n#siteTitle {\n	font-size: 26pt;\n}\n\n#siteSubtitle {\n	padding-left: 1em;\n	font-size: 10pt;\n}\n\n#mainMenu {\n	position: absolute;\n	left: 0em;\n	width: 10em;\n	line-height: 166%;\n	padding: 1.5em 0.5em 0.5em 0.5em;\n	font-size: 10pt;\n	text-align: right;\n}\n\n\n#mainMenu .externalLink {\n	text-decoration: underline;\n}\n\n#displayArea {\n	margin: 1em 17em 0em 14em;\n}\n\n#messageArea {\n	padding: 0.5em;\n\n}\n\n#messageArea a:link, #messageArea a:visited {\n	display: inline;\n	text-decoration: underline;\n}\n\n.popup {\n	font-size: 8pt;\n	list-style: none;\n	padding: 0.2em;\n	margin: 0;\n}\n\n.popup hr {\n	display: block;\n	height: 1px;\n	width: auto;\n	padding: 0;\n	margin: 0.2em 0em;\n}\n\n.popup li {\n	display: block;\n	padding: 0;\n}\n\n.popup li.disabled {\n	padding: 0.2em;\n}\n\n.popup li a, .popup li a:visited {\n	display: block;\n	text-decoration: none;\n	padding: 0.2em;\n}\n\n.tabset {\n	padding: 1em 0em 0em 0.5em;\n}\n\n.tab {\n	margin: 0em 0em 0em 0.25em;\n	padding: 2px;\n}\n\n.tabContents {\n	padding: 0.5em;\n}\n\n.tabContents ul, .tabContents ol {\n	margin: 0;\n	padding: 0;\n}\n\n.tabContents li {\n	list-style: none;\n}\n\n.tabContents li.listLink {\n   margin-left: .75em;\n}\n\n.tiddler {\n	padding: 0;\n	padding: 1em 1em 0em 1em;\n	font-size: 9pt;\n}\n\n\n/* Can these styles be moved to the previous rule?\n.selectedTiddler {\n	padding: 1em 1em 0em 1em;\n	font-size: 9pt;\n}\n\n.unselectedTiddler {\n	padding: 1em 1em 0em 1em;\n	font-size: 9pt;\n} */\n\n.tiddler a.tiddlyLinkExisting {\n	font-weight: bold;\n}\n\n.tiddler a.tiddlyLinkNonExisting {\n	font-style: italic;\n}\n\n.tiddler a.tiddlyLinkNonExisting.shadow {\n	font-weight: bold;\n}\n\n.tiddler a.externalLink {\n	text-decoration: underline;\n}\n\n.tiddler .button {\n	padding: 0.2em 0.4em;\n}\n\n.tiddler .button:hover {\n	text-decoration: none;\n}\n\n.title {\n	font-size: 10pt;\n	font-weight: bold;\n}\n\n.shadow .title {\n	color: #888888;\n}\n\n.toolbar {\n	text-align: right;\n	font-weight: normal;\n	font-size: 8pt;\n	padding: 0;\n	padding-bottom: 2em;\n	visibility: hidden;\n}\n\n.selectedTiddler .toolbar {\n	visibility: visible;\n}\n\n.footer {\n/* Isn't 'clear:both' the right rule? */\n	clear: left;\n	clear: right;\n	font-weight: normal;\n	font-size: 8pt;\n	margin: 0;\n	padding: 0;\n}\n\n.body {\n	padding-top: 0.5em;\n}\n\n.viewer {\n	line-height: 140%;\n}\n\n.viewer .button {\n	margin: 0em 0.25em;\n	padding: 0em 0.25em;\n}\n\n.viewer blockquote {\n	font-size: 8pt;\n	line-height: 150%;\n	padding-left: 0.8em;\n	margin-left: 2.5em;\n}\n\n.viewer ul {\n	margin-left: 0.5em;\n	padding-left: 1.5em;\n}\n\n.viewer ol {\n	margin-left: 0.5em;\n	padding-left: 1.5em;\n}\n\n.viewer h1,.viewer h2,.viewer h3,.viewer h4,.viewer h5 {\n	font-weight: bold;\n	text-decoration: none;\n	padding-left: 0.4em;\n}\n\n.viewer h1 {font-size: 12pt;}\n.viewer h2 {font-size: 11pt;}\n.viewer h3 {font-size: 10pt;}\n.viewer h4 {font-size: 9pt;}\n.viewer h5 {font-size: 8pt;}\n\n.viewer table {\n	border-collapse: collapse;\n	margin: 0.8em 1.0em;;\n	font-size: 100%;\n}\n\n.viewer th, .viewer td, .viewer tr,.viewer caption{\n	padding: 3px;\n}\n\n.viewer pre {\n	padding: 0.5em;\n	margin-left: 0.5em;\n	font-size: 100%;\n	line-height: 1.4em;\n	overflow: auto;\n}\n\n.viewer code {\n	font-size: 100%;\n	line-height: 1.4em;\n}\n\n.viewer hr {\n	height: 1px;\n}\n\n.editor {\n	font-size: 8pt;\n	font-weight: normal;\n}\n\n.editor input {\n	display: block;\n	width: 100%;\n}\n\n.editor textarea {\n	display: block;\n	font: inherit;\n	width: 100%;\n}\n\n.editorFooter {\n	padding: 0.25em 0em;\n	font-size: 8pt;\n}\n\n.editorFooter A {\n	padding: 0.2em 0.4em;\n}\n\n.editorFooter A:hover {\n	text-decoration: none;\n}\n\n#sidebar {\n	position: absolute;\n	right: 0em;\n	width: 16em;\n	font-size: 8pt;\n}\n\n#sidebarOptions {\n	padding-top: 0em;\n}\n\n#sidebarOptions .button {\n	padding: 0.3em 0.2em 0.3em 1em;\n	display: block;\n}\n\n#sidebarOptions input {\n	margin: 0.4em 0em 0.3em 1em;\n}\n\n#sidebarOptions .sliderPanel {\n	padding: 0.5em;\n	font-size: 7pt;\n}\n\n#sidebarOptions .sliderPanel A {\n	font-weight: bold;\n}\n\n#sidebarOptions .sliderPanel input {\n	margin: 0;\n	margin-bottom: 0.3em;\n}\n\n.sidebarSubHeading {\n	font-size: 7pt;\n}\n\n#sidebarTabs .tabSelected {\n	position: relative;\n	top: -2px;\n}\n\n\n#sidebarTabs .tabContents {\n	width: 15em;\n	overflow: hidden;\n}\n\n.sparkline {\n	line-height: 100%;\n}\n\n.sparktick {\n	outline: 0;\n}\n\n.zoomer {\n	font-size: 10pt;\n	position: absolute;\n	padding: 1em;\n}\n";

// ---------------------------------------------------------------------------------
// Main
// ---------------------------------------------------------------------------------

// TiddlyWiki storage
var store = new TiddlyWiki();

// Animation engine
var anim = new Animator();

var readOnly = false;

// Starting up
function main()
{
	browserTests();
	addEvent(document,"click",Popup.onDocumentClick);
	saveTest();
	loadOptionsCookie();
	for(var s=0; s<config.notifyTiddlers.length; s++)
		store.addNotification(config.notifyTiddlers[s].name,config.notifyTiddlers[s].notify);
	store.loadFromDiv("storeArea","store");
	loadSystemConfig();
	readOnly = (document.location.toString().substr(0,7) == "http://") ? config.options.chkHttpReadOnly : false;
	store.notifyAll();
	restart();
}

// Restarting
function restart()
{
	var start = store.getTiddlerText("DefaultTiddlers");
	if(window.location.hash)
		displayTiddlers(null,convertUTF8ToUnicode(decodeURI(window.location.hash.substr(1))),1,null,null);
	else if(start)
		displayTiddlers(null,start,1,null,null);
}

// Shame...
function browserTests()
{
	var a = navigator.userAgent.toLowerCase();
	config.browser = {
		isIE: a.indexOf("msie") != -1 && a.indexOf("opera") == -1
		};
}

function saveTest()
{
	var saveTest = document.getElementById("saveTest");
	if(saveTest.hasChildNodes())
		alert(config.messages.savedSnapshotError);
	saveTest.appendChild(document.createTextNode("savetest"));
}

function loadSystemConfig()
{
	var configTiddlers = store.getTaggedTiddlers("systemConfig");
	for(var t=0; t<configTiddlers.length; t++)
		{
		var ex = processConfig(configTiddlers[t].text);
		if(ex)
			displayMessage(config.messages.customConfigError.format([ex,configTiddlers[t].title]));
		}
}

// Merge a custom configuration over the top of the current configuration
// Returns a string error message or null if it went OK
function processConfig(customConfig)
{
	try
		{
		if(customConfig && customConfig != "")
			window.eval(customConfig);
		}
	catch(e)
		{
		return(e.toString());
		}
	return null;
}

// ---------------------------------------------------------------------------------
// Formatters
// ---------------------------------------------------------------------------------

config.formatterHelpers = {

	charFormatHelper: function(w)
	{
		var e = createTiddlyElement(w.output,this.element);
		w.subWikify(e,this.terminator);
	},
	
	inlineCssHelper:  function(w)
	{
		var styles = [];
		var lookahead = "(?:(" + config.textPrimitives.anyLetter + "+)\\(([^\\)\\|\\n]+)(?:\\):))|(?:(" + config.textPrimitives.anyLetter + "+):([^;\\|\\n]+);)";
		var lookaheadRegExp = new RegExp(lookahead,"mg");
		var hadStyle = false;
		do {
			lookaheadRegExp.lastIndex = w.nextMatch;
			var lookaheadMatch = lookaheadRegExp.exec(w.source);
			var gotMatch = lookaheadMatch && lookaheadMatch.index == w.nextMatch;
			if(gotMatch)
				{
				var s,v;
				hadStyle = true;
				if(lookaheadMatch[1])
					{
					s = lookaheadMatch[1].unDash();
					v = lookaheadMatch[2];
					}
				else
					{
					s = lookaheadMatch[3].unDash();
					v = lookaheadMatch[4];
					}
				switch(s)
					{
					case "bgcolor": s = "backgroundColor"; break;
					}
				styles.push({style: s, value: v});
				w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
				}
		} while(gotMatch);
		return styles;
	},

	monospacedByLineHelper: function(w)
	{
		var lookaheadRegExp = new RegExp(this.lookahead,"mg");
		lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			{
			var text = lookaheadMatch[1];
			if(config.browser.isIE)
				text = text.replace(/\n/g,"\r");
			var e = createTiddlyElement(w.output,"pre",null,null,text);
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
			}
	}

};

config.formatters = [
{
	name: "table",
	match: "^\\|(?:[^\\n]*)\\|(?:[fhc]?)$",
	lookahead: "^\\|([^\\n]*)\\|([fhc]?)$",
	rowTerminator: "\\|(?:[fhc]?)$\\n?",
	cellPattern: "(?:\\|([^\\n\\|]*)\\|)|(\\|[fhc]?$\\n?)",
	cellTerminator: "(?:\\x20*)\\|",
	rowTypes: {"c": "caption", "h": "thead", "": "tbody", "f": "tfoot"},
	handler: function(w)
	{
		var table = createTiddlyElement(w.output,"table");
		w.nextMatch = w.matchStart;
		var lookaheadRegExp = new RegExp(this.lookahead,"mg");
		var currRowType = null, nextRowType;
		var rowContainer, rowElement;
		var prevColumns = [];
		var rowCount = 0;
		do {
			lookaheadRegExp.lastIndex = w.nextMatch;
			var lookaheadMatch = lookaheadRegExp.exec(w.source);
			var matched = lookaheadMatch && lookaheadMatch.index == w.nextMatch;
			if(matched)
				{
				nextRowType = lookaheadMatch[2];
				if(nextRowType != currRowType)
					rowContainer = createTiddlyElement(table,this.rowTypes[nextRowType]);
				currRowType = nextRowType;
				if(currRowType == "c")
					{
					if(rowCount == 0)
						rowContainer.setAttribute("align","top");
					else
						rowContainer.setAttribute("align","bottom");
					w.nextMatch = w.nextMatch + 1;
					w.subWikify(rowContainer,this.rowTerminator);
					}
				else
					{
					rowElement = createTiddlyElement(rowContainer,"tr");
					this.rowHandler(w,rowElement,prevColumns);
					}
				rowCount++;
				}
		} while(matched);
	},
	rowHandler: function(w,e,prevColumns)
	{
		var col = 0;
		var currColCount = 1;
		var cellRegExp = new RegExp(this.cellPattern,"mg");
		do {
			cellRegExp.lastIndex = w.nextMatch;
			var cellMatch = cellRegExp.exec(w.source);
			matched = cellMatch && cellMatch.index == w.nextMatch;
			if(matched)
				{
				if(cellMatch[1] == "~")
					{
					var last = prevColumns[col];
					if(last)
						{
						last.rowCount++;
						last.element.setAttribute("rowSpan",last.rowCount);
						last.element.setAttribute("rowspan",last.rowCount);
						last.element.valign = "center";
						}
					w.nextMatch = cellMatch.index + cellMatch[0].length-1;
					}
				else if(cellMatch[1] == ">")
					{
					currColCount++;
					w.nextMatch = cellMatch.index + cellMatch[0].length-1;
					}
				else if(cellMatch[2])
					{
					w.nextMatch = cellMatch.index + cellMatch[0].length;;
					break;
					}
				else
					{
					var spaceLeft = false, spaceRight = false;
					w.nextMatch++;
					var styles = config.formatterHelpers.inlineCssHelper(w);
					while(w.source.substr(w.nextMatch,1) == " ")
						{
						spaceLeft = true;
						w.nextMatch++;
						}
					var cell;
					if(w.source.substr(w.nextMatch,1) == "!")
						{
						cell = createTiddlyElement(e,"th");
						w.nextMatch++;
						}
					else
						cell = createTiddlyElement(e,"td");
					prevColumns[col] = {rowCount: 1, element: cell};
					lastColCount = 1;
					lastColElement = cell;
					if(currColCount > 1)
						{
						cell.setAttribute("colSpan",currColCount);
						cell.setAttribute("colspan",currColCount);
						currColCount = 1;
						}
					for(var t=0; t<styles.length; t++)
						cell.style[styles[t].style] = styles[t].value;
					w.subWikify(cell,this.cellTerminator);
					if(w.matchText.substr(w.matchText.length-2,1) == " ")
						spaceRight = true;
					if(spaceLeft && spaceRight)
						cell.align = "center";
					else if (spaceLeft)
						cell.align = "right";
					else if (spaceRight)
						cell.align = "left";
					w.nextMatch = w.nextMatch-1;
					}
				col++;
				}
		} while(matched);		
	}
},

{
	name: "rule",
	match: "^----$\\n?",
	handler: function(w)
	{
		createTiddlyElement(w.output,"hr");
	}
},

{
	name: "heading",
	match: "^!{1,5}",
	terminator: "\\n",
	handler: function(w)
	{
		var e = createTiddlyElement(w.output,"h" + w.matchLength);
		w.subWikify(e,this.terminator);
	}
},

{
	name: "monospacedByLine",
	match: "^\\{\\{\\{\\n",
	lookahead: "^\\{\\{\\{\\n((?:^[^\\n]*\\n)+?)(^\\}\\}\\}$\\n?)",
	handler: config.formatterHelpers.monospacedByLineHelper
},

{
	name: "monospacedByLineForPlugin",
	match: "^//\\{\\{\\{\\n",
	lookahead: "^//\\{\\{\\{\\n\\n*((?:^[^\\n]*\\n)+?)(\\n*^//\\}\\}\\}$\\n?)",
	handler: config.formatterHelpers.monospacedByLineHelper
},

{
	name: "wikifyCommentForPlugin", 
	match: "^/\\*\\*\\*\\n",
	terminator: "^\\*\\*\\*/\\n",
	handler: function(w)
	{
		w.subWikify(w.output,this.terminator);
	}
},

{
	name: "quoteByBlock",
	match: "^<<<\\n",
	terminator: "^<<<\\n",
	handler: function(w)
	{
		var e = createTiddlyElement(w.output,"blockquote");
		w.subWikify(e,this.terminator);
	}
},

{
	name: "quoteByLine",
	match: "^>+",
	terminator: "\\n",
	element: "blockquote",
	handler: function(w)
	{
		var lookaheadRegExp = new RegExp(this.match,"mg");
		var placeStack = [w.output];
		var currLevel = 0;
		var newLevel = w.matchLength;
		var t;
		do {
			if(newLevel > currLevel)
				{
				for(t=currLevel; t<newLevel; t++)
					placeStack.push(createTiddlyElement(placeStack[placeStack.length-1],this.element));
				}
			else if(newLevel < currLevel)
				{
				for(t=currLevel; t>newLevel; t--)
					placeStack.pop();
				}
			currLevel = newLevel;
			w.subWikify(placeStack[placeStack.length-1],this.terminator);
			createTiddlyElement(placeStack[placeStack.length-1],"br");
			lookaheadRegExp.lastIndex = w.nextMatch;
			var lookaheadMatch = lookaheadRegExp.exec(w.source);
			var matched = lookaheadMatch && lookaheadMatch.index == w.nextMatch;
			if(matched)
				{
				newLevel = lookaheadMatch[0].length;
				w.nextMatch += lookaheadMatch[0].length;
				}
		} while(matched);
	}
},

{
	name: "list",
	match: "^(?:(?:\\*+)|(?:#+))",
	lookahead: "^(?:(\\*+)|(#+))",
	terminator: "\\n",
	outerElement: "ul",
	itemElement: "li",
	handler: function(w)
	{
		var lookaheadRegExp = new RegExp(this.lookahead,"mg");
		w.nextMatch = w.matchStart;
		var placeStack = [w.output];
		var currType = null, newType;
		var currLevel = 0, newLevel;
		var t;
		do {
			lookaheadRegExp.lastIndex = w.nextMatch;
			var lookaheadMatch = lookaheadRegExp.exec(w.source);
			var matched = lookaheadMatch && lookaheadMatch.index == w.nextMatch;
			if(matched)
				{
				if(lookaheadMatch[1])
					newType = "ul";
				if(lookaheadMatch[2])
					newType = "ol";
				newLevel = lookaheadMatch[0].length;
				w.nextMatch += lookaheadMatch[0].length;
				if(newLevel > currLevel)
					{
					for(t=currLevel; t<newLevel; t++)
						placeStack.push(createTiddlyElement(placeStack[placeStack.length-1],newType));
					}
				else if(newLevel < currLevel)
					{
					for(t=currLevel; t>newLevel; t--)
						placeStack.pop();
					}
				else if(newLevel == currLevel && newType != currType)
					{
						placeStack.pop();
						placeStack.push(createTiddlyElement(placeStack[placeStack.length-1],newType));
					}
				currLevel = newLevel;
				currType = newType;
				var e = createTiddlyElement(placeStack[placeStack.length-1],"li");
				w.subWikify(e,this.terminator);
				}
		} while(matched);
	}
},

{
	name: "wikiLink",
	match: config.textPrimitives.wikiLink,
	badPrefix: config.textPrimitives.anyLetter,
	handler: function(w)
	{
		var preRegExp = new RegExp(config.textPrimitives.anyLetter,"mg");
		var preMatch = null;
		if(w.matchStart > 0)
			{
			preRegExp.lastIndex = w.matchStart-1;
			preMatch = preRegExp.exec(w.source);
			}
		if(preMatch && preMatch.index == w.matchStart-1)
			w.outputText(w.output,w.matchStart,w.nextMatch);
		else if(w.matchText.substr(0,1) == config.textPrimitives.unWikiLink)
			w.outputText(w.output,w.matchStart + 1,w.nextMatch);
		else
			{
			var link = createTiddlyLink(w.output,w.matchText,false);
			w.outputText(link,w.matchStart,w.nextMatch);
			}
	}
},

{
	name: "prettyLink",
	match: "\\[\\[",
	lookahead: "\\[\\[([^\\|\\]]*?)(?:(\\]\\])|(\\|(.*?)\\]\\]))",
	terminator: "\\|",
	handler: function(w)
	{
		var lookaheadRegExp = new RegExp(this.lookahead,"mg");
		lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = lookaheadRegExp.exec(w.source)
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart && lookaheadMatch[2]) // Simple bracketted link
			{
			var link = createTiddlyLink(w.output,lookaheadMatch[1],false);
			w.outputText(link,w.nextMatch,w.nextMatch + lookaheadMatch[1].length);
			w.nextMatch += lookaheadMatch[1].length + 2;
			}
		else if(lookaheadMatch && lookaheadMatch.index == w.matchStart && lookaheadMatch[3]) // Pretty bracketted link
			{
			var e;
			if(store.tiddlerExists(lookaheadMatch[4]))
				e = createTiddlyLink(w.output,lookaheadMatch[4],false);
			else
				e = createExternalLink(w.output,lookaheadMatch[4]);
			w.outputText(e,w.nextMatch,w.nextMatch + lookaheadMatch[1].length);
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
			}
	}
},

{
	name: "urlLink",
	match: "(?:http|https|mailto|ftp):[^\\s'\"]+(?:/|\\b)",
	handler: function(w)
	{
		var e = createExternalLink(w.output,w.matchText);
		w.outputText(e,w.matchStart,w.nextMatch);
	}
},

{
	name: "image",
	match: "\\[(?:[<]{0,1})(?:[>]{0,1})[Ii][Mm][Gg]\\[",
	lookahead: "\\[([<]{0,1})([>]{0,1})[Ii][Mm][Gg]\\[(?:([^\\|\\]]+)\\|)?([^\\[\\]\\|]+)\\](?:\\[([^\\]]*)\\]?)?(\\])",
	handler: function(w)
	{
		var lookaheadRegExp = new RegExp(this.lookahead,"mg");
		lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) // Simple bracketted link
			{
			var e = w.output;
			if(lookaheadMatch[5])
				{
				if(store.tiddlerExists(lookaheadMatch[5]))
					e = createTiddlyLink(w.output,lookaheadMatch[5],false);
				else
					e = createExternalLink(w.output,lookaheadMatch[5]);
				}
			var img = createTiddlyElement(e,"img");
			if(lookaheadMatch[1])
				img.align = "left";
			else if(lookaheadMatch[2])
				img.align = "right";
			if(lookaheadMatch[3])
				img.title = lookaheadMatch[3];
			img.src = lookaheadMatch[4];
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
			}
	}
},

{
	name: "macro",
	match: "<<",
	lookahead: "<<([^>\\s]+)(?:\\s*)([^>]*)>>",
	handler: function(w)
	{
		var lookaheadRegExp = new RegExp(this.lookahead,"mg");
		lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = lookaheadRegExp.exec(w.source)
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart && lookaheadMatch[1])
			{
			var params = lookaheadMatch[2].readMacroParams();			
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
			try
				{
				var macro = config.macros[lookaheadMatch[1]];
				if(macro && macro.handler)
					macro.handler(w.output,lookaheadMatch[1],params,w);
				else
					createTiddlyElement(w.output,"span",null,"errorNoSuchMacro","<<" + lookaheadMatch[1] + ">>");
				}
			catch(e)
				{
				displayMessage(config.messages.macroError.format([lookaheadMatch[1]]));
				displayMessage(e.toString());
				}
			}
	}
},

{
	name: "html",
	match: "<[Hh][Tt][Mm][Ll]>",
	lookahead: "<[Hh][Tt][Mm][Ll]>((?:.|\\n)*?)</[Hh][Tt][Mm][Ll]>",
	handler: function(w)
	{
		var lookaheadRegExp = new RegExp(this.lookahead,"mg");
		lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = lookaheadRegExp.exec(w.source)
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			{
			var e = createTiddlyElement(w.output,"span");
			e.innerHTML = lookaheadMatch[1];
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
			}
	}
},

{
	name: "commentByBlock",
	match: "/%",
	lookahead: "/%((?:.|\\n)*?)%/",
	handler: function(w)
	{
		var lookaheadRegExp = new RegExp(this.lookahead,"mg");
		lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = lookaheadRegExp.exec(w.source)
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
	}
},

{
	name: "boldByChar",
	match: "''",
	terminator: "''",
	element: "strong",
	handler: config.formatterHelpers.charFormatHelper
},

{
	name: "strikeByChar",
	match: "==",
	terminator: "==",
	element: "strike",
	handler: config.formatterHelpers.charFormatHelper
},

{
	name: "underlineByChar",
	match: "__",
	terminator: "__",
	element: "u",
	handler: config.formatterHelpers.charFormatHelper
},

{
	name: "italicByChar",
	match: "//",
	terminator: "//",
	element: "em",
	handler: config.formatterHelpers.charFormatHelper
},

{
	name: "subscriptByChar",
	match: "~~",
	terminator: "~~",
	element: "sub",
	handler: config.formatterHelpers.charFormatHelper
},

{
	name: "superscriptByChar",
	match: "\\^\\^",
	terminator: "\\^\\^",
	element: "sup",
	handler: config.formatterHelpers.charFormatHelper
},

{
	name: "monospacedByChar",
	match: "\\{\\{\\{",
	lookahead: "\\{\\{\\{((?:.|\\n)*?)\\}\\}\\}",
	handler: function(w)
	{
		var lookaheadRegExp = new RegExp(this.lookahead,"mg");
		lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = lookaheadRegExp.exec(w.source)
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			{
			var e = createTiddlyElement(w.output,"code",null,null,lookaheadMatch[1]);
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
			}
	}
},

{
	name: "styleByChar",
	match: "@@",
	terminator: "@@",
	lookahead: "(?:([^\\(@]+)\\(([^\\)]+)(?:\\):))|(?:([^:@]+):([^;]+);)",
	handler:  function(w)
	{
		var e = createTiddlyElement(w.output,"span",null,null,null);
		var styles = config.formatterHelpers.inlineCssHelper(w);
		if(styles.length == 0)
			e.className = "marked";
		else
			for(var t=0; t<styles.length; t++)
				e.style[styles[t].style] = styles[t].value;
		w.subWikify(e,this.terminator);
	}
},

{
	name: "lineBreak",
	match: "\\n",
	handler: function(w)
	{
		createTiddlyElement(w.output,"br");
	}
}
];

// ---------------------------------------------------------------------------------
// Wikifier
// ---------------------------------------------------------------------------------

function wikify(source,output,highlightText,highlightCaseSensitive)
{
	var w = new Wikifier(source,output,config.formatters,highlightText,highlightCaseSensitive);
}

function Wikifier(source,output,formatters,highlightText,highlightCaseSensitive)
{
	this.source = source;
	this.output = output;
	this.nextMatch = 0;
	this.highlightText = highlightText;
	this.highlightCaseSensitive = highlightCaseSensitive;
	this.highlightRegExp = null;
	this.highlightMatch = null;
	this.assembleFormatterMatches(formatters);
	if(highlightText)
		{
		this.highlightRegExp = new RegExp(highlightText,highlightCaseSensitive ? "mg" : "img");
		this.highlightMatch = this.highlightRegExp.exec(this.source);
		}
	if(source && source != "")
		this.subWikify(output,null);
	return this;
}

Wikifier.prototype.assembleFormatterMatches = function(formatters)
{
	this.formatters = [];
	var pattern = [];
	for(var n=0; n<formatters.length; n++)
		{
		pattern.push("(" + formatters[n].match + ")");
		this.formatters.push(formatters[n]);
		}
	this.formatterRegExp = new RegExp(pattern.join("|"),"mg");
}

Wikifier.prototype.subWikify = function(output,terminator)
{
	// Temporarily replace the output pointer
	var oldOutput = this.output;
	this.output = output;
	// Prepare the terminator RegExp
	var terminatorRegExp = terminator ? new RegExp("(" + terminator + ")","mg") : null;
	do {
		// Prepare the RegExp match positions
		this.formatterRegExp.lastIndex = this.nextMatch;
		if(terminatorRegExp)
			terminatorRegExp.lastIndex = this.nextMatch;
		// Get the first matches
		var formatterMatch = this.formatterRegExp.exec(this.source);
		var terminatorMatch = terminatorRegExp ? terminatorRegExp.exec(this.source) : null;
		// Check for a terminator match
		if(terminatorMatch && (!formatterMatch || terminatorMatch.index <= formatterMatch.index))
			{
			// Output any text before the match
			if(terminatorMatch.index > this.nextMatch)
				this.outputText(this.output,this.nextMatch,terminatorMatch.index);
			// Set the match parameters
			this.matchStart = terminatorMatch.index;
			this.matchLength = terminatorMatch[1].length;
			this.matchText = terminatorMatch[1];
			this.nextMatch = terminatorMatch.index + terminatorMatch[1].length;
			// Restore the output pointer and exit
			this.output = oldOutput;
			return;		
			}
		// Check for a formatter match
		else if(formatterMatch)
			{
			// Output any text before the match
			if(formatterMatch.index > this.nextMatch)
				this.outputText(this.output,this.nextMatch,formatterMatch.index);
			// Set the match parameters
			this.matchStart = formatterMatch.index;
			this.matchLength = formatterMatch[0].length;
			this.matchText = formatterMatch[0];
			this.nextMatch = this.formatterRegExp.lastIndex;
			// Figure out which formatter matched
			var matchingformatter = -1;
			for(var t=1; t<formatterMatch.length; t++)
				if(formatterMatch[t])
					matchingFormatter = t-1;
			// Call the formatter
			if(matchingFormatter != -1)
				this.formatters[matchingFormatter].handler(this);
			}
	} while(terminatorMatch || formatterMatch);
	// Output any text after the last match
	if(this.nextMatch < this.source.length)
		{
		this.outputText(this.output,this.nextMatch,this.source.length);
		this.nextMatch = this.source.length;
		}
	// Restore the output pointer
	this.output = oldOutput;
}

Wikifier.prototype.outputText = function(place,startPos,endPos)
{
	// Check for highlights
	while(this.highlightMatch && (this.highlightRegExp.lastIndex > startPos) && (this.highlightMatch.index < endPos) && (startPos < endPos))
		{
		// Deal with any plain text before the highlight
		if(this.highlightMatch.index > startPos)
			{
			createTiddlyText(place,this.source.substring(startPos,this.highlightMatch.index));
			startPos = this.highlightMatch.index;
			}
		// Deal with the highlight
		var highlightEnd = Math.min(this.highlightRegExp.lastIndex,endPos);
		var theHighlight = createTiddlyElement(place,"span",null,"highlight",this.source.substring(startPos,highlightEnd));
		startPos = highlightEnd;
		// Nudge along to the next highlight if we're done with this one
		if(startPos >= this.highlightRegExp.lastIndex)
			this.highlightMatch = this.highlightRegExp.exec(this.source);
		}
	// Do the unhighlighted text left over
	if(startPos < endPos)
		{
		createTiddlyText(place,this.source.substring(startPos,endPos));
		}
}

// ---------------------------------------------------------------------------------
// Macro definitions
// ---------------------------------------------------------------------------------

config.macros.today.handler = function(place,macroName,params)
{
	var now = new Date();
	var text;
	if(params[0])
		text = now.formatString(params[0].trim());
	else
		text = now.toLocaleString();
	createTiddlyElement(place,"span",null,null,text);
}

config.macros.version.handler = function(place)
{
	createTiddlyElement(place,"span",null,null,version.major + "." + version.minor + "." + version.revision + (version.beta ? " (beta " + version.beta + ")" : ""));
}

config.macros.list.handler = function(place,macroName,params)
{
	var type = params[0] ? params[0] : "all";
	var theList = document.createElement("ul");
	place.appendChild(theList);
	if(this[type].prompt)
		createTiddlyElement(theList,"li",null,"listTitle",this[type].prompt);
	var results;
	if(this[type].handler)
		results = this[type].handler(params);
	for (t = 0; t < results.length; t++)
		{
		theListItem = document.createElement("li")
		theList.appendChild(theListItem);
		if(typeof results[t] == "string")
			createTiddlyLink(theListItem,results[t],true);
		else
			createTiddlyLink(theListItem,results[t].title,true);
		}
}

config.macros.list.all.handler = function(params)
{
	return store.reverseLookup("tags","excludeLists",false,"title");
}

config.macros.list.missing.handler = function(params)
{
	return store.getMissingLinks();
}

config.macros.list.orphans.handler = function(params)
{
	return store.getOrphans();
}

config.macros.list.shadowed.handler = function(params)
{
	return store.getShadowed();
}

config.macros.allTags.handler = function(place,macroName,params)
{
	var tags = store.getTags();
	var theDateList = createTiddlyElement(place,"ul",null,null,null);
	if(tags.length == 0)
		createTiddlyElement(theDateList,"li",null,"listTitle",this.noTags);
	for (t=0; t<tags.length; t++)
		{
		var theListItem =createTiddlyElement(theDateList,"li",null,null,null);
		var theTag = createTiddlyButton(theListItem,tags[t][0] + " (" + tags[t][1] + ")",this.tooltip.format([tags[t][0]]),onClickTag);
		theTag.setAttribute("tag",tags[t][0]);
		}
}

config.macros.timeline.handler = function(place,macroName,params)
{
	var tiddlers = store.reverseLookup("tags","excludeLists",false,"modified");
	var lastDay = "";
	for (t=tiddlers.length-1; t>=0; t--)
		{
		var tiddler = tiddlers[t];
		var theDay = tiddler.modified.convertToYYYYMMDDHHMM().substr(0,8);
		if(theDay != lastDay)
			{
			var theDateList = document.createElement("ul");
			place.appendChild(theDateList);
			createTiddlyElement(theDateList,"li",null,"listTitle",tiddler.modified.formatString(this.dateFormat));
			lastDay = theDay;
			}
		var theDateListItem = createTiddlyElement(theDateList,"li",null,"listLink",null);
		theDateListItem.appendChild(createTiddlyLink(place,tiddler.title,true));
		}
}

config.macros.search.handler = function(place,macroName,params)
{
	var lastSearchText = "";
	var searchTimeout = null;
	var doSearch = function(txt)
		{
		closeAllTiddlers();
		var matches = store.search(txt.value,config.options.chkCaseSensitiveSearch,config.options.chkRegExpSearch,"title","excludeSearch");
		for(var t=matches.length-1; t>=0; t--)
			displayTiddler(null,matches[t].title,0,txt.value,config.options.chkCaseSensitiveSearch,false,false);
		var q = config.options.chkRegExpSearch ? "/" : "'";
		if(matches.length > 0)
			displayMessage(config.macros.search.successMsg.format([matches.length.toString(),q + txt.value + q]));
		else
			displayMessage(config.macros.search.failureMsg.format([q + txt.value + q]));
		lastSearchText = txt.value;
		};
	var clickHandler = function(e)
		{
		doSearch(this.nextSibling);
		return false;
		};
	var keyHandler = function(e)
		{
		if (!e) var e = window.event;
		switch(e.keyCode)
			{
			case 27:
				this.value = "";
				clearMessage();
				break;
			}
		if((this.value.length > 2) && (this.value != lastSearchText))
			{
			if(searchTimeout)
				clearTimeout(searchTimeout);
			var txt = this;
			searchTimeout = setTimeout(function() {doSearch(txt);},500);
			}
		};
	var focusHandler = function(e)
		{
		this.select();
		};
	var btn = createTiddlyButton(place,this.label,this.prompt,clickHandler);
	var txt = createTiddlyElement(place,"input",null,null,null);
	if(params[0])
		txt.value = params[0];
	txt.onkeyup = keyHandler;
	txt.onfocus = focusHandler;
	txt.setAttribute("size",this.sizeTextbox);
	txt.setAttribute("accessKey",this.accessKey);
	txt.setAttribute("autocomplete","off");
	if(navigator.userAgent.toLowerCase().indexOf("safari") == -1)
		txt.setAttribute("type","text");
	else
		{
		txt.setAttribute("type","search");
		txt.setAttribute("results","5");
		}
}

config.macros.tiddler.handler = function(place,macroName,params)
{
	var wrapper = createTiddlyElement(place,"span",null,params[1] ? params[1] : null,null);
	var text = store.getTiddlerText(params[0]);
	if(text)
		wikify(text,wrapper);
}

config.macros.tag.handler = function(place,macroName,params)
{
	createTagButton(place,params[0]);
}

config.macros.closeAll.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,function () {closeAllTiddlers(); return false;});
}

config.macros.permaview.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,function () {onClickPermaView(); return false;});
}

config.macros.saveChanges.handler = function(place)
{
	if(!readOnly)
		createTiddlyButton(place,this.label,this.prompt,function () {saveChanges(); return false;},null,null,this.accessKey);
}

config.macros.slider.onClickSlider = function(e)
{
	if (!e) var e = window.event;
	var n = this.nextSibling;
	var cookie = n.getAttribute("cookie");
	var isOpen = n.style.display != "none";
	if(config.options.chkAnimate)
		anim.startAnimating(new Slider(n,!isOpen,e.shiftKey || e.altKey,"none"));
	else
		n.style.display = isOpen ? "none" : "block";
	config.options[cookie] = !isOpen;
	saveOptionCookie(cookie);
	return false;
}

config.macros.slider.handler = function(place,macroName,params)
{
	var cookie = params[0] ? params[0] : "";
	var text = store.getTiddlerText(params[1]);
	var btn = createTiddlyButton(place,params[2],params[3],this.onClickSlider);
	var panel = createTiddlyElement(place,"div",null,"sliderPanel",null);
	panel.setAttribute("cookie",cookie);
	panel.style.display = config.options[cookie] ? "block" : "none";
	if(text)
		wikify(text,panel);
}

config.macros.option.onChangeOption = function(e)
{
	var opt = this.getAttribute("option");
	var elementType,valueField;
	if(opt)
		{
		switch(opt.substr(0,3))
			{
			case "txt":
				elementType = "input";
				valueField = "value";
				break;
			case "chk":
				elementType = "input";
				valueField = "checked";
				break;
			}
		config.options[opt] = this[valueField];
		saveOptionCookie(opt);
		var nodes = document.getElementsByTagName(elementType);
		for(var t=0; t<nodes.length; t++)
			{
			var optNode = nodes[t].getAttribute("option");
			if(opt == optNode)
				nodes[t][valueField] = this[valueField];
			}
		}
	return(true);
}

config.macros.option.handler = function(place,macroName,params)
{
	var opt = params[0];
	if(config.options[opt] == undefined)
		return;
	var c;
	switch(opt.substr(0,3))
		{
		case "txt":
			c = document.createElement("input");
			c.onkeyup = this.onChangeOption;
			c.setAttribute("option",opt);
			c.size = 15;
			place.appendChild(c);
			c.value = config.options[opt];
			break;
		case "chk":
			c = document.createElement("input");
			c.setAttribute("type","checkbox");
			c.onclick = this.onChangeOption;
			c.setAttribute("option",opt);
			place.appendChild(c);
			c.checked = config.options[opt];
			break;
		}
}

config.macros.newTiddler.onClick = function()
{
	displayTiddler(null,config.macros.newTiddler.title,2,null,null,false,false);
	var e = document.getElementById("editorTitle" + config.macros.newTiddler.title);
	e.focus();
	e.select();
	return false;
}

config.macros.newTiddler.handler = function(place)
{
	if(!readOnly)
		createTiddlyButton(place,this.label,this.prompt,this.onClick,null,null,this.accessKey);
}

config.macros.newJournal.handler = function(place,macroName,params)
{
	if(!readOnly)
		{
		var now = new Date();
		var title = now.formatString(params[0].trim());
		var createJournal = function() {
			displayTiddler(null,title,2,null,null,false,false);
			var tagsBox = document.getElementById("editorTags" + title);
			if(tagsBox && params[1])
				tagsBox.value += " " + String.encodeTiddlyLink(params[1]);
			return false;
			};
		createTiddlyButton(place,this.label,this.prompt,createJournal,null,null,this.accessKey);
		}
}

config.macros.sparkline.handler = function(place,macroName,params)
{
	var data = [];
	var min = 0;
	var max = 0;
	for(var t=0; t<params.length; t++)
		{
		var v = parseInt(params[t]);
		if(v < min)
			min = v;
		if(v > max)
			max = v;
		data.push(v);
		}
	if(data.length < 1)
		return;
	var box = createTiddlyElement(place,"span",null,"sparkline",String.fromCharCode(160));
	box.title = data.join(",");
	var w = box.offsetWidth;
	var h = box.offsetHeight;
	box.style.paddingRight = (data.length * 2 - w) + "px";
	box.style.position = "relative";
	for(var d=0; d<data.length; d++)
		{
		var tick = document.createElement("img");
		tick.border = 0;
		tick.className = "sparktick";
		tick.style.position = "absolute";
		tick.src = "data:image/gif,GIF89a%01%00%01%00%91%FF%00%FF%FF%FF%00%00%00%C0%C0%C0%00%00%00!%F9%04%01%00%00%02%00%2C%00%00%00%00%01%00%01%00%40%02%02T%01%00%3B";
		tick.style.left = d*2 + "px";
		tick.style.width = "2px";
		var v = Math.floor(((data[d] - min)/(max-min)) * h);
		tick.style.top = (h-v) + "px";
		tick.style.height = v + "px";
		box.appendChild(tick);
		}
}

config.macros.tabs.handler = function(place,macroName,params)
{
	var cookie = params[0];
	var numTabs = (params.length-1)/3;
	var wrapper = createTiddlyElement(place,"div",null,cookie,null);
	var tabset = createTiddlyElement(wrapper,"div",null,"tabset",null);
	tabset.setAttribute("cookie",cookie);
	var validTab = false;
	for(var t=0; t<numTabs; t++)
		{
		var label = params[t*3+1];
		var prompt = params[t*3+2];
		var content = params[t*3+3];
		var tab = createTiddlyButton(tabset,label,prompt,this.onClickTab,"tab tabUnselected");
		tab.setAttribute("tab",label);
		tab.setAttribute("content",content);
		tab.title = prompt;
		if(config.options[cookie] == label)
			validTab = true;
		}
	if(!validTab)
		config.options[cookie] = params[1];
	this.switchTab(tabset,config.options[cookie]);
}

config.macros.tabs.onClickTab = function(e)
{
	config.macros.tabs.switchTab(this.parentNode,this.getAttribute("tab"));
	return false;
}

config.macros.tabs.switchTab = function(tabset,tab)
{
	var cookie = tabset.getAttribute("cookie");
	var theTab = null
	var nodes = tabset.childNodes;
	for(var t=0; t<nodes.length; t++)
		if(nodes[t].getAttribute && nodes[t].getAttribute("tab") == tab)
			{
			theTab = nodes[t];
			theTab.className = "tab tabSelected";
			}
		else
			nodes[t].className = "tab tabUnselected"
	if(theTab)
		{
		if(tabset.nextSibling && tabset.nextSibling.className == "tabContents")
			tabset.parentNode.removeChild(tabset.nextSibling);
		var tabContent = createTiddlyElement(null,"div",null,"tabContents",null);
		tabset.parentNode.insertBefore(tabContent,tabset.nextSibling);
		wikify(store.getTiddlerText(theTab.getAttribute("content")),tabContent);
		if(cookie)
			{
			config.options[cookie] = tab;
			saveOptionCookie(cookie);
			}
		}
}

// <<gradient [[tiddler name]] vert|horiz rgb rgb rgb rgb... >>
config.macros.gradient.handler = function(place,macroName,params,wikifier)
{
	var terminator = ">>";
	var panel = createTiddlyElement(place,"div",null,"gradient",null);
	panel.style.position = "relative";
	panel.style.overflow = "hidden";
	var styles = config.formatterHelpers.inlineCssHelper(wikifier);
	var t;
	for(t=0; t<styles.length; t++)
		panel.style[styles[t].style] = styles[t].value;
	var colours = [];
	for(t=1; t<params.length; t++)
		{
		var c = new RGB(params[t]);
		if(c)
			colours.push(c);
		}
	drawGradient(panel,params[0] != "vert",colours);
	wikifier.subWikify(panel,terminator);
	if(document.all)
		{
		panel.style.height = "100%";
		panel.style.width = "100%";
		}
}

// ---------------------------------------------------------------------------------
// Tiddler() object
// ---------------------------------------------------------------------------------

function Tiddler()
{
	this.title = null;
	this.text = null;
	this.modifier = null;
	this.modified = new Date();
	this.links = [];
	this.tags = [];
	return this;
}

// Load a tiddler from an HTML DIV
Tiddler.prototype.loadFromDiv = function(divRef,title)
{
	var text = Tiddler.unescapeLineBreaks(divRef.firstChild ? divRef.firstChild.nodeValue : "");
	var modifier = divRef.getAttribute("modifier");
	var modified = Date.convertFromYYYYMMDDHHMM(divRef.getAttribute("modified"));
	var tags = divRef.getAttribute("tags");
	this.set(title,text,modifier,modified,tags);
	return this;
}

// Format the text for storage in an HTML DIV
Tiddler.prototype.saveToDiv = function()
{
	return '<div tiddler="' + this.title + '" modified="' +
							this.modified.convertToYYYYMMDDHHMM() + '" modifier="' + this.modifier +
							'" tags="' + this.getTags() + '">' +
							this.escapeLineBreaks().htmlEncode() + '</div>';
}

// Format the text for storage in an RSS item
Tiddler.prototype.saveToRss = function(url)
{
	var s = [];
	s.push("<item>");
	s.push("<title>" + this.title.htmlEncode() + "</title>");
	s.push("<description>" + this.text.replace(regexpNewLine,"<br />").htmlEncode() + "</description>");
	for(var t=0; t<this.tags.length; t++)
		s.push("<category>" + this.tags[t] + "</category>");
	s.push("<link>" + url + "#" + encodeURIComponent(String.encodeTiddlyLink(this.title)) + "</link>");
	s.push("<pubDate>" + this.modified.toGMTString() + "</pubDate>");
	s.push("</item>");
	return(s.join("\n"));
}

// Change the text and other attributes of a tiddler
Tiddler.prototype.set = function(title,text,modifier,modified,tags)
{
	if(title != undefined)
		this.title = title;
	if(text != undefined)
		this.text = text;
	if(modifier != undefined)
		this.modifier = modifier;
	if(modified != undefined)
		this.modified = modified;
	if(tags != undefined)
		this.tags = (typeof tags == "string") ? tags.readBracketedList() : tags;
	else
		this.tags = [];
	this.changed();
	return this;
}

// Get the tags for a tiddler as a string (space delimited, using [[brackets]] for tags containing spaces)
Tiddler.prototype.getTags = function()
{
	if(this.tags)
		{
		var results = [];
		for(var t=0; t<this.tags.length; t++)
			results.push(String.encodeTiddlyLink(this.tags[t]));
		return results.join(" ");
		}
	else
		return "";
}

var regexpBackSlashEn = new RegExp("\\\\n","mg");
var regexpBackSlash = new RegExp("\\\\","mg");
var regexpBackSlashEss = new RegExp("\\\\s","mg");
var regexpNewLine = new RegExp("\n","mg");
var regexpCarriageReturn = new RegExp("\r","mg");

// Static method to Convert "\n" to newlines, "\s" to "\"
Tiddler.unescapeLineBreaks = function(text)
{
	if(text && text != "")
		return text.replace(regexpBackSlashEn,"\n").replace(regexpBackSlashEss,"\\").replace(regexpCarriageReturn,"");
	else
		return "";
}

// Convert newlines to "\n", "\" to "\s"
Tiddler.prototype.escapeLineBreaks = function()
{
	return this.text.replace(regexpBackSlash,"\\s").replace(regexpNewLine,"\\n").replace(regexpCarriageReturn,"");
}

// Updates the secondary information (like links[] array) after a change to a tiddler
Tiddler.prototype.changed = function()
{
	this.links = [];
	var nextPos = 0;
	var theLink;
	var aliasedPrettyLink = "\\[\\[([^\\[\\]\\|]+)\\|([^\\[\\]\\|]+)\\]\\]";
	var prettyLink = "\\[\\[([^\\]]+)\\]\\]";
	var wikiNameRegExp = new RegExp("(" + config.textPrimitives.wikiLink + ")|(?:" + aliasedPrettyLink + ")|(?:" + prettyLink + ")","mg");
	do {
		var formatMatch = wikiNameRegExp.exec(this.text);
		if(formatMatch)
			{
			if(formatMatch[1] && formatMatch[1].substr(0,1) != config.textPrimitives.unWikiLink && formatMatch[1] != this.title)
				this.links.pushUnique(formatMatch[1]);
			else if(formatMatch[2] && store.tiddlerExists(formatMatch[3]))
				this.links.pushUnique(formatMatch[3]);
			else if(formatMatch[4] && formatMatch[4] != this.title)
				this.links.pushUnique(formatMatch[4]);
			}
	} while(formatMatch);
	return;
}

Tiddler.prototype.getSubtitle = function()
{
	var theModifier = this.modifier;
	if(!theModifier)
		theModifier = config.messages.subtitleUnknown;
	var theModified = this.modified;
	if(theModified)
		theModified = theModified.toLocaleString();
	else
		theModified = config.messages.subtitleUnknown;
	return(theModifier + ", " + theModified);
}

// ---------------------------------------------------------------------------------
// TiddlyWiki() object contains Tiddler()s
// ---------------------------------------------------------------------------------

function TiddlyWiki()
{
	this.tiddlers = {}; // Hashmap by name of tiddlers
	this.namedNotifications = []; // Array of {name:,notify:} of notification functions
	this.dirty = false;
}

// Set the dirty flag
TiddlyWiki.prototype.setDirty = function(dirty)
{
	this.dirty = dirty;
}

// Invoke the notification handlers for a particular tiddler
TiddlyWiki.prototype.notify = function(title,doBlanket)
{
	for(var t=0; t<this.namedNotifications.length; t++)
		{
		var n = this.namedNotifications[t];
		if((n.name == null && doBlanket) || n.name == title)
			n.notify(title);
		}
}

// Invoke the notification handlers for all tiddlers
TiddlyWiki.prototype.notifyAll = function()
{
	for(var t=0; t<this.namedNotifications.length; t++)
		{
		var n = this.namedNotifications[t];
		n.notify(n.name);
		}
}

// Add a notification handler to a tiddler
TiddlyWiki.prototype.addNotification = function(title,fn)
{
	for (var i=0; i<this.namedNotifications.length; i++)
		if((this.namedNotifications[i].name == title) && (this.namedNotifications[i].notify == fn))
			return this;
	this.namedNotifications.push({name: title, notify: fn});
	return this;
}

// Clear a TiddlyWiki so that it contains no tiddlers
TiddlyWiki.prototype.clear = function(src)
{
	this.tiddlers = {};
	this.dirty = false;
}

TiddlyWiki.prototype.removeTiddler = function(title)
{
	var tiddler = this.tiddlers[title];
	if(tiddler)
		{
		delete this.tiddlers[title];
		this.notify(title,true);
		this.dirty = true;
		}
}

TiddlyWiki.prototype.tiddlerExists = function(title)
{
	var t = this.tiddlers[title];
	var s = config.shadowTiddlers[title];
	return (t != undefined && t instanceof Tiddler) || (s != undefined && s instanceof String);
}

TiddlyWiki.prototype.getTiddlerText = function(title,defaultText)
{
	if(!title)
		return(defaultText);
	var tiddler = this.tiddlers[title];
	if(tiddler)
		return tiddler.text;
	else if(config.shadowTiddlers[title])
		return config.shadowTiddlers[title];
	else if(defaultText)
		return defaultText;
	else
		return null;
}

TiddlyWiki.prototype.getRecursiveTiddlerText = function(title,defaultText,depth)
{
	var bracketRegExp = new RegExp("(?:\\[\\[([^\\]]+)\\]\\])","mg");
	var text = this.getTiddlerText(title,defaultText);
	if(text == null)
		return "";
	var textOut = [];
	var lastPos = 0;
	do {
		var match = bracketRegExp.exec(text);
		if(match)
			{
			textOut.push(text.substr(lastPos,match.index-lastPos));
			if(match[1])
				{
				if(depth <= 0)
					textOut.push(match[1]);
				else
					textOut.push(this.getRecursiveTiddlerText(match[1],match[1],depth-1));
				}
			lastPos = match.index + match[0].length;
			}
		else
			textOut.push(text.substr(lastPos));
	} while(match);
	return(textOut.join(""));
}

TiddlyWiki.prototype.saveTiddler = function(title,newTitle,newBody,modifier,modified,tags)
{
	var tiddler = this.tiddlers[title];
	if(tiddler)
		delete this.tiddlers[title];
	else
		tiddler = new Tiddler();
	tiddler.set(newTitle,newBody,modifier,modified,tags);
	this.tiddlers[newTitle] = tiddler;
	if(title != newTitle)
		this.notify(title,true);
	this.notify(newTitle,true);
	this.dirty = true;
	return tiddler;
}

TiddlyWiki.prototype.createTiddler = function(title)
{
	tiddler = this.tiddlers[title];
	if(!tiddler)
		{
		tiddler = new Tiddler();
		this.tiddlers[title] = tiddler;
		this.dirty = true;
		}
	return tiddler;
}

// Load contents of a tiddlywiki from an HTML DIV
TiddlyWiki.prototype.loadFromDiv = function(srcID,idPrefix)
{
	if(document.normalize)
		document.normalize();
	var lenPrefix = idPrefix.length;
	var store = document.getElementById(srcID).childNodes;
	for(var t = 0; t < store.length; t++)
		{
		var e = store[t];
		var title = null;
		if(e.getAttribute)
			title = e.getAttribute("tiddler");
		if(!title && e.id && e.id.substr(0,lenPrefix) == idPrefix)
			title = e.id.substr(lenPrefix);
		if(title && title != "")
			{
			var tiddler = this.createTiddler(title);
			tiddler.loadFromDiv(e,title);
			}
		}
	this.dirty = false;
}

// Return an array of tiddlers matching a search string
TiddlyWiki.prototype.search = function(searchText,caseSensitive,useRegExp,sortField,excludeTag)
{
	if (!useRegExp)
		searchText = searchText.escapeRegExp();
	var regExp = new RegExp(searchText,caseSensitive ? "m" : "im");
	var candidates = this.reverseLookup("tags",excludeTag,false);
	var results = [];
	for(var t=0; t<candidates.length; t++)
		{
		if(regExp.test(candidates[t].title) || regExp.test(candidates[t].text))
			results.push(candidates[t]);
		}
	if(!sortField)
		sortField = "title";
	results.sort(function (a,b) {if(a[sortField] == b[sortField]) return(0); else return (a[sortField] < b[sortField]) ? -1 : +1; });
	return results;
}

// Return an array of all the tags in use. Each member of the array is another array where [0] is the name of the tag and [1] is the number of occurances
TiddlyWiki.prototype.getTags = function()
{
	var results = [];
	for(var t in this.tiddlers)
		{
		var tiddler = this.tiddlers[t];
		for(g=0; g<tiddler.tags.length; g++)
			{
			var tag = tiddler.tags[g];
			var f = false;
			for(var c=0; c<results.length; c++)
				if(results[c][0] == tag)
					{
					f = true;
					results[c][1]++;
					}
			if(!f)
				results.push([tag,1]);
			}
		}
	results.sort(function (a,b) {if(a[0].toLowerCase() == b[0].toLowerCase()) return(0); else return (a[0].toLowerCase() < b[0].toLowerCase()) ? -1 : +1; });
	return results;
}

// Return an array of the tiddlers that are tagged with a given tag
TiddlyWiki.prototype.getTaggedTiddlers = function(tag,sortField)
{
	return this.reverseLookup("tags",tag,true,sortField);
}

// Return an array of the tiddlers that link to a given tiddler
TiddlyWiki.prototype.getReferringTiddlers = function(title,unusedParameter,sortField)
{
	return this.reverseLookup("links",title,true,sortField);
}

// Return an array of the tiddlers that do or do not have a specified entry in the specified storage array (ie, "links" or "tags")
// lookupMatch == true to match tiddlers, false to exclude tiddlers
TiddlyWiki.prototype.reverseLookup = function(lookupField,lookupValue,lookupMatch,sortField)
{
	var results = [];
	for(var t in this.tiddlers)
		{
		var tiddler = this.tiddlers[t];
		var f = !lookupMatch;
		for(var lookup=0; lookup<tiddler[lookupField].length; lookup++)
			if(tiddler[lookupField][lookup] == lookupValue)
				f = lookupMatch;
		if(f)
			results.push(tiddler);
		}
	if(!sortField)
		sortField = "title";
	results.sort(function (a,b) {if(a[sortField] == b[sortField]) return(0); else return (a[sortField] < b[sortField]) ? -1 : +1; });
	return results;
}

// Return the tiddlers as a sorted array
TiddlyWiki.prototype.getTiddlers = function(field)
{
	var results = [];
	for(var t in this.tiddlers)
		results.push(this.tiddlers[t]);
	if(field)
		results.sort(function (a,b) {if(a[field] == b[field]) return(0); else return (a[field] < b[field]) ? -1 : +1; });
	return results;
}

// Return array of names of tiddlers that are referred to but not defined
TiddlyWiki.prototype.getMissingLinks = function(sortField)
{
	var results = [];
	for(var t in this.tiddlers)
		{
		var tiddler = this.tiddlers[t];
		for(var n=0; n<tiddler.links.length;n++)
			{
			var link = tiddler.links[n];
			if(this.tiddlers[link] == null)
				results.pushUnique(link);
			}
		}
	results.sort();
	return results;
}

// Return an array of names of tiddlers that are defined but not referred to
TiddlyWiki.prototype.getOrphans = function()
{
	var results = [];
	for(var t in this.tiddlers)
		if(this.getReferringTiddlers(t).length == 0)
			results.push(t);
	results.sort();
	return results;
}

// Return an array of names of tiddlers that are defined but not referred to
TiddlyWiki.prototype.getShadowed = function()
{
	var results = [];
	for(var t in config.shadowTiddlers)
		if(typeof config.shadowTiddlers[t] == "string")
			results.push(t);
	results.sort();
	return results;
}

// ---------------------------------------------------------------------------------
// Tiddler functions
// ---------------------------------------------------------------------------------

// Display several tiddlers from a list of space separated titles
function displayTiddlers(src,titles,state,highlightText,highlightCaseSensitive,animate,slowly)
{
	var tiddlerNames = titles.readBracketedList();
	for(var t = tiddlerNames.length-1;t>=0;t--)
		displayTiddler(src,tiddlerNames[t],state,highlightText,highlightCaseSensitive,animate,slowly);
}

// Display a tiddler with animation and scrolling, as though a link to it has been clicked on
//	src = source element object (eg link) for animation effects and positioning
//	title = title of tiddler to display
//	state = 0 is default or current state, 1 is read only and 2 is edittable
//	highlightText = text to highlight in the displayed tiddler
//	highlightCaseSensitive = flag for whether the highlight text is case sensitive
function displayTiddler(src,title,state,highlightText,highlightCaseSensitive,animate,slowly)
{
	var place = document.getElementById("tiddlerDisplay");
	var after = findContainingTiddler(src); // Which tiddler this one will be positioned after
	var before;
	if(after == null)
		before = place.firstChild;
	else if(after.nextSibling)
		before = after.nextSibling;
	else
		before = null;
	var theTiddler = createTiddler(place,before,title,state,highlightText,highlightCaseSensitive);
	if(src)
		{
		if(config.options.chkAnimate && (animate == undefined || animate == true))
			anim.startAnimating(new Zoomer(title,src,theTiddler,slowly),new Scroller(theTiddler,slowly));
		else
			window.scrollTo(0,ensureVisible(theTiddler));
		}
}

// Create a tiddler if it doesn't exist (with no fancy animating)
//	place = parent element
//	before = node before which to create/move the tiddler
//	title = title of tiddler to display
//	state = 0 is default or current state, 1 is read only and 2 is edittable
//	highlightText = text to highlight in the displayed tiddler
//	highlightCaseSensitive = flag for whether the highlight text is case sensitive
function createTiddler(place,before,title,state,highlightText,highlightCaseSensitive)
{
	var theTiddler = createTiddlerSkeleton(place,before,title);
	createTiddlerTitle(title,highlightText,highlightCaseSensitive);
	var theViewer = document.getElementById("viewer" + title);
	var theEditor = document.getElementById("editorWrapper" + title);
	switch(state)
		{
		case 0:
			if(!theViewer && !theEditor)
				{
				createTiddlerToolbar(title,false);
				createTiddlerViewer(title,highlightText,highlightCaseSensitive);
				createTiddlerFooter(title,false);
				}
			break;
		case 1: // Viewer
			if(theViewer)
				theViewer.parentNode.removeChild(theViewer);
			if(theEditor)
				theEditor.parentNode.removeChild(theEditor);
			createTiddlerToolbar(title,false);
			createTiddlerViewer(title,highlightText,highlightCaseSensitive);
			createTiddlerFooter(title,false);
			break;
		case 2: // Editor
			if(!theEditor)
				{
				if(theViewer)
					theViewer.parentNode.removeChild(theViewer);
				createTiddlerToolbar(title,true);
				createTiddlerEditor(title);
				createTiddlerFooter(title,true);
				}
			break;
		}
	return(theTiddler);
}

function refreshTiddler(title)
{
	var theViewer = document.getElementById("viewer" + title);
	if(theViewer)
		{
		theViewer.parentNode.removeChild(theViewer);
		createTiddlerViewer(title,null,null);
		}
}

function createTiddlerSkeleton(place,before,title)
{
	var theTiddler = document.getElementById("tiddler" + title);
	if(!theTiddler)
		{
		theTiddler = createTiddlyElement(null,"div","tiddler" + title,"tiddler",null);
		theTiddler.onmouseover = onMouseOverTiddler;
		theTiddler.onmouseout = onMouseOutTiddler;
		theTiddler.ondblclick = onDblClickTiddler;
		var theInnerTiddler = createTiddlyElement(theTiddler,"div",null,"unselectedTiddler",null);
		var theToolbar = createTiddlyElement(theInnerTiddler,"div","toolbar" + title,"toolbar", null);
		var theTitle = createTiddlyElement(theInnerTiddler,"div","title" + title,"title",null);
		var theBody = createTiddlyElement(theInnerTiddler,"div","body" + title,"body",null);
		var theFooter = createTiddlyElement(theInnerTiddler,"div","footer" + title,"footer",null);
		place.insertBefore(theTiddler,before);
		}
	if(typeof config.shadowTiddlers[title] == "string")
		addClass(theTiddler,"shadow");
	else
		removeClass(theTiddler,"shadow");
	return(theTiddler);
}

function createTiddlerTitle(title,highlightText,highlightCaseSensitive)
{
	var theTitle = document.getElementById("title" + title);
	if(theTitle)
		{
		removeChildren(theTitle);
		createTiddlyText(theTitle,title);
		if(store.tiddlerExists(title))
			theTitle.title = store.tiddlers[title].getSubtitle();
		}
}

// Create a tiddler toolbar according to whether it's an editor or not
function createTiddlerToolbar(title,isEditor)
{
	var theToolbar = document.getElementById("toolbar" + title);
	var lingo = config.views;
	if(theToolbar)
		{
		removeChildren(theToolbar);
		insertSpacer(theToolbar);
		if(isEditor)
			{
			// Editor toolbar
			lingo = lingo.editor;
			createTiddlyButton(theToolbar,lingo.toolbarDone.text,lingo.toolbarDone.tooltip,onClickToolbarSave);
			insertSpacer(theToolbar);
			createTiddlyButton(theToolbar,lingo.toolbarCancel.text,lingo.toolbarCancel.tooltip,onClickToolbarUndo);
			insertSpacer(theToolbar);
			createTiddlyButton(theToolbar,lingo.toolbarDelete.text,lingo.toolbarDelete.tooltip,onClickToolbarDelete);
			}
		else
			{
			// Viewer toolbar
			lingo = lingo.wikified;
			createTiddlyButton(theToolbar,lingo.toolbarClose.text,lingo.toolbarClose.tooltip,onClickToolbarClose);
			insertSpacer(theToolbar);
			if(!readOnly)
				{
				createTiddlyButton(theToolbar,lingo.toolbarEdit.text,lingo.toolbarEdit.tooltip,onClickToolbarEdit);
				insertSpacer(theToolbar);
				}
			createTiddlyButton(theToolbar,lingo.toolbarPermalink.text,lingo.toolbarPermalink.tooltip,onClickToolbarPermaLink);
			insertSpacer(theToolbar);
			createTiddlyButton(theToolbar,lingo.toolbarReferences.text,lingo.toolbarReferences.tooltip,onClickToolbarReferences);
			}
		insertSpacer(theToolbar);
		}
}

// Create the body section of a read-only tiddler
function createTiddlerViewer(title,highlightText,highlightCaseSensitive)
{
	var theBody = document.getElementById("body" + title);
	if(theBody)
		{
		var tiddlerText = store.getTiddlerText(title);
		var theViewer = createTiddlyElement(theBody,"div","viewer" + title,"viewer",null);
		if(store.tiddlerExists(title))
			theViewer.setAttribute("tags",tiddler.tags.join(" "));
		if(tiddlerText == null)
			{
			tiddlerText = config.views.wikified.defaultText.format([title]);
			theViewer.style.fontStyle = "italic";
			}
		wikify(tiddlerText,theViewer,highlightText,highlightCaseSensitive);
		theViewer.style.overflow = "visible";
		theViewer.style.height = "auto";
		}
}

// Create the footer section of a tiddler
function createTiddlerFooter(title,isEditor)
{
	var theFooter = document.getElementById("footer" + title);
	var tiddler = store.tiddlers[title];
	if(theFooter && tiddler instanceof Tiddler)
		{
		removeChildren(theFooter);
		insertSpacer(theFooter);
		if(isEditor)
			{
			}
		else
			{
			var lingo = config.views.wikified.tag;
			var prompt = tiddler.tags.length == 0 ? lingo.labelNoTags : lingo.labelTags;
			var theTags = createTiddlyElement(theFooter,"div",null,null,prompt);
			for(var t=0; t<tiddler.tags.length; t++)
				{
				var theTag = createTagButton(theTags,tiddler.tags[t],tiddler.title);
				createTiddlyText(theTags," ");
				}
			}
		}
}

// Create a button for a tag with a popup listing all the tiddlers that it tags
function createTagButton(place,tag,excludeTiddler)
{
	var theTag = createTiddlyButton(place,tag,config.views.wikified.tag.tooltip.format([tag]),onClickTag);
	theTag.setAttribute("tag",tag);
	if(excludeTiddler)
		theTag.setAttribute("tiddler",excludeTiddler);
	return(theTag);
}

// Create the body section of an edittable tiddler
function createTiddlerEditor(title)
{
	var theBody = document.getElementById("body" + title);
	if(theBody)
		{
		var tiddlerText = store.getTiddlerText(title);
		var tiddlerExists = (tiddlerText != null);
		if(!tiddlerExists)
			tiddlerText = config.views.editor.defaultText.format([title]);
		var theEditor = createTiddlyElement(theBody,"div","editorWrapper" + title,"editor",null);
		theEditor.onkeypress = onEditKey;
		var theTitleBox = createTiddlyElement(theEditor,"input","editorTitle" + title,null,null);
		theTitleBox.setAttribute("type","text");
		theTitleBox.value = title;
		theTitleBox.setAttribute("size","40");
		theTitleBox.setAttribute("autocomplete","off");
		var theBodyBox = createTiddlyElement(theEditor,"textarea","editorBody" + title,null,null);
		theBodyBox.value = tiddlerText;
		var rows = 10;
		var lines = tiddlerText.match(regexpNewLine);
		if(lines != null && lines.length > rows)
			rows = lines.length + 5;
		theBodyBox.setAttribute("rows",rows);
		var theTagsBox = createTiddlyElement(theEditor,"input","editorTags" + title,null,null);
		theTagsBox.setAttribute("type","text");
		var tiddler = store.tiddlers[title];
		theTagsBox.value = tiddler instanceof Tiddler ? tiddler.getTags() : "";
		theTagsBox.setAttribute("size","40");
		theTagsBox.setAttribute("autocomplete","off");
		var tagPrompt = createTiddlyElement(theEditor,"div",null,"editorFooter",config.views.editor.tagPrompt);
		insertSpacer(tagPrompt);
		var lingo = config.views.editor.tagChooser;
		var addTag = createTiddlyButton(tagPrompt,lingo.text,lingo.tooltip,onClickAddTag);
		addTag.setAttribute("tiddler",title);
		theBodyBox.focus();
		}
}

function saveTiddler(title,minorUpdate)
{
	var titleBox = document.getElementById("editorTitle" + title);
	var newTitle = titleBox.value.trim();
	if(store.tiddlerExists(newTitle))
		{
		if(newTitle != title && !confirm(config.messages.overwriteWarning.format([newTitle.toString()])))
			{
			titleBox.focus();
			titleBox.select();
			return;
			}
		}
	var body = document.getElementById("editorBody" + title);
	var newBody = body.value;
	newBody = newBody.replace(/\r/mg,"");
	var newTags = document.getElementById("editorTags" + title).value;
	blurTiddler(title);
	if(config.options.chkForceMinorUpdate)
		minorUpdate = !minorUpdate;
	var newDate = new Date();
	store.saveTiddler(title,newTitle,newBody,config.options.txtUserName,minorUpdate ? undefined : new Date(),newTags);
	displayTiddler(null,newTitle,1,null,null,null,false,false);
	// Close the old tiddler if this is a rename
	if(title != newTitle)
		{
		var oldTiddler = document.getElementById("tiddler" + title);
		var newTiddler = document.getElementById("tiddler" + newTitle);
		oldTiddler.parentNode.replaceChild(newTiddler,oldTiddler);
		}
	if(config.options.chkAutoSave)
		saveChanges();
}

function selectTiddler(title)
{
	var e = document.getElementById("tiddler" + title);
	if(e != null)
		e.firstChild.className = "selectedTiddler";
}

function deselectTiddler(title)
{
	var e = document.getElementById("tiddler" + title);
	if(e != null)
		e.firstChild.className = "unselectedTiddler";
}

function blurTiddler(title)
{
	var body = document.getElementById("editorBody" + title);
	if(body)
		{
		body.focus();
		body.blur();
		}
}

function deleteTiddler(title)
{
	closeTiddler(title,false);
	store.removeTiddler(title);
	// Autosave
	if(config.options.chkAutoSave)
		saveChanges();
}

function closeTiddler(title,slowly)
{
	var tiddler = document.getElementById("tiddler" + title);
	if(tiddler != null)
		{
		scrubIds(tiddler);
		if(config.options.chkAnimate)
			anim.startAnimating(new Slider(tiddler,false,slowly,"all"));
		else
			tiddler.parentNode.removeChild(tiddler);
		}
}

function scrubIds(e)
{
	if(e.id)
		e.id = null;
	var children = e.childNodes;
	for(var t=0; t<children.length; t++)
		{
		var c = children[t];
		if(c.id)
			c.id = null;
		}
}

function closeAllTiddlers()
{
	clearMessage();
	var place = document.getElementById("tiddlerDisplay");
	var tiddler = place.firstChild;
	var nextTiddler;
	while(tiddler)
		{
		nextTiddler = tiddler.nextSibling;
		if(tiddler.id)
			if(tiddler.id.substr(0,7) == "tiddler")
				{
				var title = tiddler.id.substr(7);
				if(!document.getElementById("editorWrapper" + title))
					place.removeChild(tiddler);
				}
		tiddler = nextTiddler;
		}
}

// ---------------------------------------------------------------------------------
// Message area
// ---------------------------------------------------------------------------------

function displayMessage(text,linkText)
{
	var msgArea = document.getElementById("messageArea");
	var msg;
	if(linkText)
		{
		msg = createTiddlyElement(msgArea,"div",null,null,null);
		var link = createTiddlyElement(msg,"a",null,null,text);
		link.href = linkText;
		link.target = "_blank";
		}
	else
		msg = createTiddlyElement(msgArea,"div",null,null,text);
	msgArea.style.display = "block";
}

function clearMessage()
{
	var msgArea = document.getElementById("messageArea");
	removeChildren(msgArea);
	msgArea.style.display = "none";
}

// ---------------------------------------------------------------------------------
// Menu and sidebar functions
// ---------------------------------------------------------------------------------

function refreshStory(hint)
{
	var hits = hint ? store.getReferringTiddlers(hint) : null;
	var displayNodes = document.getElementById("tiddlerDisplay").childNodes;
	for(var t=0;t<displayNodes.length;t++)
		{
		var theId = displayNodes[t].id;
		if(theId && theId.substr(0,7) == "tiddler")
			{
			var title = theId.substr(7);
			if(hint)
				{
				var f = false;
				for(var h=0; h<hits.length; h++)
					if(hits[h].title == title)
						f = true
				if(f)
					refreshTiddler(title);
				}
			else
				refreshTiddler(title);
			}
		}
}

function refreshTabs(hint)
{
	refreshSpecialItem("sidebarTabs","SideBarTabs","SideBarTabs");
}

function refreshMenu(hint)
{
	refreshSpecialItem("mainMenu","MainMenu","MainMenu");
}

function refreshTitle(title)
{
	refreshSpecialItem("siteTitle",title,"SiteTitle");
	refreshPageTitle();
}

function refreshSubtitle(title)
{
	refreshSpecialItem("siteSubtitle",title,"SiteSubtitle");
	refreshPageTitle();
}

function refreshPageTitle()
{
	document.title = getElementText("siteTitle") + " - " + getElementText("siteSubtitle");
}

function refreshSidebar(title)
{
	refreshSpecialItem("sidebarOptions",title,"SideBarOptions");
}

function refreshSpecialItem(elementID,title,defaultText)
{
	var place = document.getElementById(elementID);
	removeChildren(place);
	wikify(store.getTiddlerText(title,defaultText),place,null,null);
}

function refreshStyles(title)
{
	setStylesheet(title == null ? "" : store.getRecursiveTiddlerText(title,"",10),title);
}

// ---------------------------------------------------------------------------------
// Options cookie stuff
// ---------------------------------------------------------------------------------

function loadOptionsCookie()
{
	var cookies = document.cookie.split(";");
	for(var c=0; c<cookies.length; c++)
		{
		var p = cookies[c].indexOf("=");
		if(p != -1)
			{
			var name = cookies[c].substr(0,p).trim();
			var value = cookies[c].substr(p+1).trim();
			switch(name.substr(0,3))
				{
				case "txt":
					config.options[name] = unescape(value);
					break;
				case "chk":
					config.options[name] = value == "true";
					break;
				}
			}
		}
}

function saveOptionCookie(name)
{
	var c = name + "=";
	switch(name.substr(0,3))
		{
		case "txt":
			c += escape(config.options[name].toString());
			break;
		case "chk":
			c += config.options[name] ? "true" : "false";
			break;
		}
	c += "; expires=Fri, 1 Jan 2038 12:00:00 UTC; path=/";
	document.cookie = c;
}

// ---------------------------------------------------------------------------------
// Saving
// ---------------------------------------------------------------------------------

var saveUsingSafari = false;
var startSaveArea = '<div id="' + 'storeArea">'; // Split up into two so that indexOf() of this source doesn't find it
var endSaveArea = '</d' + 'iv>';

// Check if there any unsaved changes before exitting
function checkUnsavedChanges()
{
	if(store.dirty)
		{
		if(confirm(config.messages.unsavedChangesWarning))
			saveChanges();
		}
}

// Save this tiddlywiki with the pending changes
function saveChanges()
{
	clearMessage();
	// Get the URL of the document
	var originalPath = document.location.toString();
	// Check we were loaded from a file URL
	if(originalPath.substr(0,5) != "file:")
		{
		alert(config.messages.notFileUrlError);
		displayTiddler(null,"SaveChanges",0,null,null,false,false);
		return;
		}
	// Remove any location part of the URL
	var hashPos = originalPath.indexOf("#");
	if(hashPos != -1)
		originalPath = originalPath.substr(0,hashPos);
	// Convert to a native file format assuming
	// "file:///x:/path/path/path..." - pc local file --> "x:\path\path\path..."
	// "file://///server/share/path/path/path..." - FireFox pc network file --> "\\server\share\path\path\path..."
	// "file:///path/path/path..." - mac/unix local file --> "/path/path/path..."
	// "file://server/share/path/path/path..." - pc network file --> "\\server\share\path\path\path..."
	var localPath;
	if(originalPath.charAt(9) == ":") // pc local file
		localPath = unescape(originalPath.substr(8)).replace(new RegExp("/","g"),"\\");
	else if(originalPath.indexOf("file://///") == 0) // FireFox pc network file
		localPath = "\\\\" + unescape(originalPath.substr(10)).replace(new RegExp("/","g"),"\\");
	else if(originalPath.indexOf("file:///") == 0) // mac/unix local file
		localPath = unescape(originalPath.substr(7));
	else if(originalPath.indexOf("file:/") == 0) // mac/unix local file
		localPath = unescape(originalPath.substr(5));
	else // pc network file
		localPath = "\\\\" + unescape(originalPath.substr(7)).replace(new RegExp("/","g"),"\\");
	// Load the original file
	var original = loadFile(localPath);
	if(original == null)
		{
		alert(config.messages.cantSaveError);
		displayTiddler(null,"SaveChanges",0,null,null,false,false);
		return;
		}
	// Locate the storeArea div's
	var posOpeningDiv = original.indexOf(startSaveArea);
	var posClosingDiv = original.lastIndexOf(endSaveArea);
	if((posOpeningDiv == -1) || (posClosingDiv == -1))
		{
		alert(config.messages.invalidFileError.format([localPath]));
		return;
		}
	// Save the backup
	if(config.options.chkSaveBackups)
		{
		var backupPath = localPath.substr(0,localPath.lastIndexOf(".")) + "." + (new Date()).convertToYYYYMMDDHHMMSSMMM() + ".html";
		var backup = saveFile(backupPath,original);
		if(backup)
			displayMessage(config.messages.backupSaved,"file://" + backupPath);
		else
			alert(config.messages.backupFailed);
		}
	// Save Rss
	if(config.options.chkGenerateAnRssFeed)
		{
		var rssPath = localPath.substr(0,localPath.lastIndexOf(".")) + ".xml";
		var rssSave = saveFile(rssPath,convertUnicodeToUTF8(generateRss()));
		if(rssSave)
			displayMessage(config.messages.rssSaved,"file://" + rssPath);
		else
			alert(config.messages.rssFailed);
		}
	// Save empty template
	if(config.options.chkSaveEmptyTemplate)
		{
		var emptyPath,p;
		if((p = localPath.lastIndexOf("/")) != -1)
			emptyPath = localPath.substr(0,p) + "/empty.html";
		else if((p = localPath.lastIndexOf("\\")) != -1)
			emptyPath = localPath.substr(0,p) + "\\empty.html";
		else
			emptyPath = localPath + ".empty.html";
		var empty = original.substr(0,posOpeningDiv + startSaveArea.length) + convertUnicodeToUTF8(generateEmpty()) + original.substr(posClosingDiv);
		var emptySave = saveFile(emptyPath,empty);
		if(emptySave)
			displayMessage(config.messages.emptySaved,"file://" + emptyPath);
		else
			alert(config.messages.emptyFailed);
		}
	// Save new file
	var revised = original.substr(0,posOpeningDiv + startSaveArea.length) + 
				convertUnicodeToUTF8(allTiddlersAsHtml()) + "\n\t\t" +
				original.substr(posClosingDiv);
	var newSiteTitle = convertUnicodeToUTF8((getElementText("siteTitle") + " - " + getElementText("siteSubtitle")).htmlEncode());
	revised = revised.replace(new RegExp("<title>[^<]*</title>", "im"),"<title>"+ newSiteTitle +"</title>");
	var save = saveFile(localPath,revised);
	if(save)
		{
		displayMessage(config.messages.mainSaved,"file://" + localPath);
		store.setDirty(false);
		}
	else
		alert(config.messages.mainFailed);
}

function generateRss()
{
	var s = [];
	var d = new Date();
	var u = store.getTiddlerText("SiteUrl",null);
	// Assemble the header
	s.push("<" + "?xml version=\"1.0\"?" + ">");
	s.push("<rss version=\"2.0\">");
	s.push("<channel>");
	s.push("<title>" + store.getTiddlerText("SiteTitle","").htmlEncode() + "</title>");
	if(u)
		s.push("<link>" + u.htmlEncode() + "</link>");
	s.push("<description>" + store.getTiddlerText("SiteSubtitle","").htmlEncode() + "</description>");
	s.push("<language>en-us</language>");
	s.push("<copyright>Copyright " + d.getFullYear() + " " + config.options.txtUserName.htmlEncode() + "</copyright>");
	s.push("<pubDate>" + d.toGMTString() + "</pubDate>");
	s.push("<lastBuildDate>" + d.toGMTString() + "</lastBuildDate>");
	s.push("<docs>http://blogs.law.harvard.edu/tech/rss</docs>");
	s.push("<generator>TiddlyWiki " + version.major + "." + version.minor + "." + version.revision + "</generator>");
	// The body
	var tiddlers = store.getTiddlers("modified");
	var n = config.numRssItems > tiddlers.length ? 0 : tiddlers.length-config.numRssItems;
	for (var t=tiddlers.length-1; t>=n; t--)
		s.push(tiddlers[t].saveToRss(u));
	// And footer
	s.push("</channel>");
	s.push("</rss>");
	// Save it all
	return s.join("\n");
}

function generateEmpty()
{
	var systemTiddlers = store.getTaggedTiddlers("systemTiddlers");
	var savedTiddlers = [];
	for(var s=0;s<systemTiddlers.length;s++)
		savedTiddlers.push(systemTiddlers[s].saveToDiv());
	return savedTiddlers.join("\n");
}

function allTiddlersAsHtml()
{
	var savedTiddlers = [];
	var tiddlers = store.getTiddlers("title");
	for (var t = 0; t < tiddlers.length; t++)
		savedTiddlers.push(tiddlers[t].saveToDiv());
	return savedTiddlers.join("\n");
}

// UTF-8 encoding rules:
// 0x0000 - 0x007F:	0xxxxxxx
// 0x0080 - 0x07FF:	110xxxxx 10xxxxxx
// 0x0800 - 0xFFFF:	1110xxxx 10xxxxxx 10xxxxxx

function convertUTF8ToUnicode(u)
{
	var s = "";
	var t = 0;
	var b1, b2, b3;
	while(t < u.length)
		{
		b1 = u.charCodeAt(t++);
		if(b1 < 0x80)
			s += String.fromCharCode(b1);
		else if(b1 < 0xE0)
			{
			b2 = u.charCodeAt(t++);
			s += String.fromCharCode(((b1 & 0x1F) << 6) | (b2 & 0x3F));
			}
		else
			{
			b2 = u.charCodeAt(t++);
			b3 = u.charCodeAt(t++);
			s += String.fromCharCode(((b1 & 0xF) << 12) | ((b2 & 0x3F) << 6) | (b3 & 0x3F));
			}
	}
	return(s);
}

function convertUnicodeToUTF8(s)
{
	if(saveUsingSafari)
		return s;
	else if(window.Components)
		return mozConvertUnicodeToUTF8(s);
	else
		return manualConvertUnicodeToUTF8(s);
}

function manualConvertUnicodeToUTF8(s)
{
	var re = /[^\u0000-\u007F]/g ;
	return s.replace(re, function($0) {return("&#" + $0.charCodeAt(0).toString() + ";");})
}

function mozConvertUnicodeToUTF8(s)
{
	netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
	var converter = Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);
	converter.charset = "UTF-8";
	var u = converter.ConvertFromUnicode(s);
	var fin = converter.Finish();
	if(fin.length > 0)
		return u + fin;
	else
		return u;
}

function saveFile(fileUrl, content)
{
	var r = null;
	if(saveUsingSafari)
		r = safariSaveFile(fileUrl, content);
	if((r == null) || (r == false))
		r = mozillaSaveFile(fileUrl, content);
	if((r == null) || (r == false))
		r = ieSaveFile(fileUrl, content);
	if((r == null) || (r == false))
		r = operaSaveFile(fileUrl, content);
	return(r);
}

function loadFile(fileUrl)
{
	var r = null;
	if(saveUsingSafari)
		r = safariLoadFile(fileUrl);
	if((r == null) || (r == false))
		r = mozillaLoadFile(fileUrl);
	if((r == null) || (r == false))
		r = ieLoadFile(fileUrl);
	if((r == null) || (r == false))
		r = operaLoadFile(fileUrl);
	return(r);
}

// Returns null if it can't do it, false if there's an error, true if it saved OK
function ieSaveFile(filePath, content)
{
	try
		{
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		}
	catch(e)
		{
		//alert("Exception while attempting to save\n\n" + e.toString());
		return(null);
		}
	var file = fso.OpenTextFile(filePath,2,-1,0);
	file.Write(content);
	file.Close();
	return(true);
}

// Returns null if it can't do it, false if there's an error, or a string of the content if successful
function ieLoadFile(filePath)
{
	try
		{
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		var file = fso.OpenTextFile(filePath,1);
		var content = file.ReadAll();
		file.Close();
		}
	catch(e)
		{
		//alert("Exception while attempting to load\n\n" + e.toString());
		return(null);
		}
	return(content);
}

// Returns null if it can't do it, false if there's an error, true if it saved OK
function mozillaSaveFile(filePath, content)
{
	if(window.Components)
		try
			{
			netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
			var file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
			file.initWithPath(filePath);
			if (!file.exists())
				file.create(0, 0664);
			var out = Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);
			out.init(file, 0x20 | 0x02, 00004,null);
			out.write(content, content.length);
			out.flush();
			out.close();
			return(true);
			}
		catch(e)
			{
			//alert("Exception while attempting to save\n\n" + e);
			return(false);
			}
	return(null);
}

// Returns null if it can't do it, false if there's an error, or a string of the content if successful
function mozillaLoadFile(filePath)
{
	if(window.Components)
		try
			{
			netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
			var file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
			file.initWithPath(filePath);
			if (!file.exists())
				return(null);
			var inputStream = Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream);
			inputStream.init(file, 0x01, 00004, null);
			var sInputStream = Components.classes["@mozilla.org/scriptableinputstream;1"].createInstance(Components.interfaces.nsIScriptableInputStream);
			sInputStream.init(inputStream);
			return(sInputStream.read(sInputStream.available()));
			}
		catch(e)
			{
			//alert("Exception while attempting to load\n\n" + e);
			return(false);
			}
	return(null);
}

function operaUrlToFilename(url)
{
	var f = "//localhost";
	if(url.indexOf(f) == 0)
		return url.substring(f.length);
	var i = url.indexOf(":");
	if(i > 0)
		return url.substring(i-1);
	return url;
}

function operaSaveFile(filePath, content)
{
	try
		{
		var s = new java.io.PrintStream(new java.io.FileOutputStream(operaUrlToFilename(filePath)));
		s.print(content);
		s.close();
		}
	catch(e)
		{
		if(window.opera)
			opera.postError(e);
		return null;
		}
	return true;
}

function operaLoadFile(filePath)
{
	var content = [];
	alert(operaUrlToFilename(filePath));
	try
		{
		var r = new java.io.BufferedReader(new java.io.FileReader(operaUrlToFilename(filePath)));
		var line;
		while ((line = r.readLine()) != null)
			content.push(new String(line));
		r.close();
		}
	catch(e)
		{
		if(window.opera)
			opera.postError(e);
		return null;
		}
	return content.join("\n");
}

function safariFilenameToUrl(filename) {
	return ("file://" + filename);
}

function safariLoadFile(url)
{
	url = safariFilenameToUrl(url);
	var plugin = document.embeds["tiddlyWikiSafariSaver"];
	return plugin.readURL(url);
}

function safariSaveFile(url,content)
{
	url = safariFilenameToUrl(url);
	var plugin = document.embeds["tiddlyWikiSafariSaver"];
	return plugin.writeStringToURL(content,url);
}

// Lifted from http://developer.apple.com/internet/webcontent/detectplugins.html
function detectPlugin()
{
	var daPlugins = detectPlugin.arguments;
	var pluginFound = false;
	if (navigator.plugins && navigator.plugins.length > 0)
		{
		var pluginsArrayLength = navigator.plugins.length;
		for (pluginsArrayCounter=0; pluginsArrayCounter < pluginsArrayLength; pluginsArrayCounter++ )
			{
			var numFound = 0;
			for(namesCounter=0; namesCounter < daPlugins.length; namesCounter++)
				{
				if( (navigator.plugins[pluginsArrayCounter].name.indexOf(daPlugins[namesCounter]) >= 0) || 
						(navigator.plugins[pluginsArrayCounter].description.indexOf(daPlugins[namesCounter]) >= 0) )
					numFound++;
				}
			if(numFound == daPlugins.length)
				{
				pluginFound = true;
				break;
				}
			}
	}
	return pluginFound;
}

// ---------------------------------------------------------------------------------
// Event handlers
// ---------------------------------------------------------------------------------

function onEditKey(e)
{
	if (!e) var e = window.event;
	clearMessage();
	var consume = false;
	switch(e.keyCode)
		{
		case 13: // Ctrl-Enter
		case 10: // Ctrl-Enter on IE PC
		case 77: // Ctrl-Enter is "M" on some platforms
			if(e.ctrlKey && this.id && this.id.substr(0,13) == "editorWrapper")
				{
				blurTiddler(this.id.substr(13));
				saveTiddler(this.id.substr(13),e.shiftKey);
				consume = true;
				}
			break;
		case 27: // Escape
			if(this.id && this.id.substr(0,13) == "editorWrapper")
				{
				blurTiddler(this.id.substr(13));
				displayTiddler(null,this.id.substr(13),1,null,null,false,false);
				consume = true;
				}
			break;
		}
	e.cancelBubble = consume;
	if(consume)
		if (e.stopPropagation) e.stopPropagation();
	return(!consume);

}

// Event handler for clicking on a tiddly link
function onClickTiddlerLink(e)
{
	if (!e) var e = window.event;
	var theTarget = resolveTarget(e);
	var theLink = theTarget;
	var title = null;
	do {
		title = theLink.getAttribute("tiddlyLink");
		theLink = theLink.parentNode;
	} while(title == null && theLink != null);
	if(title)
		{
		var toggling = e.metaKey || e.ctrlKey;
		if(config.options.chkToggleLinks)
			toggling = !toggling;
		var opening;
		if(toggling && document.getElementById("tiddler" + title))
			closeTiddler(title,e.shiftKey || e.altKey);
		else
			displayTiddler(theTarget,title,0,null,null,true,e.shiftKey || e.altKey);
		}
	clearMessage();
	return(false);
}

// Event handler for mouse over a tiddler
function onMouseOverTiddler(e)
{
	var tiddler;
	if(this.id.substr(0,7) == "tiddler")
		tiddler = this.id.substr(7);
	if(tiddler)
		selectTiddler(tiddler);
}

// Event handler for mouse out of a tiddler
function onMouseOutTiddler(e)
{
	var tiddler;
	if(this.id.substr(0,7) == "tiddler")
		tiddler = this.id.substr(7);
	if(tiddler)
		deselectTiddler(tiddler);
}

// Event handler for double click on a tiddler
function onDblClickTiddler(e)
{
	if (!e) var e = window.event;
	var theTarget = resolveTarget(e);
	if(!readOnly && theTarget && theTarget.nodeName.toLowerCase() != "input" && theTarget.nodeName.toLowerCase() != "textarea")
		{
		clearMessage();
		if(document.selection && document.selection.empty)
			document.selection.empty();
		var tiddler;
		if(this.id.substr(0,7) == "tiddler")
			tiddler = this.id.substr(7);
		if(tiddler)
			displayTiddler(null,tiddler,2,null,null,false,false);
		return true;
		}
	else
		return false;
}

// Event handler for clicking on toolbar close
function onClickToolbarClose(e)
{
	if (!e) var e = window.event;
	clearMessage();
	if(this.parentNode.id)
		closeTiddler(this.parentNode.id.substr(7),e.shiftKey || e.altKey);
	return(false);
}

// Event handler for clicking on toolbar permalink
function onClickToolbarPermaLink(e)
{
	if(this.parentNode.id)
		{
		var title = this.parentNode.id.substr(7);
		var t = encodeURIComponent(String.encodeTiddlyLink(title));
		if(window.location.hash != t)
			window.location.hash = t;
		}
	return false;
}

// Event handler for clicking on toolbar close
function onClickToolbarDelete(e)
{
	clearMessage();
	if(this.parentNode.id)
		deleteTiddler(this.parentNode.id.substr(7));
	return false;
}

// Event handler for clicking on the toolbar references button
function onClickToolbarReferences(e)
{
	if (!e) var e = window.event;
	var theTarget = resolveTarget(e);
	var popup = createTiddlerPopup(this);
	if(popup && this.parentNode.id)
		{
		var title = this.parentNode.id.substr(7);
		var references = store.getReferringTiddlers(title);
		var c = false;
		for(var r=0; r<references.length; r++)
			if(references[r].title != title)
				{
				createTiddlyLink(createTiddlyElement(popup,"li"),references[r].title,true);
				c = true;
				}
		if(!c)
			createTiddlyText(createTiddlyElement(popup,"li",null,"disabled"),config.views.wikified.toolbarReferences.popupNone);
		}
	scrollToTiddlerPopup(popup,false);
	e.cancelBubble = true;
	if (e.stopPropagation) e.stopPropagation();
	return(false);
}

// Event handler for clicking on a tiddler tag
function onClickTag(e)
{
	if (!e) var e = window.event;
	var theTarget = resolveTarget(e);
	var popup = createTiddlerPopup(this);
	var tag = this.getAttribute("tag");
	var title = this.getAttribute("tiddler");
	if(popup && tag)
		{
		var tagged = store.getTaggedTiddlers(tag);
		var titles = [];
		var li,r;
		for(r=0;r<tagged.length;r++)
			if(tagged[r].title != title)
				titles.push(tagged[r].title);
		var lingo = config.views.wikified.tag;
		if(titles.length > 0)
			{
			var openAll = createTiddlyButton(createTiddlyElement(popup,"li"),lingo.openAllText.format([tag]),lingo.openAllTooltip,onClickTagOpenAll);
			openAll.setAttribute("tag",tag);
			createTiddlyElement(createTiddlyElement(popup,"li"),"hr");
			for(r=0; r<titles.length; r++)
				{
				createTiddlyLink(createTiddlyElement(popup,"li"),titles[r],true);
				}
			}
		else
			createTiddlyText(createTiddlyElement(popup,"li",null,"disabled"),lingo.popupNone.format([tag]));
		}
	scrollToTiddlerPopup(popup,false);
	e.cancelBubble = true;
	if (e.stopPropagation) e.stopPropagation();
	return(false);
}

// Event handler for 'open all' on a tiddler popup
function onClickTagOpenAll(e)
{
	if (!e) var e = window.event;
	var tag = this.getAttribute("tag");
	var tagged = store.getTaggedTiddlers(tag);
	for(var t=tagged.length-1; t>=0; t--)
		displayTiddler(this,tagged[t].title,0,null,null,false,e.shiftKey || e.altKey);
	return(false);
}

// Event handler for clicking on the 'add tag' button
function onClickAddTag(e)
{
	if (!e) var e = window.event;
	var theTarget = resolveTarget(e);
	var popup = createTiddlerPopup(this);
	var tiddler = this.getAttribute("tiddler");
	var tags = store.getTags();
	var lingo = config.views.editor.tagChooser;
	if(tags.length == 0)
		createTiddlyText(createTiddlyElement(popup,"li"),lingo.popupNone);
	for (t=0; t<tags.length; t++)
		{
		var theTag = createTiddlyButton(createTiddlyElement(popup,"li"),tags[t][0],lingo.tagTooltip.format([tags[t][0]]),onClickAddTagPopup);
		theTag.setAttribute("tag",tags[t][0]);
		theTag.setAttribute("tiddler",tiddler);
		}
	scrollToTiddlerPopup(popup,false);
	e.cancelBubble = true;
	if (e.stopPropagation) e.stopPropagation();
	return(false);
}

// Event handler for clicking on a tag in the 'add tag' popup
function onClickAddTagPopup(e)
{
	if (!e) var e = window.event;
	var theTarget = resolveTarget(e);
	var tiddler = this.getAttribute("tiddler");
	var tag = this.getAttribute("tag");
	var tagsBox = document.getElementById("editorTags" + tiddler);
	if(tagsBox)
		tagsBox.value += " " + String.encodeTiddlyLink(tag);
	return(false);
}

// Event handler for clicking on toolbar close
function onClickToolbarEdit(e)
{
	clearMessage();
	if(this.parentNode.id)
		displayTiddler(null,this.parentNode.id.substr(7),2,null,null,false,false);
	return false;
}

// Event handler for clicking on toolbar save
function onClickToolbarSave(e)
{
	if (!e) var e = window.event;
	if(this.parentNode.id)
		saveTiddler(this.parentNode.id.substr(7),e.shiftKey);
	return false;
}

// Event handler for clicking on toolbar save
function onClickToolbarUndo(e)
{
	if(this.parentNode.id)
		displayTiddler(null,this.parentNode.id.substr(7),1,null,null,false,false);
	return false;
}

// Eek... it's bad that this is done via a function rather than a normal, copy-able href
function onClickPermaView()
{
	var tiddlerDisplay = document.getElementById("tiddlerDisplay");
	var links = [];
	for(var t=0;t<tiddlerDisplay.childNodes.length;t++)
		{
		var tiddlerName = tiddlerDisplay.childNodes[t].id.substr(7);
		links.push(String.encodeTiddlyLink(tiddlerName));
		}
	window.location.hash = encodeURIComponent(links.join(" "));
	return false;
}

// ---------------------------------------------------------------------------------
// Animation engine
// ---------------------------------------------------------------------------------

function Animator()
{
	this.running = 0; // Incremented at start of each animation, decremented afterwards. If zero, the interval timer is disabled
	this.timerID; // ID of the timer used for animating
	this.animations = []; // List of animations in progress
	return this;
}

// Start animation engine
Animator.prototype.startAnimating = function() // Variable number of arguments
{
	for(var t=0; t<arguments.length; t++)
		this.animations.push(arguments[t]);
	if(this.running == 0)
		{
		var me = this;
		this.timerID = window.setInterval(function() {me.doAnimate(me);},25);
		}
	this.running += arguments.length;
}

// Perform an animation engine tick, calling each of the known animation modules
Animator.prototype.doAnimate = function(me)
{
	var a = 0;
	while(a<me.animations.length)
		{
		var animation = me.animations[a];
		animation.progress += animation.step;
		if(animation.progress < 0 || animation.progress > 1)
			{
			animation.stop();
			me.animations.splice(a,1);
			if(--me.running == 0)
				window.clearInterval(me.timerID);
			}
		else
			{
			animation.tick();
			a++;
			}
		}
}

// Map a 0..1 value to 0..1, but slow down at the start and end
Animator.slowInSlowOut = function(progress)
{
	return(1-((Math.cos(progress * Math.PI)+1)/2));
}

// ---------------------------------------------------------------------------------
// Zoomer animation
// ---------------------------------------------------------------------------------

function Zoomer(text,startElement,targetElement,slowly)
{
	this.element = document.createElement("div");
	this.element.appendChild(document.createTextNode(text));
	this.element.className = "zoomer";
	document.body.appendChild(this.element);
	this.startElement = startElement;
	this.startLeft = findPosX(this.startElement);
	this.startTop = findPosY(this.startElement);
	this.startWidth = this.startElement.offsetWidth;
	this.startHeight = this.startElement.offsetHeight;
	this.targetElement = targetElement;
	this.targetLeft = findPosX(this.targetElement);
	this.targetTop = findPosY(this.targetElement);
	this.targetWidth = this.targetElement.offsetWidth;
	this.targetHeight = this.targetElement.offsetHeight;
	this.progress = 0;
	this.step = slowly ? config.animSlow : config.animFast;
	//this.targetElement.style.opacity = 0;
	return this;
}

Zoomer.prototype.stop = function()
{
	this.element.parentNode.removeChild(this.element);
	//this.targetElement.style.opacity = 1;
}

Zoomer.prototype.tick = function()
{
	var f = Animator.slowInSlowOut(this.progress);
	this.element.style.left = this.startLeft + (this.targetLeft-this.startLeft) * f + "px";
	this.element.style.top = this.startTop + (this.targetTop-this.startTop) * f + "px";
	this.element.style.width = this.startWidth + (this.targetWidth-this.startWidth) * f + "px";
	this.element.style.height = this.startHeight + (this.targetHeight-this.startHeight) * f + "px";
	this.element.style.display = "block";
	//this.targetElement.style.opacity = this.progress;
	//this.targetElement.style.filter = "alpha(opacity:" + this.progress * 100 + ")";
}

// ---------------------------------------------------------------------------------
// Scroller animation
// ---------------------------------------------------------------------------------

function Scroller(targetElement,slowly)
{
	this.targetElement = targetElement;
	this.startScroll = findScrollY();
	this.targetScroll = ensureVisible(targetElement);
	this.progress = 0;
	this.step = slowly ? config.animSlow : config.animFast;
	return this;
}

Scroller.prototype.stop = function()
{
	window.scrollTo(0,this.targetScroll);
}

Scroller.prototype.tick = function()
{
	var f = Animator.slowInSlowOut(this.progress);
	window.scrollTo(0,this.startScroll + (this.targetScroll-this.startScroll) * f);
}

// ---------------------------------------------------------------------------------
// Slider animation
// ---------------------------------------------------------------------------------

// deleteMode - "none", "all" [delete target element and it's children], [only] "children" [but not the target element]
function Slider(element,opening,slowly,deleteMode)
{
	this.element = element;
	element.style.display = "block";
	this.deleteMode = deleteMode;
	this.element.style.height = "auto";
	this.realHeight = element.offsetHeight;
	this.opening = opening;
	this.step = slowly ? config.animSlow : config.animFast;
	if(opening)
		{
		this.progress = 0;
		element.style.height = "0px";
		element.style.display = "block";
		}
	else
		{
		this.progress = 1;
		this.step = -this.step;
		}
	element.style.overflow = "hidden";
	return this;
}

Slider.prototype.stop = function()
{
	if(this.opening)
		this.element.style.height = "auto";
	else
		{
		switch(this.deleteMode)
			{
			case "none":
				this.element.style.display = "none";
				break;
			case "all":
				this.element.parentNode.removeChild(this.element);
				break;
			case "children":
				removeChildren(this.element);
				break;
			}
		}
}

Slider.prototype.tick = function()
{
	var f = Animator.slowInSlowOut(this.progress);
	var h = this.realHeight * f;
	this.element.style.height = h + "px";
	this.element.style.opacity = f;
}

// ---------------------------------------------------------------------------------
// Popup menu
// ---------------------------------------------------------------------------------

var Popup = {
	stack: [] // Array of objects with members root: and popup:
	};

Popup.create = function(root)
{
	Popup.remove();
	var popup = createTiddlyElement(document.body,"ol","popup","popup",null);
	Popup.stack.push({root: root, popup: popup});
	return popup;
}

Popup.onDocumentClick = function(e)
{
	if (!e) var e = window.event;
	var target = resolveTarget(e);
	if(e.eventPhase == undefined)
		Popup.remove();
	else if(e.eventPhase == Event.BUBBLING_PHASE || e.eventPhase == Event.AT_TARGET)
		Popup.remove();
	return true;
}

Popup.show = function(unused,slowly)
{
	var curr = Popup.stack[Popup.stack.length-1];
	var rootLeft = findPosX(curr.root);
	var rootTop = findPosY(curr.root);
	var rootHeight = curr.root.offsetHeight;
	var popupLeft = rootLeft;
	var popupTop = rootTop + rootHeight;
	var popupWidth = curr.popup.offsetWidth;
	var winWidth = findWindowWidth();
	if(popupLeft + popupWidth > winWidth)
		popupLeft = winWidth - popupWidth;
	curr.popup.style.left = popupLeft + "px";
	curr.popup.style.top = popupTop + "px";
	curr.popup.style.display = "block";
	addClass(curr.root,"highlight");
	if(config.options.chkAnimate)
		anim.startAnimating(new Scroller(curr.popup,slowly));
	else
		window.scrollTo(0,ensureVisible(curr.popup));
}

Popup.remove = function()
{
	if(Popup.stack.length > 0)
		{
		Popup.removeFrom(0);
		}
}

Popup.removeFrom = function(from)
{
	for(var t=Popup.stack.length-1; t>=from; t--)
		{
		var p = Popup.stack[t];
		removeClass(p.root,"highlight");
		p.popup.parentNode.removeChild(p.popup);
		}
	Popup.stack = Popup.stack.slice(0,from);
}

// Backwards compatibility
var createTiddlerPopup = Popup.create;
var scrollToTiddlerPopup = Popup.show;
var hideTiddlerPopup = Popup.remove;

// ---------------------------------------------------------------------------------
// Augmented methods for the JavaScript Number(), Array() and String() objects
// ---------------------------------------------------------------------------------

// Clamp a number to a range
Number.prototype.clamp = function(min,max)
{
	c = this;
	if(c < min)
		c = min;
	if(c > max)
		c = max;
	return c;
}

// Find an entry in an array. Returns the array index or null
Array.prototype.find = function(item)
{
	for(var t=0; t<this.length; t++)
		if(this[t] == item)
			return t;
	return null;
}

// Find an entry in an array by the value of one of it's members. Returns the array index or null
Array.prototype.findByMember = function(member,value)
{
	for(var t=0; t<this.length; t++)
		if(this[t][member] == value)
			return t;
	return null;
}

// Get an item in an array by the value of a particular member of the item. Returns the item or null
Array.prototype.get = function(member,value)
{
	for(t=0; t<this.length; t++)
		if(this[t][members] == value)
			return this[t];
	return null;
}

// Push a new value into an array only if it is not already present in the array. If the optional unique parameter is false, it reverts to a normal push
Array.prototype.pushUnique = function(item,unique)
{
	if(unique != undefined && unique == false)
		this.push(item);
	else
		{
		if(this.find(item) == null)
			this.push(item);
		}
}

// Get characters from the right end of a string
String.prototype.right = function(n)
{
	if(n < this.length)
		return this.slice(this.length-n);
	else
		return this;
}

// Trim whitespace from both ends of a string
String.prototype.trim = function()
{
	var regexpTrim = new RegExp("^\\s*(.*?)\\s*$","mg");
	return(this.replace(regexpTrim,"$1"));
}

// Convert a string from a CSS style property name to a JavaScript style name ("background-color" -> "backgroundColor")
String.prototype.unDash = function()
{
	var s = this.split("-");
	if(s.length > 1)
		for(var t=1; t<s.length; t++)
			s[t] = s[t].substr(0,1).toUpperCase() + s[t].substr(1);
	return s.join("");
}

// Substitute substrings from an array into a format string that includes '%1'-type specifiers
String.prototype.format = function(substrings)
{
	var subRegExp = new RegExp("(?:%(\\d+))","mg");
	var currPos = 0;
	var r = [];
	do {
		var match = subRegExp.exec(this);
		if(match && match[1])
			{
			if(match.index > currPos)
				r.push(this.substring(currPos,match.index));
			r.push(substrings[parseInt(match[1])]);
			currPos = subRegExp.lastIndex;
			}
	} while(match);
	if(currPos < this.length)
		r.push(this.substring(currPos,this.length));
	return r.join("");
}

// Escape any special RegExp characters with that character preceded by a backslash
String.prototype.escapeRegExp = function()
{
	return(this.replace(new RegExp("[\\\\\\^\\$\\*\\+\\?\\(\\)\\=\\!\\|\\,\\{\\}\\[\\]\\.]","g"),"\\$&"));
}

// Convert & to "&amp;", < to "&lt;", > to "&gt;" and " to "&quot;"
String.prototype.htmlEncode = function()
{
	var regexpAmp = new RegExp("&","mg");
	var regexpLessThan = new RegExp("<","mg");
	var regexpGreaterThan = new RegExp(">","mg");
	var regexpQuote = new RegExp("\"","mg");
	return(this.replace(regexpAmp,"&amp;").replace(regexpLessThan,"&lt;").replace(regexpGreaterThan,"&gt;").replace(regexpQuote,"&quot;"));
}

// Process a string list of macro parameters into an array. Parameters can be quoted with "", '', [[]] or left unquoted (and therefore space-separated)
String.prototype.readMacroParams = function()
{
	var regexpMacroParam = new RegExp("(?:\\s*)(?:(?:\"([^\"]*)\")|(?:'([^']*)')|(?:\\[\\[([^\\]]*)\\]\\])|([^\"'\\s]\\S*))","mg");
	var params = [];
	do {
		var match = regexpMacroParam.exec(this);
		if(match)
			{
			if(match[1]) // Double quoted
				params.push(match[1]);
			else if(match[2]) // Single quoted
				params.push(match[2]);
			else if(match[3]) // Double-square-bracket quoted
				params.push(match[3]);
			else if(match[4]) // Unquoted
				params.push(match[4]);
			}
	} while(match);
	return params;
}

// Process a string list of tiddler names into an array. Tiddler names that have spaces in them must be [[bracketed]]
String.prototype.readBracketedList = function(unique)
{
	var bracketedPattern = "\\[\\[([^\\]]+)\\]\\]";
	var unbracketedPattern = "[^\\s$]+";
	var pattern = "(?:" + bracketedPattern + ")|(" + unbracketedPattern + ")";
	var re = new RegExp(pattern,"mg");
	var tiddlerNames = [];
	do {
		var match = re.exec(this);
		if(match)
			{
			if(match[1]) // Bracketed
				tiddlerNames.pushUnique(match[1],unique);
			else if(match[2]) // Unbracketed
				tiddlerNames.pushUnique(match[2],unique);
			}
	} while(match);
	return(tiddlerNames);
}

// Static method to bracket a string with double square brackets if it contains a space
String.encodeTiddlyLink = function(title)
{
	if(title.indexOf(" ") == -1)
		return(title);
	else
		return("[[" + title + "]]");
}

// Static method to left-pad a string with 0s to a certain width
String.zeroPad = function(n,d)
{
	var s = n.toString();
	if(s.length < d)
		s = "000000000000000000000000000".substr(0,d-s.length) + s;
	return(s);
}

// ---------------------------------------------------------------------------------
// RGB colour object
// ---------------------------------------------------------------------------------

// Construct an RGB colour object from a '#rrggbb' or 'rgb(n,n,n)' string or from separate r,g,b values
function RGB(r,g,b)
{
	this.r = 0;
	this.g = 0;
	this.b = 0;
	if(typeof r == "string")
		{
		if(r.substr(0,1) == "#")
			{
			this.r = parseInt(r.substr(1,2),16)/255;
			this.g = parseInt(r.substr(3,2),16)/255;
			this.b = parseInt(r.substr(5,2),16)/255;
			}
		else
			{
			var rgbPattern = /rgb\s*\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/ ;
			var c = r.match(rgbPattern);
			if (c)
				{
				this.r = parseInt(c[1],10)/255;
				this.g = parseInt(c[2],10)/255;
				this.b = parseInt(c[3],10)/255;
				}
			}
		}
	else
		{
		this.r = r;
		this.g = g;
		this.b = b;
		}
	return this;
}

// Mixes this colour with another in a specified proportion
// c = other colour to mix
// f = 0..1 where 0 is this colour and 1 is the new colour
// Returns an RGB object
RGB.prototype.mix = function(c,f)
{
	return new RGB(this.r + (c.r-this.r) * f,this.g + (c.g-this.g) * f,this.b + (c.b-this.b) * f);
}

// Return an rgb colour as a #rrggbb format hex string
RGB.prototype.toString = function()
{
	var r = this.r.clamp(0,1);
	var g = this.g.clamp(0,1);
	var b = this.b.clamp(0,1);
	return("#" + ("0" + Math.floor(r * 255).toString(16)).right(2) +
				 ("0" + Math.floor(g * 255).toString(16)).right(2) +
				 ("0" + Math.floor(b * 255).toString(16)).right(2));
}

// ---------------------------------------------------------------------------------
// Augmented methods for the JavaScript Date() object
// ---------------------------------------------------------------------------------

// Substitute date components into a string
Date.prototype.formatString = function(template)
{
	template = template.replace(/YYYY/g,this.getFullYear());
	template = template.replace(/YY/g,String.zeroPad(this.getFullYear()-2000,2));
	template = template.replace(/MMM/g,config.messages.dates.months[this.getMonth()]);
	template = template.replace(/0MM/g,String.zeroPad(this.getMonth()+1,2));
	template = template.replace(/MM/g,this.getMonth()+1);
	template = template.replace(/DDD/g,config.messages.dates.days[this.getDay()]);
	template = template.replace(/0DD/g,String.zeroPad(this.getDate(),2));
	template = template.replace(/DD/g,this.getDate());
	template = template.replace(/hh/g,this.getHours());
	template = template.replace(/mm/g,this.getMinutes());
	template = template.replace(/ss/g,this.getSeconds());
	return template;
}

// Convert a date to UTC YYYYMMDDHHMM string format
Date.prototype.convertToYYYYMMDDHHMM = function()
{
	return(String.zeroPad(this.getFullYear(),4) + String.zeroPad(this.getMonth()+1,2) + String.zeroPad(this.getDate(),2) + String.zeroPad(this.getHours(),2) + String.zeroPad(this.getMinutes(),2));
}

// Convert a date to UTC YYYYMMDD.HHMMSSMMM string format
Date.prototype.convertToYYYYMMDDHHMMSSMMM = function()
{
	return(String.zeroPad(this.getFullYear(),4) + String.zeroPad(this.getMonth()+1,2) + String.zeroPad(this.getDate(),2) + "." + String.zeroPad(this.getHours(),2) + String.zeroPad(this.getMinutes(),2) + String.zeroPad(this.getSeconds(),2) + String.zeroPad(this.getMilliseconds(),4));
}

// Static method to create a date from a UTC YYYYMMDDHHMM format string
Date.convertFromYYYYMMDDHHMM = function(d)
{
	var theDate = new Date(parseInt(d.substr(0,4),10),
							parseInt(d.substr(4,2),10)-1,
							parseInt(d.substr(6,2),10),
							parseInt(d.substr(8,2),10),
							parseInt(d.substr(10,2),10),0,0);
	return(theDate);
}

// ---------------------------------------------------------------------------------
// DOM utilities - many derived from www.quirksmode.org 
// ---------------------------------------------------------------------------------

function drawGradient(place,horiz,colours)
{
	for(var t=0; t<= 100; t+=2)
		{
		var bar = document.createElement("div");
		place.appendChild(bar);
		bar.style.position = "absolute";
		bar.style.left = horiz ? t + "%" : 0;
		bar.style.top = horiz ? 0 : t + "%";
		bar.style.width = horiz ? (101-t) + "%" : "100%";
		bar.style.height = horiz ? "100%" : (101-t) + "%";
		bar.style.zIndex = -1;
		var f = t/100;
		var p = f*(colours.length-1);
		bar.style.backgroundColor = colours[Math.floor(p)].mix(colours[Math.ceil(p)],p-Math.floor(p)).toString();
		}
}

function createTiddlyText(theParent,theText)
{
	return theParent.appendChild(document.createTextNode(theText));
}

function createTiddlyElement(theParent,theElement,theID,theClass,theText)
{
	var e = document.createElement(theElement);
	if(theClass != null)
		e.className = theClass;
	if(theID != null)
		e.setAttribute("id",theID);
	if(theText != null)
		e.appendChild(document.createTextNode(theText));
	if(theParent != null)
		theParent.appendChild(e);
	return(e);
}

function createTiddlyButton(theParent,theText,theTooltip,theAction,theClass,theId,theAccessKey)
{
	var theButton = document.createElement("a");
	theButton.className = "button";
	if(theAction)
		{
		theButton.onclick = theAction;
		theButton.setAttribute("href","#");
		}
	theButton.setAttribute("title",theTooltip);
	if(theText)
		theButton.appendChild(document.createTextNode(theText));
	if(theClass)
		theButton.className = theClass;
	if(theId)
		theButton.id = theId;
	if(theParent)
		theParent.appendChild(theButton);
	if(theAccessKey)
		theButton.setAttribute("accessKey",theAccessKey);
	return(theButton);
}

function createTiddlyLink(place,title,includeText)
{
	var text = includeText ? title : null;
	var subTitle, theClass = "tiddlyLink";
	if(store.tiddlerExists(title))
		{
		subTitle = store.tiddlers[title].getSubtitle();
		theClass += " tiddlyLinkExisting";
		}
	else
		{
		subTitle = config.messages.undefinedTiddlerToolTip.format([title]);
		theClass += " tiddlyLinkNonExisting";
		if(typeof config.shadowTiddlers[title] == "string")
			{
			subTitle = config.messages.shadowedTiddlerToolTip.format([title]);
			theClass += " shadow";
			}
		else
			subTitle = config.messages.undefinedTiddlerToolTip.format([title]);
		}
	var btn = createTiddlyButton(place,text,subTitle,onClickTiddlerLink,theClass);
	btn.setAttribute("tiddlyLink",title);
	return(btn);
}

function createExternalLink(place,url)
{
	var theLink = document.createElement("a");
	theLink.className = "externalLink";
	theLink.href = url;
	theLink.title = config.messages.externalLinkTooltip.format([url]);
	if(config.options.chkOpenInNewWindow)
		theLink.target = "_blank";
	place.appendChild(theLink);
	return(theLink);
}

// Cross-browser event handler attachment
function addEvent(element,type,fn)
{
	if (element.addEventListener)
		{
		element.addEventListener(type,fn,false);
		return true;
		}
	else if (element.attachEvent)
		{
		var r = element.attachEvent("on" + type,fn);
		return r;
		}
	else
		return false;
}

// Cross-browser event handler removal
function removeEvent(element,type,fn)
{
	if (element.removeEventListener)
		{
		element.removeEventListener(type,fn,false);
		return true;
		}
	else if (element.detachEvent)
		{
		var r = element.detachEvent("on" + type,fn);
		return r;
		}
	else
		return false;
}

function addClass(e,theClass)
{
	removeClass(e,theClass);
	e.className += " " + theClass;
}

function removeClass(e,theClass)
{
	var newClass = [];
	var currClass = e.className.split(" ");
	for(var t=0; t<currClass.length; t++)
		if(currClass[t] != theClass)
			newClass.push(currClass[t]);
	e.className = newClass.join(" ");
}

function hasClass(e,theClass)
{
	var c = e.className;
	if(c)
		{
		c = c.split(" ");
		for(var t=0; t<c.length; t++)
			if(c[t] == theClass)
				return true;
		}
	return false;
}

// Find the tiddler instance (if any) containing a specified element
function findContainingTiddler(e)
{
	while(e && !hasClass(e,"tiddler"))
		e = e.parentNode;
	return(e);
}

// Resolve the target object of an event
function resolveTarget(e)
{
	var obj;
	if (e.target)
		obj = e.target;
	else if (e.srcElement)
		obj = e.srcElement;
	if (obj.nodeType == 3) // defeat Safari bug
		obj = obj.parentNode;
	return(obj);
}

// Return the content of an element as plain text with no formatting
function getElementText(elementID)
{
	var e = document.getElementById(elementID);
	var text = "";
	if(e.innerText)
		text = e.innerText;
	else if(e.textContent)
		text = e.textContent;
	return text;
}

// Get the scroll position for window.scrollTo necessary to scroll a given element into view
function ensureVisible(e)
{
	var posTop = findPosY(e);
	var posBot = posTop + e.offsetHeight;
	var winTop = findScrollY();
	var winHeight = findWindowHeight();
	var winBot = winTop + winHeight;
	if(posTop < winTop)
		return(posTop);
	else if(posBot > winBot)
		{
		if(e.offsetHeight < winHeight)
			return(posTop - (winHeight - e.offsetHeight));
		else
			return(posTop);
		}
	else
		return(winTop);
}

// Get the current width of the display window
function findWindowWidth()
{
	return(window.innerWidth ? window.innerWidth : document.body.clientWidth);
}

// Get the current height of the display window
function findWindowHeight()
{
	return(window.innerHeight ? window.innerHeight : document.body.clientHeight);
}

// Get the current vertical page scroll position
function findScrollY()
{
	return(window.scrollY ? window.scrollY : document.body.scrollTop);
}

function findPosX(obj)
{
	var curleft = 0;
	while (obj.offsetParent)
		{
		curleft += obj.offsetLeft;
		obj = obj.offsetParent;
		}
	return curleft;
}

function findPosY(obj)
{
	var curtop = 0;
	while (obj.offsetParent)
		{
		curtop += obj.offsetTop;
		obj = obj.offsetParent;
		}
	return curtop;
}

// Create a non-breaking space
function insertSpacer(place)
{
	var e = document.createTextNode(String.fromCharCode(160));
	if(place)
		place.appendChild(e);
	return e;
}

// Remove all children of a node
function removeChildren(e)
{
	while(e.hasChildNodes())
		e.removeChild(e.firstChild);
}

// Add a stylesheet, replacing any previous custom stylesheet
function setStylesheet(s,id)
{
	if(!id)
		id = "customStyleSheet";
	var n = document.getElementById(id);
	if(document.createStyleSheet) // Test for IE's non-standard createStyleSheet method
		{
		if(n)
			n.parentNode.removeChild(n);
		// This failed without the &nbsp;
		document.body.insertAdjacentHTML("beforeEnd","&nbsp;<style id='" + id + "'>" + s + "</style>");
		}
	else
		{
		if(n)
			n.replaceChild(document.createTextNode(s),n.firstChild);
		else
			{
			var n = document.createElement("style");
			n.type = "text/css";
			n.id = id;
			n.appendChild(document.createTextNode(s));
			document.getElementsByTagName("head")[0].appendChild(n);
			}
		}
}

// ---------------------------------------------------------------------------------
// End of scripts
// ---------------------------------------------------------------------------------

</script>
<style type="text/css">

#saveTest {	display: none;}.zoomer {	display: none;}#messageArea {	display: none;}#storeArea, #copyright {	display: none;}.popup {	position: absolute;}

</style>
<noscript>
<style type="text/css">

#contentWrapper {
	display: none;
}

#storeArea {
	display: block;
	margin: 4em 17em 3em 17em;
}

#storeArea div {
 padding: 0.5em;
 margin: 1em 0em 0em 0em;
 border-color: #f0f0f0 #606060 #404040 #d0d0d0;
 border-style: solid;
 border-width: 2px;
 height: 7em;
 overflow: auto;
}

#javascriptWarning {
	width: 100%;
	text-align: center;
	font-weight: bold;
	background-color: #dd1100;
	color: #ffffff;
	padding:1em 0em 1em 0em;
}

</style>
</noscript>
<style type="text/css" id="calendarStyles">#mainMenu table, th, tr, td {font-size:10pt;}</style><style type="text/css" id="StyleSheetColors">body {
	background: #fff;
}

#titleLine {
	color: #fff;
	background: #300;
}

#titleLine a {
	color: #cf6;
}

#mainMenu {
	color: #000;
}

#mainMenu .tiddlyLink {
	color: #963;
}

#mainMenu .tiddlyLink:hover {
	background: #963;
	color: #fff;
}

#mainMenu .externalLink {
	color: #963;
}

#mainMenu .externalLink:hover {
	background: #963;
	color: #fff;
}

#mainMenu .button {
	color: #930;
}

#mainMenu .button:hover {
	color: #cf6;
	background: #930;
}

#messageArea {
	background: #930;
	color: #fff;
}

#messageArea a:link, #messageArea a:visited {
	color: #c90;
}

#messageArea a:hover {
	color: #963;
}

#messageArea a:active {
	color: #fff;
}

.popup {
	background: #eea;
	border: 1px solid #930;
}

.popup hr {
	color: #963;
	background: #963;
	border: 0;
}

.popup li.disabled {
	color: #ba9;
}

.popup li a, .popup li a:visited {
	color: #300;
}

.popup li a:hover {
	background: #930;
	color: #eea;
}

.tabSelected {
	background: #eea;
}

.tabUnselected {
	background: #c90;
}

.tabContents {
	background: #eea;
}

.tiddler .button {
	color: #930;
}

.tiddler .button:hover {
	color: #cf6;
	background: #930;
}

.tiddler .button:active {
	color: #fff;
	background: #c90;
}

.toolbar {
	color: #aaa;
}

.footer {
	color: #ddd;
}

.selectedTiddler .footer {
	color: #888;
}

.viewer {
	color: #000;
}

.viewer a:link, .body a:visited {
	color: #963;
}

.viewer a:hover {
	color: #fff;
	background: #963;
}

.viewer .button {
	background: #c90;
	color: #300;
	border-right: 1px solid #300;
	border-bottom: 1px solid #300;
}

.viewer .button:hover {
	background: #eea;
	color: #c90;
}

.viewer blockquote {
	border-left: 3px solid #666;
}

.viewer h1,.viewer h2,.viewer h3,.viewer h4,.viewer h5 {
	background: #cc9;
}

.viewer table {
	border: 2px solid #303030;
}

.viewer th {
	background: #996;
	border: 1px solid #606060;
	color: #fff;
}

.viewer td, .viewer tr {
	border: 1px solid #606060;
}

.viewer pre {
	color: #000000;
	border: 1px solid #963;
	background: #eea;
}

.viewer code {
	color: #630;
}

.viewer hr {
	border-top: dashed 1px #606060;
	border-left: none;
	border-right: none;
	border-bottom: none;
	color: #666;
}

.highlight, .marked {
	color: #000;
	background: #ffe72f;
}

.editor {
	color: #402C74;
}

.editor input {
	border: 1px solid #000000;
}

.editor textarea {
	border: 1px solid #000000;
	width: 100%;
}

.editorFooter {
	color: #aaa;
}

.editorFooter A {
	color: #930;
}

.editorFooter A:hover {
	color: #cf6;
	background: #930;
}

.editorFooter A:active {
	color: #fff;
	background: #c90;
}

#sidebar {
	color: #000;
}

#sidebarOptions {
	background: #c90;
}

#sidebarOptions .button {
	color: #930;
}

#sidebarOptions .button:hover {
	color: #cf6;
	background: #930;
}

#sidebarOptions .button:active {
	color: #930;
	background: #cf6;
}

#sidebarOptions .sliderPanel {
	background: #eea;
}

#sidebarOptions .sliderPanel A {
	color: #930;
}

#sidebarOptions .sliderPanel A:hover {
	color: #cf6;
	background: #930;
}

#sidebarOptions .sliderPanel A:active {
	color: #930;
	background: #cf6;
}

.sidebarSubHeading {
	color: #300;
}

#sidebarTabs {
	background: #c90;
}

#sidebarTabs .tabSelected {
	color: #cf6;
	background: #963;
}

#sidebarTabs .tabUnselected {
	color: #cf6;
	background: #930;
}

#sidebarTabs .tabContents {
	background: #963;
}


#sidebarTabs .txtMoreTab .tabSelected {
	background: #930;
}

#sidebarTabs .txtMoreTab .tabUnselected {
	background: #300;
}

#sidebarTabs .txtMoreTab .tabContents {
	background: #930;
}

#sidebarTabs .tabContents .tiddlyLink {
	color: #cf6;
}

#sidebarTabs .tabContents .tiddlyLink:hover {
	background: #ccff66;
	color: #300;
}

#sidebarTabs .tabContents .button {
	color: #cf6;
}

#sidebarTabs .tabContents .button:hover {
	color: #300;
	background: #cf6;
}

.sparkline {
	background: #eea;
	border: 0;
}

.sparktick {
	background: #930;
}

.errorNoSuchMacro {
	color: #ff0;
	background: #f00;
}

.zoomer {
	color: #963;
	border: 1px solid #963;
}</style><style type="text/css" id="StyleSheetLayout">body {
	font-size: 9pt;
	font-family: verdana,arial,helvetica;
	margin: 0;
	padding: 0;
	position: relative;
	z-index: 0;
}

a:link, a:visited, a:hover, a:active{
	text-decoration: none;
}

#contentWrapper {
	position: relative;
}

#titleLine {
	padding: 5em 1em 1em 1em;
}

#siteTitle {
	font-size: 26pt;
}

#siteSubtitle {
	padding-left: 1em;
	font-size: 10pt;
}

#mainMenu {
	position: absolute;
	left: 0em;
	width: 10em;
	line-height: 166%;
	padding: 1.5em 0.5em 0.5em 0.5em;
	font-size: 10pt;
	text-align: right;
}


#mainMenu .externalLink {
	text-decoration: underline;
}

#displayArea {
	margin: 1em 17em 0em 14em;
}

#messageArea {
	padding: 0.5em;

}

#messageArea a:link, #messageArea a:visited {
	display: inline;
	text-decoration: underline;
}

.popup {
	font-size: 8pt;
	list-style: none;
	padding: 0.2em;
	margin: 0;
}

.popup hr {
	display: block;
	height: 1px;
	width: auto;
	padding: 0;
	margin: 0.2em 0em;
}

.popup li {
	display: block;
	padding: 0;
}

.popup li.disabled {
	padding: 0.2em;
}

.popup li a, .popup li a:visited {
	display: block;
	text-decoration: none;
	padding: 0.2em;
}

.tabset {
	padding: 1em 0em 0em 0.5em;
}

.tab {
	margin: 0em 0em 0em 0.25em;
	padding: 2px;
}

.tabContents {
	padding: 0.5em;
}

.tabContents ul, .tabContents ol {
	margin: 0;
	padding: 0;
}

.tabContents li {
	list-style: none;
}

.tabContents li.listLink {
   margin-left: .75em;
}

.tiddler {
	padding: 0;
	padding: 1em 1em 0em 1em;
	font-size: 9pt;
}


/* Can these styles be moved to the previous rule?
.selectedTiddler {
	padding: 1em 1em 0em 1em;
	font-size: 9pt;
}

.unselectedTiddler {
	padding: 1em 1em 0em 1em;
	font-size: 9pt;
} */

.tiddler a.tiddlyLinkExisting {
	font-weight: bold;
}

.tiddler a.tiddlyLinkNonExisting {
	font-style: italic;
}

.tiddler a.tiddlyLinkNonExisting.shadow {
	font-weight: bold;
}

.tiddler a.externalLink {
	text-decoration: underline;
}

.tiddler .button {
	padding: 0.2em 0.4em;
}

.tiddler .button:hover {
	text-decoration: none;
}

.title {
	font-size: 10pt;
	font-weight: bold;
}

.shadow .title {
	color: #888888;
}

.toolbar {
	text-align: right;
	font-weight: normal;
	font-size: 8pt;
	padding: 0;
	padding-bottom: 2em;
	visibility: hidden;
}

.selectedTiddler .toolbar {
	visibility: visible;
}

.footer {
/* Isn't 'clear:both' the right rule? */
	clear: left;
	clear: right;
	font-weight: normal;
	font-size: 8pt;
	margin: 0;
	padding: 0;
}

.body {
	padding-top: 0.5em;
}

.viewer {
	line-height: 140%;
}

.viewer .button {
	margin: 0em 0.25em;
	padding: 0em 0.25em;
}

.viewer blockquote {
	font-size: 8pt;
	line-height: 150%;
	padding-left: 0.8em;
	margin-left: 2.5em;
}

.viewer ul {
	margin-left: 0.5em;
	padding-left: 1.5em;
}

.viewer ol {
	margin-left: 0.5em;
	padding-left: 1.5em;
}

.viewer h1,.viewer h2,.viewer h3,.viewer h4,.viewer h5 {
	font-weight: bold;
	text-decoration: none;
	padding-left: 0.4em;
}

.viewer h1 {font-size: 12pt;}
.viewer h2 {font-size: 11pt;}
.viewer h3 {font-size: 10pt;}
.viewer h4 {font-size: 9pt;}
.viewer h5 {font-size: 8pt;}

.viewer table {
	border-collapse: collapse;
	margin: 0.8em 1.0em;;
	font-size: 100%;
}

.viewer th, .viewer td, .viewer tr,.viewer caption{
	padding: 3px;
}

.viewer pre {
	padding: 0.5em;
	margin-left: 0.5em;
	font-size: 100%;
	line-height: 1.4em;
	overflow: auto;
}

.viewer code {
	font-size: 100%;
	line-height: 1.4em;
}

.viewer hr {
	height: 1px;
}

.editor {
	font-size: 8pt;
	font-weight: normal;
}

.editor input {
	display: block;
	width: 100%;
}

.editor textarea {
	display: block;
	font: inherit;
	width: 100%;
}

.editorFooter {
	padding: 0.25em 0em;
	font-size: 8pt;
}

.editorFooter A {
	padding: 0.2em 0.4em;
}

.editorFooter A:hover {
	text-decoration: none;
}

#sidebar {
	position: absolute;
	right: 0em;
	width: 16em;
	font-size: 8pt;
}

#sidebarOptions {
	padding-top: 0em;
}

#sidebarOptions .button {
	padding: 0.3em 0.2em 0.3em 1em;
	display: block;
}

#sidebarOptions input {
	margin: 0.4em 0em 0.3em 1em;
}

#sidebarOptions .sliderPanel {
	padding: 0.5em;
	font-size: 7pt;
}

#sidebarOptions .sliderPanel A {
	font-weight: bold;
}

#sidebarOptions .sliderPanel input {
	margin: 0;
	margin-bottom: 0.3em;
}

.sidebarSubHeading {
	font-size: 7pt;
}

#sidebarTabs .tabSelected {
	position: relative;
	top: -2px;
}


#sidebarTabs .tabContents {
	width: 15em;
	overflow: hidden;
}

.sparkline {
	line-height: 100%;
}

.sparktick {
	outline: 0;
}

.zoomer {
	font-size: 10pt;
	position: absolute;
	padding: 1em;
}
</style><style type="text/css" id="StyleSheet"></style></head>
<body onload="main();" onunload="if(checkUnsavedChanges) checkUnsavedChanges();">
	<script>
	if (detectPlugin("TiddlyWiki Saver"))
		{
		document.write('<embed style="display: none" name="tiddlyWikiSafariSaver" width="0" height="0" type="application/x-webkit-tiddlywiki-saver"></embed>'); 
		saveUsingSafari = true;
		}
	</script>
	<div id="copyright">
	Welcome to TiddlyWiki by Jeremy Ruston, Copyright © 2005 Osmosoft Limited
	</div>
	<noscript>
		<div id="javascriptWarning">This page requires JavaScript to function properly</div>
	</noscript>
	<div id="saveTest">savetest</div>
	<div id="contentWrapper">
		<div id="header">
			<div id="titleLine">
				<span id="siteTitle">七彩云南</span>
				<span id="siteSubtitle">彩云之南，梦的方向</span>
			</div>
		</div>
		<div id="sidebar">
			<div id="sidebarOptions"><div class="gradient" style="position: relative; overflow: hidden;"><div style="position: absolute; left: 0px; top: 0%; width: 100%; height: 101%; z-index: -1; background-color: rgb(255, 255, 255);"></div><div style="position: absolute; left: 0px; top: 2%; width: 100%; height: 99%; z-index: -1; background-color: rgb(253, 252, 249);"></div><div style="position: absolute; left: 0px; top: 4%; width: 100%; height: 97%; z-index: -1; background-color: rgb(252, 250, 244);"></div><div style="position: absolute; left: 0px; top: 6%; width: 100%; height: 95%; z-index: -1; background-color: rgb(251, 248, 239);"></div><div style="position: absolute; left: 0px; top: 8%; width: 100%; height: 93%; z-index: -1; background-color: rgb(250, 246, 234);"></div><div style="position: absolute; left: 0px; top: 10%; width: 100%; height: 91%; z-index: -1; background-color: rgb(249, 244, 229);"></div><div style="position: absolute; left: 0px; top: 12%; width: 100%; height: 89%; z-index: -1; background-color: rgb(248, 242, 224);"></div><div style="position: absolute; left: 0px; top: 14%; width: 100%; height: 87%; z-index: -1; background-color: rgb(247, 240, 219);"></div><div style="position: absolute; left: 0px; top: 16%; width: 100%; height: 85%; z-index: -1; background-color: rgb(246, 238, 214);"></div><div style="position: absolute; left: 0px; top: 18%; width: 100%; height: 83%; z-index: -1; background-color: rgb(245, 236, 209);"></div><div style="position: absolute; left: 0px; top: 20%; width: 100%; height: 81%; z-index: -1; background-color: rgb(244, 234, 204);"></div><div style="position: absolute; left: 0px; top: 22%; width: 100%; height: 79%; z-index: -1; background-color: rgb(243, 232, 198);"></div><div style="position: absolute; left: 0px; top: 24%; width: 100%; height: 77%; z-index: -1; background-color: rgb(242, 230, 193);"></div><div style="position: absolute; left: 0px; top: 26%; width: 100%; height: 75%; z-index: -1; background-color: rgb(241, 228, 188);"></div><div style="position: absolute; left: 0px; top: 28%; width: 100%; height: 73%; z-index: -1; background-color: rgb(240, 226, 183);"></div><div style="position: absolute; left: 0px; top: 30%; width: 100%; height: 71%; z-index: -1; background-color: rgb(239, 224, 178);"></div><div style="position: absolute; left: 0px; top: 32%; width: 100%; height: 69%; z-index: -1; background-color: rgb(238, 222, 173);"></div><div style="position: absolute; left: 0px; top: 34%; width: 100%; height: 67%; z-index: -1; background-color: rgb(237, 220, 168);"></div><div style="position: absolute; left: 0px; top: 36%; width: 100%; height: 65%; z-index: -1; background-color: rgb(236, 218, 163);"></div><div style="position: absolute; left: 0px; top: 38%; width: 100%; height: 63%; z-index: -1; background-color: rgb(235, 216, 158);"></div><div style="position: absolute; left: 0px; top: 40%; width: 100%; height: 61%; z-index: -1; background-color: rgb(234, 214, 153);"></div><div style="position: absolute; left: 0px; top: 42%; width: 100%; height: 59%; z-index: -1; background-color: rgb(233, 212, 147);"></div><div style="position: absolute; left: 0px; top: 44%; width: 100%; height: 57%; z-index: -1; background-color: rgb(232, 210, 142);"></div><div style="position: absolute; left: 0px; top: 46%; width: 100%; height: 55%; z-index: -1; background-color: rgb(231, 208, 137);"></div><div style="position: absolute; left: 0px; top: 48%; width: 100%; height: 53%; z-index: -1; background-color: rgb(230, 206, 132);"></div><div style="position: absolute; left: 0px; top: 50%; width: 100%; height: 51%; z-index: -1; background-color: rgb(229, 204, 127);"></div><div style="position: absolute; left: 0px; top: 52%; width: 100%; height: 49%; z-index: -1; background-color: rgb(228, 201, 122);"></div><div style="position: absolute; left: 0px; top: 54%; width: 100%; height: 47%; z-index: -1; background-color: rgb(227, 199, 117);"></div><div style="position: absolute; left: 0px; top: 56%; width: 100%; height: 45%; z-index: -1; background-color: rgb(226, 197, 112);"></div><div style="position: absolute; left: 0px; top: 58%; width: 100%; height: 43%; z-index: -1; background-color: rgb(225, 195, 107);"></div><div style="position: absolute; left: 0px; top: 60%; width: 100%; height: 41%; z-index: -1; background-color: rgb(224, 193, 102);"></div><div style="position: absolute; left: 0px; top: 62%; width: 100%; height: 39%; z-index: -1; background-color: rgb(223, 191, 96);"></div><div style="position: absolute; left: 0px; top: 64%; width: 100%; height: 37%; z-index: -1; background-color: rgb(222, 189, 91);"></div><div style="position: absolute; left: 0px; top: 66%; width: 100%; height: 35%; z-index: -1; background-color: rgb(221, 187, 86);"></div><div style="position: absolute; left: 0px; top: 68%; width: 100%; height: 33%; z-index: -1; background-color: rgb(220, 185, 81);"></div><div style="position: absolute; left: 0px; top: 70%; width: 100%; height: 31%; z-index: -1; background-color: rgb(219, 183, 76);"></div><div style="position: absolute; left: 0px; top: 72%; width: 100%; height: 29%; z-index: -1; background-color: rgb(218, 181, 71);"></div><div style="position: absolute; left: 0px; top: 74%; width: 100%; height: 27%; z-index: -1; background-color: rgb(217, 179, 66);"></div><div style="position: absolute; left: 0px; top: 76%; width: 100%; height: 25%; z-index: -1; background-color: rgb(216, 177, 61);"></div><div style="position: absolute; left: 0px; top: 78%; width: 100%; height: 23%; z-index: -1; background-color: rgb(215, 175, 56);"></div><div style="position: absolute; left: 0px; top: 80%; width: 100%; height: 21%; z-index: -1; background-color: rgb(214, 173, 50);"></div><div style="position: absolute; left: 0px; top: 82%; width: 100%; height: 19%; z-index: -1; background-color: rgb(213, 171, 45);"></div><div style="position: absolute; left: 0px; top: 84%; width: 100%; height: 17%; z-index: -1; background-color: rgb(212, 169, 40);"></div><div style="position: absolute; left: 0px; top: 86%; width: 100%; height: 15%; z-index: -1; background-color: rgb(211, 167, 35);"></div><div style="position: absolute; left: 0px; top: 88%; width: 100%; height: 13%; z-index: -1; background-color: rgb(210, 165, 30);"></div><div style="position: absolute; left: 0px; top: 90%; width: 100%; height: 11%; z-index: -1; background-color: rgb(209, 163, 25);"></div><div style="position: absolute; left: 0px; top: 92%; width: 100%; height: 9%; z-index: -1; background-color: rgb(208, 161, 20);"></div><div style="position: absolute; left: 0px; top: 94%; width: 100%; height: 7%; z-index: -1; background-color: rgb(207, 159, 15);"></div><div style="position: absolute; left: 0px; top: 96%; width: 100%; height: 5%; z-index: -1; background-color: rgb(206, 157, 10);"></div><div style="position: absolute; left: 0px; top: 98%; width: 100%; height: 3%; z-index: -1; background-color: rgb(205, 155, 5);"></div><div style="position: absolute; left: 0px; top: 100%; width: 100%; height: 1%; z-index: -1; background-color: rgb(204, 153, 0);"></div><a class="button" href="#" title="搜尋本 Wiki"> 尋找</a><input size="15" accesskey="F" autocomplete="off" type="text"><a class="button" href="#" title="關閉所有開啟中的 tiddler (編輯中除外)">全部關閉</a><a class="button" href="#" title="可存取現有開啟之文章的連結位址">引用連結</a><a class="button" href="#" title="儲存所有文章，產生新的版本" accesskey="S">儲存變更</a><a class="button" href="#" title="變更 TiddlyWiki 選項">偏好設定</a><div class="sliderPanel" cookie="chkSliderOptionsPanel" style="display: none;">這些設定將暫存於瀏覽器中，<br>請簽名<input option="txtUserName" size="15" value="YourName"><br> (範例：<a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/5 下午5:31:00" tiddlylink="WikiWord">WikiWord</a>)<br><br> <input type="checkbox" option="chkSaveBackups" checked="checked"> <a class="tiddlyLink tiddlyLinkNonExisting" href="#" title="'儲存備份' 尚無內容" tiddlylink="儲存備份">儲存備份</a><br><input type="checkbox" option="chkAutoSave"> <a class="tiddlyLink tiddlyLinkNonExisting" href="#" title="'自動儲存' 尚無內容" tiddlylink="自動儲存">自動儲存</a><br><input type="checkbox" option="chkGenerateAnRssFeed"> <a class="tiddlyLink tiddlyLinkNonExisting" href="#" title="'產生 RssFeed' 尚無內容" tiddlylink="產生 RssFeed">產生 RssFeed</a><br><input type="checkbox" option="chkRegExpSearch"> <a class="tiddlyLink tiddlyLinkNonExisting" href="#" title="'正規式搜尋' 尚無內容" tiddlylink="正規式搜尋">正規式搜尋</a><br><input type="checkbox" option="chkCaseSensitiveSearch"> <a class="tiddlyLink tiddlyLinkNonExisting" href="#" title="'區分大小寫搜尋' 尚無內容" tiddlylink="區分大小寫搜尋">區分大小寫搜尋</a><br><input type="checkbox" option="chkAnimate" checked="checked"> <a class="tiddlyLink tiddlyLinkNonExisting" href="#" title="'使用動畫顯示' 尚無內容" tiddlylink="使用動畫顯示">使用動畫顯示</a><br><br> <a class="button" href="#" title="網站設定">網站設定</a><div class="sliderPanel" cookie="sliderSiteSetupOptions" style="display: none;"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/10/5 下午2:37:00" tiddlylink="SiteTitle">網站標題</a><br><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午10:56:00" tiddlylink="SiteSubtitle">網站副標題</a><br><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午10:49:00" tiddlylink="DefaultTiddlers">預設載入條目</a><br><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/11/10 上午10:03:00" tiddlylink="MainMenu">修改主選單</a><br><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/10/7 下午1:20:00" tiddlylink="SiteUrl">修改網址</a>(製作RSS Feed時會用到)</div><br> <a class="button" href="#" title="進階選項">進階選項</a><div class="sliderPanel" cookie="sliderAdvancedOptions" style="display: none;"><input type="checkbox" option="chkOpenInNewWindow" checked="checked"> 連結開啟於新視窗<br><input type="checkbox" option="chkSaveEmptyTemplate"> 儲存範本<br><input type="checkbox" option="chkToggleLinks"> 點擊文章使已開啟者關閉<br><br><input type="checkbox" option="chkHttpReadOnly"> 隱藏編輯功能 (<code>http:</code>)<br><input type="checkbox" option="chkForceMinorUpdate"> 修改文章不變更日期時間<br>(確認修改同時按 Shift 鍵，或只按 <a class="tiddlyLink tiddlyLinkNonExisting" href="#" title="'Ctrl-Shift-Enter' 尚無內容" tiddlylink="Ctrl-Shift-Enter">Ctrl-Shift-Enter</a>)</div></div></div></div>
			<div id="sidebarTabs"><div class="txtMainTab"><div class="tabset" cookie="txtMainTab"><a class="tab tabSelected" href="#" title="依更新日期排序" tab="最近更新" content="TabTimeline">最近更新</a><a class="tab tabUnselected" href="#" title="所有文章" tab="全部" content="TabAll">全部</a><a class="tab tabUnselected" href="#" title="依標籤分類" tab="分類" content="TabTags">分類</a><a class="tab tabUnselected" href="#" title="其他" tab="更多" content="TabMore">更多</a></div><div class="tabContents"><ul><li class="listTitle">2018年12月16日</li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午2:03:20" tiddlylink="游记画册">游记画册</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:58:10" tiddlylink="美景欣赏">美景欣赏</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:57:27" tiddlylink="附加信息法规">附加信息法规</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:55:58" tiddlylink="必玩景点">必玩景点</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:47:59" tiddlylink="云南印象">云南印象</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:46:41" tiddlylink="首页">首页</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:42:17" tiddlylink="MainMenu">MainMenu</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:38:30" tiddlylink="SiteSubtitle">SiteSubtitle</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:37:59" tiddlylink="SiteTitle">SiteTitle</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:37:40" tiddlylink="網站設定">網站設定</a></li></ul><ul><li class="listTitle">2005年11月10日</li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/11/10 上午10:31:00" tiddlylink="擴充套件">擴充套件</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/11/10 上午9:51:00" tiddlylink="OptionsPanel">OptionsPanel</a></li></ul><ul><li class="listTitle">2005年11月04日</li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/11/4 下午3:38:00" tiddlylink="CalendarPlugin 自訂巨集">CalendarPlugin 自訂巨集</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/11/4 下午3:23:00" tiddlylink="CalendarPlugin">CalendarPlugin</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/11/4 下午3:21:00" tiddlylink="新增擴充套件">新增擴充套件</a></li></ul><ul><li class="listTitle">2005年11月03日</li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午11:13:00" tiddlylink="DisplayDefaultMacro 自訂巨集">DisplayDefaultMacro 自訂巨集</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午10:23:00" tiddlylink="WikiBarPlugin 外掛">WikiBarPlugin 外掛</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午10:20:00" tiddlylink="安裝擴充套件提示">安裝擴充套件提示</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午10:06:00" tiddlylink="ListTagsMacro">ListTagsMacro</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午5:51:00" tiddlylink="如何做…">如何做…</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午5:49:00" tiddlylink="HTML語法支援">HTML語法支援</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午4:59:00" tiddlylink="自訂巨集">自訂巨集</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午4:55:00" tiddlylink="更新的原理">更新的原理</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午4:48:00" tiddlylink="更新">更新</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:31:00" tiddlylink="註解">註解</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:21:00" tiddlylink="巨集">巨集</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:21:00" tiddlylink="樣式">樣式</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:20:00" tiddlylink="固定字">固定字</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:20:00" tiddlylink="標籤">標籤</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:19:00" tiddlylink="如何使 WikiWord 失效">如何使 WikiWord 失效</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:19:00" tiddlylink="水平線">水平線</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:18:00" tiddlylink="標題">標題</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:18:00" tiddlylink="縮排">縮排</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:18:00" tiddlylink="表格">表格</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:17:00" tiddlylink="列表">列表</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:17:00" tiddlylink="外部連結">外部連結</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:17:00" tiddlylink="插入圖檔">插入圖檔</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:17:00" tiddlylink="格式化文字">格式化文字</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:15:00" tiddlylink="Tiddler">Tiddler</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/11/3 下午3:14:00" tiddlylink="如何開始">如何開始</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/11/3 上午11:59:00" tiddlylink="SandBox">SandBox</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/11/3 上午11:45:00" tiddlylink="DisplayDefaultMacro">DisplayDefaultMacro</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/11/3 上午11:35:00" tiddlylink="WikiBarPlugin">WikiBarPlugin</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/11/3 上午10:59:00" tiddlylink="中文翻譯">中文翻譯</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/11/3 上午10:58:00" tiddlylink="TiddlyWiki 相關連結">TiddlyWiki 相關連結</a></li></ul><ul><li class="listTitle">2005年10月07日</li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/10/7 下午1:20:00" tiddlylink="SiteUrl">SiteUrl</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/10/7 下午1:15:00" tiddlylink="關於本站">關於本站</a></li></ul><ul><li class="listTitle">2005年10月06日</li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午10:52:00" tiddlylink="關於我">關於我</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午10:49:00" tiddlylink="DefaultTiddlers">DefaultTiddlers</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午10:07:00" tiddlylink="gradient">gradient</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午10:03:00" tiddlylink="Sparklines">Sparklines</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午9:39:00" tiddlylink="tabs">tabs</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午9:21:00" tiddlylink="list">list</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午9:18:00" tiddlylink="slider">slider</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午8:59:00" tiddlylink="version">version</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午8:57:00" tiddlylink="tiddler">tiddler</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午8:50:00" tiddlylink="newJournal">newJournal</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午8:50:00" tiddlylink="newTiddler">newTiddler</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午8:43:00" tiddlylink="tag">tag</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午8:38:00" tiddlylink="today">today</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午5:32:00" tiddlylink="特殊標籤">特殊標籤</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午5:24:00" tiddlylink="主選單">主選單</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午5:23:00" tiddlylink="首頁預設 Tiddler">首頁預設 Tiddler</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午5:22:00" tiddlylink="網站副標題">網站副標題</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/6 下午5:22:00" tiddlylink="網站標題">網站標題</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/10/6 上午9:56:00" tiddlylink="歡迎">歡迎</a></li></ul><ul><li class="listTitle">2005年10月05日</li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/5 下午5:31:00" tiddlylink="WikiWord">WikiWord</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="lss, 2005/10/5 下午5:29:00" tiddlylink="FreeLink">FreeLink</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/10/5 下午2:39:00" tiddlylink="使用教學">使用教學</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/10/5 下午2:38:00" tiddlylink="TiddlyWiki">TiddlyWiki</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/10/5 下午2:05:00" tiddlylink="容易編輯">容易編輯</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/10/5 下午1:51:00" tiddlylink="認識環境">認識環境</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/10/5 下午1:34:00" tiddlylink="儲存變更">儲存變更</a></li><li class="listLink"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2005/10/5 下午12:11:00" tiddlylink="容易攜帶">容易攜帶</a></li></ul></div></div></div>
		</div>
		<div id="mainMenu"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:46:41" tiddlylink="首页">首页</a><br><br><hr><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:47:59" tiddlylink="云南印象">云南印象</a><br><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:58:10" tiddlylink="美景欣赏">美景欣赏</a><br><br><hr><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:55:58" tiddlylink="必玩景点">必玩景点</a><br><hr><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午2:03:20" tiddlylink="游记画册">游记画册</a><br><hr><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:57:27" tiddlylink="附加信息法规">附加信息法规</a></div>
		<div id="displayArea">
			<div id="messageArea" style="display: none;"></div>
			<div id="tiddlerDisplay"><div class="tiddler" id="tiddlerSaveChanges"><div class="unselectedTiddler"><div class="toolbar" id="toolbarSaveChanges">&nbsp;<a class="button" href="#" title="關閉本文">關閉</a>&nbsp;<a class="button" href="#" title="編輯本文">編輯</a>&nbsp;<a class="button" href="#" title="本文引用連結">引用連結</a>&nbsp;<a class="button" href="#" title="引用本文的文章">引用</a>&nbsp;</div><div class="title" id="titleSaveChanges">SaveChanges</div><div class="body" id="bodySaveChanges"><div class="viewer" id="viewerSaveChanges" style="font-style: italic; overflow: visible; height: auto;"></div></div><div class="footer" id="footerSaveChanges"></div></div></div><div class="tiddler" id="tiddlerMainMenu"><div class="selectedTiddler"><div class="toolbar" id="toolbarMainMenu">&nbsp;<a class="button" href="#" title="關閉本文">關閉</a>&nbsp;<a class="button" href="#" title="編輯本文">編輯</a>&nbsp;<a class="button" href="#" title="本文引用連結">引用連結</a>&nbsp;<a class="button" href="#" title="引用本文的文章">引用</a>&nbsp;</div><div class="title" id="titleMainMenu" title="YourName, 2018/12/16 下午1:42:17">MainMenu</div><div class="body" id="bodyMainMenu"><div class="viewer" id="viewerMainMenu" tags="Introduction" style="overflow: visible; height: auto;"><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:46:41" tiddlylink="首页">首页</a><br><br><hr><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:47:59" tiddlylink="云南印象">云南印象</a><br><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:58:10" tiddlylink="美景欣赏">美景欣赏</a><br><br><hr><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:55:58" tiddlylink="必玩景点">必玩景点</a><br><hr><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午2:03:20" tiddlylink="游记画册">游记画册</a><br><hr><a class="tiddlyLink tiddlyLinkExisting" href="#" title="YourName, 2018/12/16 下午1:57:27" tiddlylink="附加信息法规">附加信息法规</a></div></div><div class="footer" id="footerMainMenu">&nbsp;<div>標籤: <a class="button" href="#" title="顯示標籤為 'systemTiddlers' 的文章" tag="systemTiddlers" tiddler="MainMenu">systemTiddlers</a> </div></div></div></div><div class="tiddler" id="tiddler首页"><div class="unselectedTiddler"><div class="toolbar" id="toolbar首页">&nbsp;<a class="button" href="#" title="關閉本文">關閉</a>&nbsp;<a class="button" href="#" title="編輯本文">編輯</a>&nbsp;<a class="button" href="#" title="本文引用連結">引用連結</a>&nbsp;<a class="button" href="#" title="引用本文的文章">引用</a>&nbsp;</div><div class="title" id="title首页" title="YourName, 2018/12/16 下午1:46:41">首页</div><div class="body" id="body首页"><div class="viewer" id="viewer首页" tags="Introduction" style="overflow: visible; height: auto;">若你想要去云南游玩，则你必须要了解的攻略<br>点击这儿&gt;<a class="externalLink" href="http://www.mafengwo.cn/travel-scenic-spot/mafengwo/12711.html" title="外部連結至 http://www.mafengwo.cn/travel-scenic-spot/mafengwo/12711.html" target="_blank">2018云南旅游攻略</a></div></div><div class="footer" id="footer首页">&nbsp;<div>未設標籤</div></div></div></div><div class="tiddler" id="tiddler云南印象"><div class="unselectedTiddler"><div class="toolbar" id="toolbar云南印象">&nbsp;<a class="button" href="#" title="關閉本文">關閉</a>&nbsp;<a class="button" href="#" title="編輯本文">編輯</a>&nbsp;<a class="button" href="#" title="本文引用連結">引用連結</a>&nbsp;<a class="button" href="#" title="引用本文的文章">引用</a>&nbsp;</div><div class="title" id="title云南印象" title="YourName, 2018/12/16 下午1:47:59">云南印象</div><div class="body" id="body云南印象"><div class="viewer" id="viewer云南印象" tags="Introduction" style="overflow: visible; height: auto;">这里的山，云梦萦绕；这里的水，满江春意；这里的花，争相竞艳；这里的人，淳朴善良。千年历史，多民族多文化交融，形成了独特彩云之南。<br>云南，素以其美丽、丰饶、神奇而著称于世，一向被外界称为“秘境”，吸引着世界各地的游客。闻名于世的金沙江、怒江、澜沧江几乎并排地经这里流向远方，险峰峡谷纵横交错，江河溪流源远流长，湖泊温泉星罗棋布，造就了这块神奇美丽的乐土。 <br>从
 
世界园艺博览会举办地的省城昆明，到“风花雪月”的大理名胜；从高原水城丽江、神奇的“香格里拉”—中甸，到孔雀曼舞的西双版纳；从“天下第一奇观”的石
 
林、千姿百态的元谋土林，到世所罕见的“三江”并流，江狭水凶的虎跳峡……这些迥然相异的山川景色，如一个天然的自然博物馆，每一位来到这里的游客，都会
 深深地感受到这是一块博大而充满激情、深邃而富有魅力的神奇之地。<br></div></div><div class="footer" id="footer云南印象">&nbsp;<div>未設標籤</div></div></div></div><div class="tiddler" id="tiddler美景欣赏"><div class="unselectedTiddler"><div class="toolbar" id="toolbar美景欣赏">&nbsp;<a class="button" href="#" title="關閉本文">關閉</a>&nbsp;<a class="button" href="#" title="編輯本文">編輯</a>&nbsp;<a class="button" href="#" title="本文引用連結">引用連結</a>&nbsp;<a class="button" href="#" title="引用本文的文章">引用</a>&nbsp;</div><div class="title" id="title美景欣赏" title="YourName, 2018/12/16 下午1:58:10">美景欣赏</div><div class="body" id="body美景欣赏"><div class="viewer" id="viewer美景欣赏" tags="Introduction" style="overflow: visible; height: auto;"><img src="yunnanmj_files/showpic01.jpg"><br><br>聆听原味儿丽江<br><br><br><img src="yunnanmj_files/showpic02.jpg"><br><br>奇特的象形文<br><br><br><img src="yunnanmj_files/showpic03.jpg"><br><br>大研古城，系上许愿<br><br><br><img src="yunnanmj_files/showpic04.jpg"><br><br>崇圣寺，看三塔倒影<br><br><br><img src="yunnanmj_files/showpic05.jpg"><br><br>大理<br><br><br><img src="yunnanmj_files/showpic06.jpg"><br><br>金马碧鸡坊</div></div><div class="footer" id="footer美景欣赏">&nbsp;<div>未設標籤</div></div></div></div><div class="tiddler" id="tiddler必玩景点"><div class="unselectedTiddler"><div class="toolbar" id="toolbar必玩景点">&nbsp;<a class="button" href="#" title="關閉本文">關閉</a>&nbsp;<a class="button" href="#" title="編輯本文">編輯</a>&nbsp;<a class="button" href="#" title="本文引用連結">引用連結</a>&nbsp;<a class="button" href="#" title="引用本文的文章">引用</a>&nbsp;</div><div class="title" id="title必玩景点" title="YourName, 2018/12/16 下午1:55:58">必玩景点</div><div class="body" id="body必玩景点"><div class="viewer" id="viewer必玩景点" tags="Introduction" style="overflow: visible; height: auto;"><img src="yunnanmj_files/objpic01.jpg"><br><br>丽江<br><br><br><img src="yunnanmj_files/objpic02.jpg"><br><br>大理<br><br><br><br><img src="yunnanmj_files/objpic03.jpg"><br><br>昆明</div></div><div class="footer" id="footer必玩景点">&nbsp;<div>未設標籤</div></div></div></div><div class="tiddler" id="tiddler游记画册"><div class="unselectedTiddler"><div class="toolbar" id="toolbar游记画册">&nbsp;<a class="button" href="#" title="關閉本文">關閉</a>&nbsp;<a class="button" href="#" title="編輯本文">編輯</a>&nbsp;<a class="button" href="#" title="本文引用連結">引用連結</a>&nbsp;<a class="button" href="#" title="引用本文的文章">引用</a>&nbsp;</div><div class="title" id="title游记画册" title="YourName, 2018/12/16 下午2:03:20">游记画册</div><div class="body" id="body游记画册"><div class="viewer" id="viewer游记画册" tags="Introduction" style="overflow: visible; height: auto;"><img src="yunnanmj_files/youji1.jpg"> <br>      光影佤乡 雾美沧源   <br><br>去
沧源的阵容空前强大，《中国国家地理》派出了一位负责人和三位摄影大咖，“百度旅游”则率领着一群小鲜肉旅行达人们，还有高大上的时尚杂志《漫旅》的美女
主编，加上“酱油大师”的我，一行人拿着东航的提供的免费机票如约而至。穿越旅行 
从大理到重庆酉阳成都九寨沟探友美图记西双版纳新玩法-被精灵守护的乐园<br>        <br><br><br><img src="yunnanmj_files/youji2.jpg"> <br>一座天空之城 —— 大理<br><br>又
 
去云南啊？你这是每年必去一次的节奏啊！我也在想，为啥每次定在国内旅游的地方，总会想起云南呢。我觉得大部分原因还是因为天气吧。我本身的体质属于淋巴
 循环不太好的那种，又生活在成都这样的潮湿环境里，所以每天早上都跟睡肿了一样，大家会觉得云南很干燥，但是我却很喜欢那样的气候<br>云南大理双廊腾冲银杏大理冬樱花 冬的季节来一场浪漫邂逅<br>(91日勇闯泰老云贵藏,尼泊尔印度斯里兰卡)<br>在花开的季节聆听开花的声音——尼汝<br><br><br>                                         <br><br>                                         <br>                                    <br>                      <br>                                                                           <br></div></div><div class="footer" id="footer游记画册">&nbsp;<div>未設標籤</div></div></div></div><div class="tiddler" id="tiddler附加信息法规"><div class="unselectedTiddler"><div class="toolbar" id="toolbar附加信息法规">&nbsp;<a class="button" href="#" title="關閉本文">關閉</a>&nbsp;<a class="button" href="#" title="編輯本文">編輯</a>&nbsp;<a class="button" href="#" title="本文引用連結">引用連結</a>&nbsp;<a class="button" href="#" title="引用本文的文章">引用</a>&nbsp;</div><div class="title" id="title附加信息法规" title="YourName, 2018/12/16 下午1:57:27">附加信息法规</div><div class="body" id="body附加信息法规"><div class="viewer" id="viewer附加信息法规" tags="Introduction" style="overflow: visible; height: auto;">信息网络传播保护条例<br><br>（1）信息内容：<br>①信息网络传播权的主体：我国《著作权法》中仅规定了三种信息网络传播权的权利主体：著作权人、表演者和录音录像制作者。<br>②
信息网络传播的客体：我国《著作权法》第三条规定的作品均可以被数字化后在信息网络中进行传播。因此，信息网络传播权的权利客体应该包含这些传统意义上 
的作品。同时，在信息网络环境中，侵权行为所侵害的客体不仅仅局限于著作权上，在邻接权方面也同样存在侵权行为。邻接权保护的客体主要包括表演者的表演、
 
录音录像制作者的录音录像制品、广播组织的广播电视节目等。所以，这些也应当属于信息网络传播权的权利客体。除了上述法律中明确规定的作品以外，网页也应
 当属于信息网络传播权的权利客体。 <br><br>（2）信息传播<br>①第一条　为保护著作权人、表演者、录音录像制作者（以下统称权利人）的信息网络传播权，鼓励有益于社会主义精神文明、物质文明建设的作品的创作和传播，根据《中华人民共和国著作权法》（以下简称著作权法），制定本条例。<br>　　第二条　权利人享有的信息网络传播权受著作权法和本条例保护。<br>第四条　为了保护信息网络传播权，权利人可以采取技术措施。<br>　　任何组织或者个人不得故意避开或者破坏技术措施，不得故意制造、进口或者向公众提供主要用于避开或者破坏技术措施的装置或者部件，不得故意为他人避开或者破坏技术措施提供技术服务<br><br>（3）信息利用<br>第二十二条　网络服务提供者为服务对象提供信息存储空间，供服务对象通过信息网络向公众提供作品、表演、录音录像制品，并具备下列条件的，不承担赔偿责任：<br>　　（一）明确标示该信息存储空间是为服务对象所提供，并公开网络服务提供者的名称、联系人、网络地址；<br>　　（二）未改变服务对象所提供的作品、表演、录音录像制品；<br>　　（三）不知道也没有合理的理由应当知道服务对象提供的作品、表演、录音录像制品侵权；<br>　　（四）未从服务对象提供作品、表演、录音录像制品中直接获得经济利益；<br>　　（五）在接到权利人的通知书后，根据本条例规定删除权利人认为侵权的作品、表演、录音录像制品。<br></div></div><div class="footer" id="footer附加信息法规">&nbsp;<div>未設標籤</div></div></div></div></div>
		</div>
	</div>
	<div id="storeArea"><div tiddler="CalendarPlugin" modified="200511041523" modifier="YourName" tags="systemConfig plugin">//
 //''Name:'' Calendar plugin\n// //''Version:'' &lt;&lt;getversion 
calendar&gt;&gt; (&lt;&lt;getversiondate calendar "DD MMM 
YYYY"&gt;&gt;)\n// //''Author:'' SteveRumsby\n\n// //''Syntax:'' \n// 
//{{{&lt;&lt;calendar&gt;&gt;}}} or {{{&lt;&lt; calendar //year// 
&gt;&gt;}}} or {{{&lt;&lt; calendar //year month// &gt;&gt;}}} or 
{{{&lt;&lt; calendar thismonth &gt;&gt;}}}\n\n// //''Description:'' \n//
 //The first form produces an full-year calendar for the current year. 
The second produces a full-year calendar for the given year. The third 
produces a single month calendar for the given month and year. The 
fourth form produces a single month calendar for the current month.\n// 
// Weekends and holidays are highlighted (see below for how to specify 
holdays).\n\n// //''Todo:''\n// //* Improve the formatting, especially 
when included in MainMenu\n// //* Find a better way of specifying 
holidays. It would be good to support calculated dates (e.g. Easter), 
and dates for different countries.\n// //* Add browsing facilities like 
jscalendar has\n// //* Highlight "today", if visible...\n// //* 
Integrate with the ReminderMacros\n\n// //''Configuration:''\n// 
//Modify this section to change the text displayed for the month and day
 names, to a different language for example. You can also change the 
format of the tiddler names linked to from each date, and the colours 
used.\n{{{\nconfig.macros.calendar = 
{};\n\nconfig.macros.calendar.monthnames = ["Jan", "Feb", "Mar", "Apr", 
"May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", 
"Dec"];\nconfig.macros.calendar.daynames = ["M", "T", "W", "T", "F", 
"S", "S"];\n\nconfig.macros.calendar.weekendbg = 
"#c0c0c0";\nconfig.macros.calendar.monthbg = 
"#e0e0e0";\nconfig.macros.calendar.holidaybg = "#ffc0c0";\n\n// //''Code
 section:''\n// (you should not need to alter anything below 
here)//\n\nconfig.macros.calendar.tiddlerformat = "YYYY MM DD";  // This
 used to be changeable - for now, it isn't// &lt;&lt;smiley :-(&gt;&gt; 
\n\nversion.extensions.calendar = { major: 0, minor: 2, revision: 0, 
date: new Date(2005, 07, 21)};\nconfig.macros.calendar.monthdays = [ 31,
 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 
31];\n\nconfig.macros.calendar.holidays = [ "01/01", "25/12", 
"03/01/2005", "02/05/2005", "30/05/2005", "29/08/2005" ];\n\nfunction 
calendarIsHoliday(date)\n{\n var longHoliday = 
date.formatString("0DD/0MM/YYYY");\n var shortHoliday = 
date.formatString("0DD/0MM");\n\n for(var i = 0; i &lt; 
config.macros.calendar.holidays.length; i++) {\n 
if(config.macros.calendar.holidays[i] == longHoliday || 
config.macros.calendar.holidays[i] == shortHoliday) {\n return true;\n 
}\n }\n return false;\n}\n\nconfig.macros.calendar.handler = 
function(place,macroName,params)\n{\n var calendar = 
createTiddlyElement(place, "table", null, "calendar", null);\n\n 
if(params[0] == "thismonth") {\n var today = new Date();\n 
createCalendarOneMonth(calendar, today.getYear()+1900, 
today.getMonth());\n } else {\n var year;\n if(params[0]) {\n year = 
params[0];\n } else {\n year = (new Date()).getYear() + 1900;\n }\n\n 
if(params[1]) {\n var month = params[1] -1;\n 
createCalendarOneMonth(calendar, year, month);\n } else {\n 
createCalendarYear(calendar, year);\n }\n }\n}\n\nfunction 
createCalendarOneMonth(calendar, year, mon)\n{\n var row = 
createTiddlyElement(calendar, "tr", null, null, null);\n 
createCalendarMonthHeader(row, config.macros.calendar.monthnames[mon] + "
 " + year, true);\n row = createTiddlyElement(calendar, "tr", null, 
null, null);\n createCalendarDayHeader(row, 1);\n 
createCalendarDayRowsSingle(calendar, year, mon);\n}\n\n\nfunction 
createCalendarMonth(calendar, year, mon)\n{\n var row = 
createTiddlyElement(calendar, "tr", null, null, null);\n 
createCalendarMonthHeader(row, config.macros.calendar.monthnames[mon] + "
 " + year, false);\n row = createTiddlyElement(calendar, "tr", null, 
null, null);\n createCalendarDayHeader(row, 1);\n 
createCalendarDayRowsSingle(calendar, year, mon);\n}\n\nfunction 
createCalendarYear(calendar, year)\n{\n var row;\n\n row = 
createTiddlyElement(calendar, "tr", null, null, null);\n var yearHeader =
 createTiddlyElement(row, "td", null, "calendarYear", year);\n 
yearHeader.align = "center";\n yearHeader.setAttribute("colSpan", 
21);\n\n createCalendarMonthRow(calendar, year, 0);\n 
createCalendarMonthRow(calendar, year, 3);\n 
createCalendarMonthRow(calendar, year, 6);\n 
createCalendarMonthRow(calendar, year, 9);\n}\n\nfunction 
createCalendarMonthRow(cal, year, mon)\n{\n var row = 
createTiddlyElement(cal, "tr", null, null, null);\n 
createCalendarMonthHeader(row, 
config.macros.calendar.monthnames[mon]);\n 
createCalendarMonthHeader(row, 
config.macros.calendar.monthnames[mon+1]);\n 
createCalendarMonthHeader(row, 
config.macros.calendar.monthnames[mon+2]);\n row = 
createTiddlyElement(cal, "tr", null, null, null);\n 
createCalendarDayHeader(row, 3);\n createCalendarDayRows(cal, year, 
mon);\n}\n\nfunction createCalendarMonthHeader(row, name, nav)\n{\n  var
 month;\n  if(nav) {\n    var back = createTiddlyElement(row, "td", 
null, null, null);\n    createTiddlyButton(back, "&lt;", "Back", 
onClickCalendarBack)\n    back.align = "center";\n    
back.style.background = config.macros.calendar.monthbg; \n    month = 
createTiddlyElement(row, "td", null, "calendarMonthname", name)\n    
month.setAttribute("colSpan", 5);\n    var fwd = 
createTiddlyElement(row, "td", null, null, null);\n    
createTiddlyButton(fwd, "&gt;", "Fwd", onClickCalendarFwd)\n    
fwd.align = "center";\n    fwd.style.background = 
config.macros.calendar.monthbg; \n  } else {\n    month = 
createTiddlyElement(row, "td", null, "calendarMonthname", name)\n    
month.setAttribute("colSpan", 7);\n  }\n  month.align = "center";\n  
month.style.background = config.macros.calendar.monthbg;\n}\n\nfunction 
onClickCalendarBack(e)\n{\n\n}\n\nfunction 
onClickCalendarFwd(e)\n{\n\n}\n\nfunction createCalendarDayHeader(row, 
num)\n{\n var cell;\n for(var i = 0; i &lt; num; i++) {\n for(var j = 0;
 j &lt; 7; j++) {\n cell = createTiddlyElement(row, "td", null, null, 
config.macros.calendar.daynames[j]);\n if(j &gt; 4) 
cell.style.background = config.macros.calendar.weekendbg;\n }\n 
}\n}\n\nfunction createCalendarDays(row, col, first, max, year, 
mon)\n{\n  var i;\n  for(i = 0; i &lt; col; i++) {\n    
createTiddlyElement(row, "td", null, null, null);\n  }\n  var day = 
first;\n  for(i = col; i &lt; 7; i++) {\n    var daycell = 
createTiddlyElement(row, "td", null, null, null);\n    if(i &gt; 4) 
daycell.style.background = config.macros.calendar.weekendbg;\n    if(day
 &gt; 0 &amp;&amp; day &lt;= max) {\n      var celldate = new Date(year,
 mon, day);\n      var title = 
celldate.formatString(config.macros.calendar.tiddlerformat);\n      
if(calendarIsHoliday(celldate)) {\n        daycell.style.background = 
config.macros.calendar.holidaybg;\n      }\n      
if(window.findTiddlersWithReminders == null) {\n        var link = 
createTiddlyLink(daycell, title, false);\n        
link.appendChild(document.createTextNode(day));\n      } else {\n       
 var button = createTiddlyButton(daycell, day, title, 
onClickCalendarDate);\n      }\n    }\n    day++;\n  }\n}\n\n// //We've 
clicked on a day in a calendar - create a suitable pop-up of 
options.\n// //The pop-up should contain:\n// // * a link to create a 
new entry for that date\n// // * a link to create a new reminder for 
that date\n// // * an &lt;hr&gt;\n// // * the list of reminders for that
 date\nfunction onClickCalendarDate(e)\n{\n  var button = this;\n  var 
date = button.getAttribute("title");\n  var dat = new 
Date(date.substr(6,4), date.substr(3,2)-1, date.substr(0, 2));\n\n  date
 = dat.formatString(config.macros.calendar.tiddlerformat);\n  var popup =
 createTiddlerPopup(this);\n  
popup.appendChild(document.createTextNode(date));\n  var newReminder = 
function() {\n    var t = store.tiddlers[date];\n    
displayTiddler(null, date, 2, null, null, false, false);\n    if(t) {\n 
     document.getElementById("editorBody" + date).value += 
"\sn&lt;&lt;reminder day:" + dat.getDate() +\n                          
                                                                        
  " month:" + (dat.getMonth()+1) +\n                                    
                                                                   " 
year:" + (dat.getYear()+1900) + " title: &gt;&gt;";\n    } else {\n     
 document.getElementById("editorBody" + date).value = "&lt;&lt;reminder 
day:" + dat.getDate() +\n                                               
                                                     " month:" + 
(dat.getMonth()+1) +\n                                                  
                                                     " year:" + 
(dat.getYear()+1900) + " title: &gt;&gt;";\n    }\n  };\n  var link = 
createTiddlyButton(popup, "New reminder", null, newReminder); \n  
popup.appendChild(document.createElement("hr"));\n\n  var t = 
findTiddlersWithReminders(dat, 0, null, null);\n  for(var i = 0; i &lt; 
t.length; i++) {\n    link = createTiddlyLink(popup, t[i].tiddler, 
false);\n    link.appendChild(document.createTextNode(t[i].tiddler));\n 
 }\n\n}\n\nfunction calendarMaxDays(year, mon)\n{\n var max = 
config.macros.calendar.monthdays[mon];\n if(mon == 1 &amp;&amp; (year % 
4) == 0 &amp;&amp; ((year % 100) != 0 || (year % 400) == 0)) {\n 
max++;\n }\n return max;\n}\n\nfunction createCalendarDayRows(cal, year,
 mon)\n{\n var row = createTiddlyElement(cal, "tr", null, null, 
null);\n\n var first1 = (new Date(year, mon, 1)).getDay() -1;\n 
if(first1 &lt; 0) first1 = 6;\n var day1 = -first1 + 1;\n var first2 = 
(new Date(year, mon+1, 1)).getDay() -1;\n if(first2 &lt; 0) first2 = 
6;\n var day2 = -first2 + 1;\n var first3 = (new Date(year, mon+2, 
1)).getDay() -1;\n if(first3 &lt; 0) first3 = 6;\n var day3 = -first3 + 
1;\n\n var max1 = calendarMaxDays(year, mon);\n var max2 = 
calendarMaxDays(year, mon+1);\n var max3 = calendarMaxDays(year, 
mon+2);\n\n while(day1 &lt;= max1 || day2 &lt;= max2 || day3 &lt;= max3)
 {\n row = createTiddlyElement(cal, "tr", null, null, null);\n 
createCalendarDays(row, 0, day1, max1, year, mon); day1 += 7;\n 
createCalendarDays(row, 0, day2, max2, year, mon+1); day2 += 7;\n 
createCalendarDays(row, 0, day3, max3, year, mon+2); day3 += 7;\n 
}\n}\n\nfunction createCalendarDayRowsSingle(cal, year, mon)\n{\n var 
row = createTiddlyElement(cal, "tr", null, null, null);\n\n var first1 =
 (new Date(year, mon, 1)).getDay() -1;\n if(first1 &lt; 0) first1 = 6;\n
 var day1 = -first1 + 1;\n var max1 = calendarMaxDays(year, mon);\n\n 
while(day1 &lt;= max1) {\n row = createTiddlyElement(cal, "tr", null, 
null, null);\n createCalendarDays(row, 0, day1, max1, year, mon); day1 
+= 7;\n }\n}\n\nsetStylesheet("#mainMenu table, th, tr, td 
{font-size:10pt;}", "calendarStyles");\n}}}</div>
<div tiddler="CalendarPlugin 自訂巨集" modified="200511041538" modifier="YourName" tags="擴充套件 自訂巨集 plugin">要
建立一個日誌用途的 TiddlyWiki 
時，能產生月曆或年曆是個很好的應用。這個[[自訂巨集]]可以讓我們產生一個月曆或年曆，並且每個日期都是一個 Tiddler 
連結，非常適合用來製作個人日誌型的記事用途。\n----\n!說明\n建立一個月曆或年曆，並且每個日期都是 Tiddler 
連結。\n!用法\n{{{\n本月月曆\n&lt;&lt;calendar 
thismonth&gt;&gt;\n2006年1月\n&lt;&lt;calendar 2006 
1&gt;&gt;\n今年年曆\n&lt;&lt;calendar&gt;&gt;\n2006年年曆\n&lt;&lt;calendar 
2006&gt;&gt;\n}}}\n!效果\n本月月曆\n&lt;&lt;calendar 
thismonth&gt;&gt;\n年曆效果請自行嘗試。\n----\n&gt;官方網站： SteveRumsby's 
[[YATWA|http://www.rumsby.org/yatwa/]]\n&gt;下載點： 
http://www.rumsby.org/yatwa/#CalendarPlugin\n&lt;&lt;tiddler 
安裝擴充套件提示&gt;&gt;</div>
<div tiddler="DefaultTiddlers" modified="200510062249" modifier="lss" tags="systemTiddlers">[[歡迎]]\n[[關於本站]]</div>
<div tiddler="DisplayDefaultMacro" modified="200511031145" modifier="YourName" tags="systemConfig plugin">//
 use &lt;&lt;displayDefaultTiddlers 'Home Page'&gt;&gt;\n// 
&lt;&lt;displayDefaultTiddlers&gt;&gt;\n{{{\nversion.extensions.displayDefaultTiddlers
 = {major: 0, minor: 1, revision: 0, date:new 
Date(2005,8,23)};\nconfig.macros.displayDefaultTiddlers = {label: 
"default tiddlers", prompt: "Display default tiddlers"};\n	
\nconfig.macros.displayDefaultTiddlers .handler = 
function(place,macroName,params) {\n  var displayDefaultTiddlersFunc = 
function () {\n	 var start = store.getTiddlerText("DefaultTiddlers");\n 
        closeAllTiddlers();\n         
displayTiddlers(null,start,1,null,null);\n   }\n  if (params[0]==null) 
{\n   
createTiddlyButton(place,this.label,this.prompt,displayDefaultTiddlersFunc);\n
  } else {\n   
createTiddlyButton(place,params[0],this.prompt,displayDefaultTiddlersFunc);\n
  }\n  }\n}}}</div>
<div tiddler="DisplayDefaultMacro 自訂巨集" modified="200511032313" modifier="lss" tags="擴充套件 自訂巨集 plugin">當
開啟的 Tiddler 愈來愈多時， TiddlyWiki 提供&lt;&lt;closeAll&gt;&gt;一次關閉所有開啟中的 
Tiddler 。但是&lt;&lt;closeAll&gt;&gt;與一般網站的回首頁連結是不同的，它會連 DefaultTiddlers 
裡的預設 Tiddler 也一併關閉。而 DisplayDefaultMacro 除了關閉所有開啟中的 Tiddler 之外，並且幫我們開啟 
DefaultTiddlers 清單的 Tiddler ，讓你的 TiddlyWiki 回到剛開啟的預設裝態。這個自訂巨集是收錄自 
[[zRenald's personal web 
notebook|http://www.zrenard.com/tiddlywiki/tiddlywiki.html]] 
。\n----\n!說明\n建立超連結，用來關閉所有已開啟的 Tiddler 並開啟 DefaultTiddlers 裡列出的所有 
Tiddler 。\n!用法\n{{{\n&lt;&lt;displayDefaultTiddlers 
回首頁&gt;&gt;\n}}}\n*其中的「''回首頁''」可以替換成任何其它文字或直接省略。\n!效果
\n&lt;&lt;displayDefaultTiddlers 回首頁&gt;&gt;\n----\n&gt;官方網站： 
[[zRenald's personal web 
notebook|http://www.zrenard.com/tiddlywiki/tiddlywiki.html]]\n&gt;下載點： 
http://www.zrenard.com/tiddlywiki/tiddlywiki.html#DisplayDefaultMacro\n\n&lt;&lt;tiddler
 安裝擴充套件提示&gt;&gt;</div>
<div tiddler="FreeLink" modified="200510051729" modifier="lss" tags="Introduction howto">當
我們要使用''中文''、''一個英文單字''、或是''標題中有空格''的方式來創建 Tiddler 時，就必需使用 FreeLink 。 
FreeLink 的使用方式，看實例最清楚。以下分別示範三種用法：\n{{{\n[[歡迎]] [[Tiddler]] [[Wiki 
Word]]\n}}}\n就是在 Tiddler 的標題前後用兩個中括弧夾起來便可。產生的結果如下：\n[[歡迎]] [[Tiddler]] 
[[Wiki Word]]\n\n&lt;&lt;tiddler '如何使 WikiWord 失效'&gt;&gt;</div>
<div tiddler="HTML語法支援" modified="200511031749" modifier="lss" tags="Introduction wiki語法 如何做系列">原
本需要外掛才能做到的，直接在 Tiddler 裡面使用 HTML 語法的功能，從 TiddlyWiki 1.2.37 版開始成為內建的功能。有了
 HTML 語法的支援，就能做到一些原本 wiki 
語法做不到的是，最明顯的就是@@color(#3300cc):插入表單@@或@@color(#3300cc):插入 flash 
動畫@@。\n\n使用方式，只要在 html 語法前後加上 {{{&lt;html&gt;}}} 和 {{{&lt;/html&gt;}}} 
標籤即可。\n\n*插入 flash 動畫範例：\n&lt;html&gt;\n&lt;EMBED 
SRC=images/digital_019.swf WIDTH=150 HEIGHT=90 wmode=transparent 
quality=high loop=true menu=false&gt;\n&lt;/html&gt;\n\nflash 小時鐘來源： 
http://www.butabon.com/clock.htm\n\n*原始碼：\n{{{\n&lt;html&gt;\n&lt;EMBED 
SRC=images/digital_019.swf WIDTH=150 HEIGHT=90 wmode=transparent 
quality=high loop=true menu=false&gt;\n&lt;/html&gt;\n}}}</div>
<div tiddler="ListTagsMacro" modified="200511032206" modifier="lss" tags="systemConfig plugin">//
 listtags tagname * or # or nothing\n// adding parameters to limit 
number of items (limit:number)\n// adding parameters to reverse order 
(reverse)\n{{{\nversion.extensions.listTags = {major: 0, minor: 1, 
revision: 0};\nconfig.macros.listTags = { text: "" 
};\nconfig.macros.listTags.handler = function(place,macroName,params)\n{
 var limit=0;\n  for(var t=0; t&lt;params.length; t++) {\n		 type = 
params[t].split(":")[0].toLowerCase();\n		 if (type == "limit")\n			 
limit = parseInt(params[t].split(":")[1]);\n		 if (type == "reverse")\n	
		 reverse= true;\n		 else\n		   reverse = false;\n   }\n   var tagged =
 store.getTaggedTiddlers(params[0],params[1]); //Second parameter is 
field to sort by (eg, title, modified, modifier or text)\n\nvar string =
 "";\nif (limit==0) limit = tagged.length; else 
limit=(limit&gt;tagged.length) ? tagged.length : limit;\n\n	 if 
(reverse==true) {\nfor(var 
r=tagged.length-1;r&gt;=(tagged.length-limit)&amp;&amp;r&gt;=0;r--) {\n 
if(params[2]) string = string + params[2] + " ";\n string = string + 
"[[" + tagged[r].title + "]]\sn";\n}\n	 } else {\nfor(var 
r=0;r&lt;limit;r++) {\n if(params[2]) string = string + params[2] + " 
";\n string = string + "[[" + tagged[r].title + "]]\sn";\n}\n	 
}\n\nwikify(string, place, null, null);\n}\n}}}</div>
<div tiddler="MainMenu" modified="200511101003" modifier="YourName" tags="systemTiddlers">&lt;&lt;displayDefaultTiddlers
 
'回首頁'&gt;&gt;\n[[歡迎]]\nTiddlyWiki\n[[認識環境]]\n[[使用教學]]\n[[容易攜帶]]\n[[容易編
輯]]\n[[如何做…]]\n[[擴充套件]]\n----\n[[關於本站]]\n[[關於我]]
\n[img[RSS|images/rss.gif][TiddlyWikiTutorialTW.xml]]\nSandBox\n----\n&lt;&lt;newTiddler&gt;&gt;\n&lt;&lt;newJournal
 "YYYY MM DD"&gt;&gt;\n----\n[[TiddlyWiki 
相關連結]]\n本站使用版本：@@&lt;&lt;version&gt;&gt;@@</div>
<div tiddler="OptionsPanel" modified="200511100951" modifier="YourName" tags="systemTiddlers">這
些設定將暫存於瀏覽器中，\n請簽名&lt;&lt;option txtUserName&gt;&gt;\n (範例：WikiWord)\n\n 
&lt;&lt;option chkSaveBackups&gt;&gt; [[儲存備份]]\n&lt;&lt;option 
chkAutoSave&gt;&gt; [[自動儲存]]\n&lt;&lt;option 
chkGenerateAnRssFeed&gt;&gt; [[產生 RssFeed]]\n&lt;&lt;option 
chkRegExpSearch&gt;&gt; [[正規式搜尋]]\n&lt;&lt;option 
chkCaseSensitiveSearch&gt;&gt; [[區分大小寫搜尋]]\n&lt;&lt;option 
chkAnimate&gt;&gt; [[使用動畫顯示]]\n\n &lt;&lt;slider sliderSiteSetupOptions 
網站設定 網站設定 '網站設定'&gt;&gt;\n &lt;&lt;slider sliderAdvancedOptions 
AdvancedOptions 進階選項 '進階選項'&gt;&gt;</div>
<div tiddler="SandBox" modified="200511031159" modifier="YourName" tags="">在這裡試各種 wiki 語法，不要隨便破壞其它文章的版面\n----\n\n&lt;&lt;calendar thismonth&gt;&gt;</div>
<div tiddler="SiteSubtitle" modified="200510062256" modifier="lss" tags="systemTiddlers">以專注於內容的''一般使用者''觀點出發！</div>
<div tiddler="SiteTitle" modified="200510051437" modifier="YourName" tags="systemTiddlers">TiddlyWiki 使用教學中文版</div>
<div tiddler="SiteUrl" modified="200510071320" modifier="YourName" tags="systemTiddlers">http://web.nlhs.tyc.edu.tw/~lss/wiki/TiddlyWikiTutorialTW.html</div>
<div tiddler="Sparklines" modified="200510062203" modifier="lss" tags="Introduction howto">!
說明\n老實說，我對 [[Sparklines]] 是什麼完全沒有概念。Google 了一下，在 http://sparkline.org/ 
找到下面這段說明：\n&gt;What Are Sparklines?\n&gt;\n&gt;Sparklines are "intense, 
simple, wordlike graphics" so named by Edward Tufte. In lieu of a more 
detailed introduction, Professor Tufte's site has an early release of a 
chapter on 
sparklines.\n所以它是一種''簡單地、看起來像文字一樣的圖表''。這個[[巨集]]完全不需要用到任何的繪圖函式庫，便可以直接在 
TiddlyWiki 裡畫出 [[Sparklines]]，只需要給他一堆數字即可。\n!用法\n{{{\n&lt;&lt;sparkline 
163 218 231 236 232 266 176 249 289 1041 1835 2285 3098 2101 1755 3283 
3353 3335 2898 2224 1404 1354 1825 1839 2142 1942 1784 1145 979 1328 
1611&gt;&gt;\n}}}\n!效果\n&lt;&lt;sparkline 163 218 231 236 232 266 176 
249 289 1041 1835 2285 3098 2101 1755 3283 3353 3335 2898 2224 1404 1354
 1825 1839 2142 1942 1784 1145 979 1328 1611&gt;&gt;</div>
<div tiddler="Tiddler" modified="200511031515" modifier="lss" tags="Introduction howto 如何做系列">在
[[使用教學]]裡，我們曾經提過 Tiddler 是一段文章段落。那麼 Tiddler 是如何組成的呢？\n\n在網站裡，可以看到很多 
TiddlyWiki 這樣的英文單字組合，而且都連結至一個 Tiddler ，這樣的英文單字組合稱為 WikiWord 。在文章裡的任何 
WikiWord 都會是一個 Tiddler 的連結。所以，要建立一個 Tiddler ，只要在文章裡的任何地方加上一個 WikiWord 
便可。如果同名的 Tiddler 已經存在，則滑鼠點選 WikiWord 之後，便會開啟所指的 Tiddler 。如果沒有任何現有的 
Tiddler 標題與該 WikiWord 相符，那麼，你已經創建了一個新的 Tiddler 
。\n\n另外，我們也可以從左側功能表的&lt;&lt;newTiddler&gt;&gt;創建一個全新的 Tiddler 
，或是用&lt;&lt;newJournal "DD MMM YYYY"&gt;&gt;也可以創建一個新的 Tiddler 
。兩者的不同是，&lt;&lt;newJournal "DD MMM YYYY"&gt;&gt;會自動在 Tiddler 
的標題填上現在的年月日，做為寫日誌的用途。\n\n除了 WikiWord 之外，網站上也看到了很多''標題為中文''的 Tiddler 
。這是使用 FreeLink 的方式建立的 Tiddler 。有些時候，我們需要的 Tiddler 
標題可能只有一個英文單字，或是單字中間加上空格，尤其是中文字的標題，跟本不可產生 WikiWord ，所以， wiki 便發展出了 
FreeLink 這樣的方式來創建 Tiddler 。\n\n&lt;&lt;tiddler FreeLink&gt;&gt;</div>
<div tiddler="TiddlyWiki" modified="200510051438" modifier="YourName" tags="Introduction">TiddlyWiki
 是一個由「 javascript + CSS 樣式 + HTML 語法」所組成的 html 檔。它可以讓你''在本機編輯''使用 wiki 
語法編輯網頁內容，除了不像一般的 wiki 程式可以在網路上供多人共同編輯之外，其它的功能一概不缺。更重要的是，他只需要一個小小的 html 
檔案就可以使用瀏覽器執行，完全不需要網路主機、PHP 或 ASP 以及資料庫等的支援。你所寫的文章，也是存在這個 html 
檔裡，沒錯，''全部就只有一個檔''。\n\n說了這麼多， TiddlyWiki 
到底能做什麼？你可以把它存在個人電腦裡，用來做個人記事本、行事曆、日記、備忘錄、待辦事項…等。放在隨身碟裡，還可以到處帶著走，放到個人網頁空間，
就成了個人網站。以上這些功能，全都在一個小小的 html 檔案裡，非常方便。\n\n推薦看看老貓寫的這篇文章：[[TiddlyWiki 
真好玩|http://b-oo-k.net/blog/post/1/400]]，看看如何發揮想像力，讓 TiddlyWiki 
為你發揮他的潛能。\n\n如果 TiddlyWiki 
已經吸引你的目光，請繼續往下看[[認識環境]]；如果你已迫不及待想直接使用，請直接看[[使用教學]]。</div>
<div tiddler="TiddlyWiki 相關連結" modified="200511031058" modifier="YourName" tags="Introduction">*
中文資源：\n**[[BramChen 的 
PrinceTiddlyWiki|http://ptw.sourceforge.net/]]。\n**[[MilchFlasche 的 
TiddlyWiki之美|http://linshi.twbbs.org/usr/m/milchflasche
/TiddlyWiki.html]]。\n**老貓的兩篇介紹文章：[[TiddlyWiki真好玩|http://b-oo-k.net/blog
/post/1/400]] 和 
[[TiddlyWiki安裝與使用指南|http://b-oo-k.net/blog/post/1/401]]。\n**~TiddlyWiki 
的[[中文 google 
group|http://groups.google.com/group/PrinceTiddlyWiki]]。\n**敝小站：[[中文使用教
學|http://web.nlhs.tyc.edu.tw/wiki/TiddlyWikiTutorialTW.html]]。\n*英文資源：
\n**[[TiddlyWiki 官方網站|http://www.tiddlywiki.com]]。\n**~TiddlyWiki 的[[英文 
google 
group|http://groups.google.com/group/TiddlyWiki]]。\n**官方推薦教學網站：
[[TiddlyWikiTutorial|http://www.blogjones.com
/TiddlyWikiTutorial.html]]。\n**官方推薦 ~TiddlyWiki 好用 Tips 
網站：[[TiddlyWikiTips|http://tiddlywikitips.com/]]。\n**官方推薦另一個好用 Tips 
網站：[[zRenard's personal web 
notebook|http://www.zrenard.com/tiddlywiki/tiddlywiki.html]]</div>
<div tiddler="WikiBarPlugin" modified="200511031135" modifier="YourName" tags="systemConfig plugin">/***\n|''Name:''|WikiBarPlugin|\n|''Version:''|1.1.0|\n|''Source:''|[[AiddlyWiki|http://aiddlywiki.sourceforge.net]]|\n|''Author:''|[[Arphen
 Lin|mailto:arphenlin@gmail.com]]|\n|''Type:''|Plugin 
extension|\n|''Required:''|TiddlyWiki 1.2.36+|\n!Description\nThe 
WikiBarPlugin provides user a TiddlyWiki syntax-bar under the tiddler 
edit mode. It's a handy tool for people who are not familiar with the 
TiddlyWiki syntax.\n!Support browser\n*Firefox 1.0.7\n!Revision 
history\n*v1.0.0 (2005/10/30)\n**Initial release\n*v1.1.0 
(2005/11/01)\n**Bugs fixed:\n***WikiBar overruns (reported by by 
"GeoffS" &lt;gslocock@yahoo.co.uk&gt;)\n**New features:\n***Insert a 
color code at the cursor. (Thanks to "RunningUtes" 
&lt;RunningUtes@gmail.com&gt;)\n***Enable gradient macro. (Thanks to 
"RunningUtes" &lt;RunningUtes@gmail.com&gt;)\n***Insert tiddler comment 
tags {{{/% ... %/}}}. (new feature supported by TiddlyWiki 
1.2.37)\n***Insert DateFormatString for {{{&lt;&lt;today&gt;&gt;}}} 
macro. (new feature supported by TiddlyWiki 
1.2.37)\n**Enhanced:\n***Allow optional parameters in 
syntax.\n!Code\n***/\n//{{{\n\nversion.extensions.WikiBar = {major: 1, 
minor: 1, revision: 0, date: new 
Date(2005,11,1)};\n\n//------------------------------------------------------------------------------------------------\n//
 the syntax will be applied on the current word\n// params: editor, 
[[param1],[param2],...]\n//------------------------------------------------------------------------------------------------\napl_wikibar_formatByWord
 = function(editor, params){\n\n  clearMessage();\n  \n  try{\n  \n    
if(!editor) return;\n    \n    repText = 
processSyntaxParams(this.syntax, params);\n    if(!repText)  return;\n  
    	\n  	var st = editor.scrollTop;\n  	var ss = 
editor.selectionStart;\n  	var se = editor.selectionEnd;\n  	\n//  	
displayMessage(ss + ',' + se);\n  	\n		var frontText= '';\n		var selText
  = '';\n		var endText  = '';\n		var fullText = editor.value;\n		\n		
if(se&gt;ss &amp;&amp; ss&gt;=0){   // has selection\n  	  frontText  = 
fullText.substring(0, ss);	// text before selection\n  	  selText	   = 
fullText.substring(ss,se);\n  	  endText    = fullText.substring(se, 
fullText.length);	// text behind selection\n		}\n		else if(ss==0 
&amp;&amp; (se==0 || se == fullText.length) ){  // no selection, cursor 
in begin\n      endText    = fullText;	// text behind selection\n		}\n		
else if(se==ss &amp;&amp; ss&gt;0){  // no selection, cursor in text\n	 
   frontText  = fullText.substring(0, ss);	// text before selection\n	  
  endText    = fullText.substring(se, fullText.length);	// text behind 
selection\n\n		  //select a word\n		  if( 
fullText.charAt(ss-1).match(/\sW/gi) || 
fullText.charAt(ss).match(/\sW/gi) ){ \n		    ;\n		  }\n		  else{ // 
cursor in text\n\n        // find the lastest non-word position of 
frontText\n        var m = frontText.match(/\sW/gi);\n        if(m){\n  
        ss = frontText.lastIndexOf(m[m.length-1])+1;\n        }\n       
 else{ // not found\n          ss = 0;          \n        }\n        \n 
       \n    	  // find the first non-word position of endText\n        m
 = endText.match(/\sW/gi);\n        if(m){\n          se += 
endText.indexOf(m[0]);\n        }\n        else{ // not found\n         
 se = fullText.length;\n        }\n\n    	  // re-positioning\n//    	  
displayMessage(ss + ',' + se);\n        frontText = 
fullText.substring(0, ss);	// text before selection\n    	  endText   = 
fullText.substring(se, fullText.length);	// text behind selection\n    	
  selText   = fullText.substring(ss,se);\n		    \n		  }\n		}\n  	\n  	
if(selText.length&gt;0)\n  		repText = repText.replace('user_text', 
selText);\n  		\n		if(repText.indexOf('user_text')&gt;=0 &amp;&amp; 
this.hint)\n			repText = repText.replace('user_text', this.hint);			  		
\n  		\n  	editor.value = frontText + repText + endText;\n  	\n  	// 
re-positioning\n  	editor.selectionStart = ss;\n  	editor.selectionEnd  
 = ss + repText.length;\n  	editor.scrollTop      = st;\n  	\n  	
editor.focus();\n  \n  }catch(ex){\n    if(ex.description)\n      
alert('apl_wikibar_formatByWord(): '+ex.description);\n    else\n      
displayMessage('apl_wikibar_formatByWord(): '+ex);\n  }\n  		\n}\n\n// 
params may be null, string or array\nfunction 
processSyntaxParams(syntaxStr, params)\n{\n  try{\n  \n    var 
rx=null;\n    var totalParams=null;\n    // replace parameter: 
%1,%2,...\n    if(params!=null){\n      if(typeof(params)=="object"){  
// array\n        for(i=0; i&lt;params.length; i++){\n          
if(params[i]){\n            rx = "(\s\s[%"+(i+1)+"\s\s])" + "|" + 
"(%"+(i+1)+")";\n            syntaxStr = syntaxStr.replace(new 
RegExp(rx,"g"), params[i]);\n          }\n        }\n        totalParams
 = params.join(' ').trim();\n      }\n      else{ // string\n        
totalParams = params.trim();\n        rx = /(\s[%1{1}\s])|(%1{1})/g;\n  
      syntaxStr = syntaxStr.replace(rx, totalParams);\n      }    \n    
}\n    \n    \n    // replace parameter: %N\n    if(totalParams)\n      
syntaxStr = syntaxStr.replace(new RegExp('%N{1}',"g"), totalParams);\n  
      \n    // remove optional parameters\n    
rx=/\s[%(([1-9]{1,}[0-9]{0,})|(N{1}))\s]/g;\n    syntaxStr = 
syntaxStr.replace(rx, '');\n    \n    // check if replaced ok\n    
rx=/%(([1-9]{1,}[0-9]{0,})|(N{1}))/g;\n    if( syntaxStr.match(rx) ){\n 
     throw "Not enough parameters! " + syntaxStr;\n    }\n    \n    
return syntaxStr;\n    \n  } catch(ex){\n    if(ex.description)\n      
displayMessage('processSyntaxParams(): '+ex.description);\n    else\n   
   displayMessage('processSyntaxParams(): '+ex);\n      \n    return 
null;\n  
}\n}\n\n//------------------------------------------------------------------------------------------------\n//
 common format 
function\n//------------------------------------------------------------------------------------------------\napl_wikibar_format
 = function(editor, params){\n\n  clearMessage();\n  \n  try{\n  \n    
if(!editor) return;\n    \n    repText = 
processSyntaxParams(this.syntax, params);\n    if(!repText)  return;\n  
	\n  	var st = editor.scrollTop;\n  	var ss = editor.selectionStart;\n  
	var se = editor.selectionEnd;\n  	\n//  	displayMessage(ss + ',' + 
se);\n  	\n		var frontText= '';\n		var endText  = '';\n		var fullText = 
editor.value;\n		\n		if(se&gt;ss &amp;&amp; ss&gt;=0){   // has 
selection\n  	  frontText  = fullText.substring(0, ss);	// text before 
selection\n  	  endText    = fullText.substring(se, fullText.length);	//
 text behind selection\n		}\n		else if(ss==0 &amp;&amp; (se==0 || se == 
fullText.length) ){  // no selection, cursor in begin\n      endText    =
 fullText;	// text behind selection\n		}\n		else if(se==ss &amp;&amp; 
ss&gt;0){  // no selection, cursor in text\n	    frontText  = 
fullText.substring(0, ss);	// text before selection\n	    endText    = 
fullText.substring(se, fullText.length);	// text behind selection\n		}\n
		\n		if(repText.indexOf('user_text')&gt;=0 &amp;&amp; this.hint)\n			
repText = repText.replace('user_text', this.hint);			  		\n  	\n  	
editor.value = frontText + repText + endText;\n  	\n  	// 
re-positioning\n  	editor.selectionStart = ss;\n  	editor.selectionEnd  
 = ss + repText.length;\n  	editor.scrollTop      = st;\n  	\n  	
editor.focus();\n  \n  }catch(ex){\n    if(ex.description)\n      
alert('apl_wikibar_formatByCursor(): '+ex.description);\n    else\n     
 displayMessage('apl_wikibar_formatByCursor(): '+ex);\n  }\n  		
\n}\n\n\n//------------------------------------------------------------------------------------------------\n//
 if selected text, replace it\n// else insert 
it\n//------------------------------------------------------------------------------------------------\napl_wikibar_formatByCursor
 = function(editor, params){\n\n  clearMessage();\n  \n  try{\n  \n    
if(!editor) return;\n    \n    repText = 
processSyntaxParams(this.syntax, params);\n    if(!repText)  return;\n  
	\n  	var st = editor.scrollTop;\n  	var ss = editor.selectionStart;\n  
	var se = editor.selectionEnd;\n  	\n//  	displayMessage(ss + ',' + 
se);\n  	\n		var frontText= '';\n		var endText  = '';\n		var fullText = 
editor.value;\n		\n		if(se&gt;ss &amp;&amp; ss&gt;=0){   // has 
selection\n  	  frontText  = fullText.substring(0, ss);	// text before 
selection\n  	  endText    = fullText.substring(se, fullText.length);	//
 text behind selection\n		}\n		else if(ss==0 &amp;&amp; (se==0 || se == 
fullText.length) ){  // no selection, cursor in begin\n      endText    =
 fullText;	// text behind selection\n		}\n		else if(se==ss &amp;&amp; 
ss&gt;0){  // no selection, cursor in text\n	    frontText  = 
fullText.substring(0, ss);	// text before selection\n	    endText    = 
fullText.substring(se, fullText.length);	// text behind selection\n		}\n
		\n		if(repText.indexOf('user_text')&gt;=0 &amp;&amp; this.hint)\n			
repText = repText.replace('user_text', this.hint);			  		\n  	\n  	
editor.value = frontText + repText + endText;\n  	\n  	// 
re-positioning\n  	editor.selectionStart = ss;\n  	editor.selectionEnd  
 = ss + repText.length;\n  	editor.scrollTop      = st;\n  	\n  	
editor.focus();\n  \n  }catch(ex){\n    if(ex.description)\n      
alert('apl_wikibar_formatByCursor(): '+ex.description);\n    else\n     
 displayMessage('apl_wikibar_formatByCursor(): '+ex);\n  }\n  		
\n}\n\n//------------------------------------------------------------------------------------------------\n//
 the syntax will be applied on the current 
line\n//------------------------------------------------------------------------------------------------\napl_wikibar_formatByLine
 = function(editor, params)\n{\n\n  clearMessage();\n  \n  try{\n  \n   
 if(!editor) return;\n    \n    repText = 
processSyntaxParams(this.syntax, params);\n    if(!repText)  return;  	
\n    \n    \n  	var st = editor.scrollTop;\n  	var ss = 
editor.selectionStart;\n  	var se = editor.selectionEnd;\n  	\n//  	
displayMessage(ss + ',' + se);\n  	\n		var frontText= '';\n		var selText
  = '';\n		var endText  = '';\n		var fullText = editor.value;\n		\n		
if(se&gt;ss &amp;&amp; ss&gt;=0){   // has selection\n			
if(this.byBlock){\n		    frontText  = fullText.substring(0, ss);	// text
 before selection\n		    selText		 = fullText.substring(ss,se);	// 
selection text\n		    endText    = fullText.substring(se, 
fullText.length);	// text behind selection\n			}\n			else{\n		  	se = 
ss;\n			}\n//		  displayMessage('has selection ' + ss + ',' + se);\n		
}\n		\n    if(ss==0 &amp;&amp; (se==0 || se == fullText.length) ){  // 
no selection, cursor in begin\n      var m=fullText.match(/(\sn|\sr)/g);
   // position of line-break\n      if(m)\n        se = 
fullText.indexOf(m[0]);\n      else\n        se = fullText.length;\n\n//
      displayMessage('no selection, cursor in begin: ' + ss + ',' + se);
        \n      selText    = fullText.substring(0, se); \n      endText 
   = fullText.substring(se, fullText.length);	// text behind selection  
\n		}\n		else if(se==ss &amp;&amp; ss&gt;0){  // no selection text, 
cursor in text\n	    frontText  = fullText.substring(0, ss);	// text 
before selection\n	    endText    = fullText.substring(se, 
fullText.length);	// text behind selection\n	    \n      // find the 
last position of line-break in frontText\n      var m = 
frontText.match(/(\sn|\sr)/g);  // position of line-break\n      
if(m){\n        ss = frontText.lastIndexOf(m[m.length-1])+1;\n      }\n 
     else{ // not found\n        ss = 0;          \n      }\n      \n  	
  // find the first position of line-break in endText\n      m = 
endText.match(/(\sn|\sr)/g);  // position of line-break\n      if(m){\n 
       se += endText.indexOf(m[0]);\n      }\n      else{ // not found\n
        se = fullText.length;\n      }\n\n  	  // re-positioning\n//  	 
 displayMessage('no selection text, cursor in text: ' + ss + ',' + 
se);\n      frontText = fullText.substring(0, ss);	// text before 
selection\n  	  selText   = fullText.substring(ss,se);\n  	  endText   =
 fullText.substring(se, fullText.length);	// text behind selection\n		
}\n  	\n  	if(selText.length&gt;0)\n  		repText = 
repText.replace('user_text', selText);\n  		\n		
if(repText.indexOf('user_text')&gt;=0 &amp;&amp; this.hint)\n			repText =
 repText.replace('user_text', this.hint);			  	\n			\n		
if(this.byBlock){		    \n	    // add extra line-breaks\n	    if( 
(frontText.charAt(frontText.length-1)!='\sn') &amp;&amp; ss!=0 )\n	    	
repText = '\sn' + repText;\n	    if( (endText.charAt(0)!='\sn') || 
se==fullText.length)\n	    	repText += '\sn';\n		}\n  		\n  	
editor.value = frontText + repText + endText;\n  	\n  	// 
re-positioning\n  	editor.selectionStart = ss;\n  	editor.selectionEnd  
 = ss + repText.length;\n  	editor.scrollTop      = st;\n  	\n  	
editor.focus();\n  \n  }catch(ex){\n    if(ex.description)\n      
alert('apl_wikibar_formatByLine(): '+ex.description);\n    else\n      
displayMessage('apl_wikibar_formatByLine(): '+ex);\n  }\n  		
\n}\n\n//------------------------------------------------------------------------------------------------\n//
 the syntax will be applied on the table cell(if 
exist)\n//------------------------------------------------------------------------------------------------\napl_wikibar_formatByTableCell
 = function(editor, params){\n\n  clearMessage();\n  \n  try{\n  \n    
if(!editor) return;\n    \n    repText = 
processSyntaxParams(this.syntax, params);\n    if(!repText)  return;\n  
    	\n  	var st = editor.scrollTop;\n  	var ss = 
editor.selectionStart;\n  	var se = editor.selectionEnd;\n  	\n//  	
displayMessage(ss + ',' + se);\n  	\n		var frontText= '';\n		var selText
  = '';\n		var endText  = '';\n		var fullText = editor.value;\n		\n		
if(ss==0 || ss==fullText.length)\n			throw "not valid cell!";\n			\n		
se=ss;			\n		\n//		displayMessage(ss);\n    frontText  = 
fullText.substring(0, ss);	// text before selection\n    endText    = 
fullText.substring(se, fullText.length);	// text behind selection\n    
\n    // find the last '|' position in frontText\n    
i=frontText.lastIndexOf("\sn");\n    j=frontText.lastIndexOf("|");\n    
if(i&gt;j || j&lt;0)\n    	//throw "frontText not valid cell! " + i + 
"," + j;\n    	throw "not valid cell!";\n		\n		ss = j+1;\n					    	\n	 
 // find the first '|' position in endText\n    
i=endText.indexOf("\sn");\n    j=endText.indexOf("|");\n    if(i&lt;j ||
 j&lt;0)\n    	//throw "endText not valid cell! " + i + "," + j;\n    	
throw "not valid cell!";\n	  \n	  se += j;\n	  \n	  // 
re-positioning\n//  	displayMessage(ss + ',' + se);\n    frontText = 
fullText.substring(0, ss-1);	// text before selection\n	  selText   = 
fullText.substring(ss,se);\n	  endText   = fullText.substring(se+1, 
fullText.length);	// text behind selection\n\n		
if(this.name.substring(0,5)=="align"){\n			selText = selText.trim();\n		
	if(	selText=="&gt;" || selText=="~" || \n					
selText.substring(0,8)=="bgcolor(" \n				)	// bypass special table 
code\n				return;\n		}\n  	\n  	if(selText.length&gt;0)\n  		repText = 
repText.replace('user_text', selText);\n  		\n		
if(repText.indexOf('user_text')&gt;=0 &amp;&amp; this.hint)\n			repText =
 repText.replace('user_text', this.hint);			  		\n  		\n  	editor.value =
 frontText + repText + endText;\n  	\n  	// re-positioning\n  	
editor.selectionStart = ss;\n  	editor.selectionEnd   = ss + 
repText.length - 2;\n  	editor.scrollTop      = st;\n  	\n  	
editor.focus();\n  \n  }catch(ex){\n    if(ex.description)\n      
alert('apl_wikibar_formatByTableCell(): '+ex.description);\n    else\n  
    displayMessage('apl_wikibar_formatByTableCell(): '+ex);\n  }\n  		
\n}\n\n\n//------------------------------------------------------------------------------------------------\n//
 param: editor, 
button_pressed\n//------------------------------------------------------------------------------------------------\napl_wikibar_getColorCode
 = function(editor, theTarget)\n{\n  if(!apl_wikibar_colorPicker)  
return;\n  \n  apl_wikibar_colorPicker.targetSyntax = this;\n  
apl_wikibar_colorPicker.targetEditor = editor;\n  
apl_wikibar_colorPicker.moveColorMap(theTarget);  
\n}\n\napl_wikibar_getLinkUrl = function(editor)\n{\n  var url= 
prompt('Please enter the link target', this.param);\n  if (url 
&amp;&amp; url.trim()!='')\n    this.format(editor, 
url);\n}\n\napl_wikibar_getTableRowCol = function(editor)\n{\n  var rc= 
prompt('Please enter rows x cols of the table', '2 x 3');\n  if (!rc || 
rc.trim()=='') return;\n  \n  var arr = rc.toUpperCase().split('X');\n  
if(arr.length != 2)   return;\n  \n  for(i=0; i&lt;arr.length; i++)\n   
 if(isNaN(arr[i].trim()))  return;\n  \n  rows = 
parseInt(arr[0].trim());\n  cols = parseInt(arr[1].trim());\n  \n  
txtTable='';\n  for(r=0; r&lt;rows; r++){\n    for(c=0; c&lt;=cols; 
c++)\n      if(c==0)\n        txtTable += '|';\n      else\n        
txtTable += ' |';\n      \n    txtTable += '\sn';\n  }\n\n  
if(txtTable.trim()!='')      \n    this.format(editor, txtTable);\n  
\n}\n\napl_wikibar_getMacroParam = function(editor)\n{\n	try{\n	  var p =
 prompt('Please enter the parameters of ' + this.name + ' macro:' + \n	 
                '\snSyntax: ' + this.syntax +\n	                 
'\sn\snNote: '+\n	                 '\sn%1,%2,... - parameter needed'+ \n
	                 '\sn[%1] - optional parameter'+\n	                 
'\sn%N   - more than one parameter(1~n)'+\n	                 '\sn[%N] - 
any number of parameters(0~n)'+\n	                 '\sn\snPS:'+\n	      
           '\sn Parameters should be seperated with space character'+\n	
                 '\sn Use "" to wrap the parameter that includes space 
character, ex: "hello world"'+\n	                 '\sn Input the 
word(null) for the optional parameter ignored',\n	                 
(this.param?this.param:'') );\n	  \n    if(p==null)  return;\n\n    
p=p.readMacroParams();\n    for(i=0;i&lt;p.length;i++){\n      var 
s=p[i].trim();\n      if(s.indexOf(' ')&gt;0)\n        p[i]="'"+s+"'";\n
      if(s.toLowerCase()=="null")\n        p[i]=null;\n    }\n    \n    
this.format(editor, p);\n      \n	}catch(ex){\n    if(ex.description)\n 
     alert('apl_wikibar_getMacroParam(): '+ex.description);\n    else\n 
     displayMessage('apl_wikibar_getMacroParam(): '+ex);\n  }		
\n}\n\n\n\n//------------------------------------------------------------------------------------------------\n//
 hijack createTiddlerEditor() to create 
WikiBar\n//------------------------------------------------------------------------------------------------\nwindow.apl_wikibar_createTiddlerEditor
 = window.createTiddlerEditor;\nwindow.createTiddlerEditor = function 
(title)\n{\n  // call original function\n  
apl_wikibar_createTiddlerEditor(title);\n    \n  // create wiki-bar\n  
apl_wikibar_createWikibar(title);\n}\n\nfunction 
apl_wikibar_createWikibar(title){\n\n  try{\n  \n    // insert 
wikisyntax toolbar before editorBodyXXX\n    var theEditor = 
document.getElementById("editorWrapper" + title);\n    var theBodyBox = 
document.getElementById("editorBody" + title);\n    \n    // create 
Wikibar\n//    var theWikibar = 
createTiddlyElement(theEditor,"div","editorWikibar" + 
title,"toolbar",null);\n    var theWikibar = 
createTiddlyElement(theEditor,"div","editorWikibar" + 
title,null,null);\n\n    
theEditor.insertBefore(theWikibar,theBodyBox);\n    \n    // create tool
 buttons\n    \n    //---------------\n    // single button\n    
//---------------\n    \n    // about\n    var btn = 
apl_wikibar_createWikibarButton(theWikibar, "&amp;copy;", "about 
WikiBarPlugin", apl_wikibar_onClickAbout, title);\n    if(btn) btn.id = 
"apl_wikibar_btn_about";\n\n		// preview\n    btn = 
apl_wikibar_createWikibarButton(theWikibar, "&amp;infin;", "preview the 
tiddler", apl_wikibar_onClickPreview, title);\n    if(btn) btn.id = 
"apl_wikibar_btn_preview";\n    \n    // formattings\n    for(i=0; 
i&lt;apl_wikibar_syntaxes.formattings.length; i++){\n      var syntaxObj
 = apl_wikibar_syntaxes.formattings[i];\n      syntax_desc = 
"apl_wikibar_syntaxes.formattings["+i+"]";\n      if(syntaxObj.symbol)\n
      	apl_wikibar_createWikibarButton(theWikibar, syntaxObj.symbol, 
syntaxObj.tip, apl_wikibar_onClickWikibarButton, title, syntax_desc);\n 
   	else\n      	apl_wikibar_createWikibarButton(theWikibar, 
syntaxObj.name, syntaxObj.tip, apl_wikibar_onClickWikibarButton, title, 
syntax_desc);\n    }\n    \n    //---------------\n    // dropdown 
menu\n    //---------------\n    
apl_wikibar_createWikibarButton(theWikibar, "color", "Color", 
apl_wikibar_onClickWikibarMenu, title, null, 
"apl_wikibar_syntaxes.colors");\n    
apl_wikibar_createWikibarButton(theWikibar, "link", "Link", 
apl_wikibar_onClickWikibarMenu, title, null, 
"apl_wikibar_syntaxes.links");\n    
apl_wikibar_createWikibarButton(theWikibar, "Hn", "Heading", 
apl_wikibar_onClickWikibarMenu, title, null, 
"apl_wikibar_syntaxes.headings");\n    
apl_wikibar_createWikibarButton(theWikibar, "list", "List", 
apl_wikibar_onClickWikibarMenu, title, null, 
"apl_wikibar_syntaxes.lists");\n    
apl_wikibar_createWikibarButton(theWikibar, "paragraph", "Paragraph 
format", apl_wikibar_onClickWikibarMenu, title, null, 
"apl_wikibar_syntaxes.paragraphs");\n    
apl_wikibar_createWikibarButton(theWikibar, "table", "Table", 
apl_wikibar_onClickWikibarMenu, title, null, 
"apl_wikibar_syntaxes.tables");\n    
apl_wikibar_createWikibarButton(theWikibar, "plugin", "Plugin design", 
apl_wikibar_onClickWikibarMenu, title, null, 
"apl_wikibar_syntaxes.plugins");\n    
apl_wikibar_createWikibarButton(theWikibar, "macro", "Macro", 
apl_wikibar_onClickWikibarMenu, title, null, 
"apl_wikibar_syntaxes.macros");\n    
apl_wikibar_createWikibarButton(theWikibar, "date", "Date format 
string", apl_wikibar_onClickWikibarMenu, title, null, 
"apl_wikibar_syntaxes.dates");\n    
apl_wikibar_createWikibarButton(theWikibar, "html", "HTML", 
apl_wikibar_onClickWikibarMenu, title, null, 
"apl_wikibar_syntaxes.htmls");\n    \n  }catch(ex){\n    
alert('apl_wikibar_createWikibar(): '+ex.description);\n  }\n  
\n}\n\n//------------------------------------------------------------------------------------------------\n//
 create wikibar button\n// ps. \n// if single button: syntax_objs=null, 
syntax_obj needed\n// if group button: syntax_objs needed, 
syntax_obj=null\n//------------------------------------------------------------------------------------------------\nfunction
 apl_wikibar_createWikibarButton(theToolbar, theText, theTooltip, 
theAction, title, syntax_obj, syntax_objs)\n{\n  try{\n  \n    
if(!theToolbar)  return null;\n    \n    // call system function to add a
 button\n    
//createTiddlyButton(theParent,theText,theTooltip,theAction,theClass,theId,theAccessKey)\n
    var theButton = createTiddlyButton(theToolbar, theText, theTooltip, 
theAction, "button");\n    if(!theButton) return null;\n\n//    
insertSpacer(theToolbar);\n    \n    // fix the wikibar overrun bug\n  	
theToolbar.appendChild( document.createTextNode("\sn") );\n  	\n		
theButton.innerHTML = theText;	// html is allowed here, ex: 
"&lt;b&gt;B&lt;/b&gt;"\n\n		// add parameters to theButton, those 
parameters will be used on onclick event\n		// setAttribute() only 
accepts string variable, object is not allowed!\n		// we'll use eval() 
to convert string to object, refer to 
apl_wikibar_onClickWikibarButton()\n		if(title)\n		  
theButton.setAttribute("tiddler_title", title);\n		  \n    
if(syntax_objs)\n		  theButton.setAttribute("syntax_objs", 
syntax_objs);\n\n    if(syntax_obj)\n		  
theButton.setAttribute("syntax_obj", syntax_obj);\n		  \n  	return 
theButton;\n  	\n  }catch(ex){\n    
alert('apl_wikibar_createWikibarButton(): '+ex.description);\n    return
 null;\n  }\n  
\n}\n\n//------------------------------------------------------------------------------------------------\n//
 button(&lt;a&gt;) may have other tags, ex: 
&lt;a&gt;&lt;b&gt;B&lt;/b&gt;&lt;/a&gt;\n// when we click the button, 
the apl_wikibar_onClickWikibarButton event may be received by the 
childNodes of &lt;a&gt;\n// so we try to look up to the button 
object(&lt;a&gt;), as &lt;a&gt; has the parameters we 
need\n//------------------------------------------------------------------------------------------------\nfunction
 apl_wikibar_resolveClickButton(obj)\n{\n  if (obj.id=="tiddlerDisplay")
   // search until tiddlerDisplay is reached\n    return null;\n  \n  
if(obj.hasAttributes()){\n    if(obj.getAttribute("tiddler_title"))\n   
   return obj;\n    else\n      return 
apl_wikibar_resolveClickButton(obj.parentNode); // search the parent\n  
}\n  else{\n    return apl_wikibar_resolveClickButton(obj.parentNode);  
// search the parent\n  }\n}\n\n\nfunction 
apl_wikibar_switchWikibar(wikibar, visible)\n{\n  if(!wikibar)  
return;\n  \n  var pv=null;\n  // hide other buttons\n  for(i=0; 
i&lt;wikibar.childNodes.length; i++){ \n    try{\n      var theButton = 
wikibar.childNodes[i];\n\n      if(theButton.id == 
"apl_wikibar_btn_preview") \n        pv=theButton;\n\n      
if(theButton.id != "apl_wikibar_btn_about" &amp;&amp; theButton.id != 
"apl_wikibar_btn_preview")\n        theButton.style.display = visible ? 
"": "none";\n      \n    }catch(ex){\n      ;\n    }\n  }\n  \n  if(!pv)
 return;\n  \n  // update the caption of preview button\n  
if(visible){\n    pv.innerHTML = "&amp;infin;";\n    
pv.setAttribute("title", "show previewer");\n  }\n  else{\n    
pv.innerHTML = "&amp;larr;";\n    pv.setAttribute("title", "back to 
editor");\n  }\n  \n}\n\nfunction apl_wikibar_displayAboutBox(theAbout, 
theTarget)\n{\n  try{\n\n    if(!theAbout || !theTarget) return;\n    \n
  	var rootLeft = findPosX(theTarget);\n	  var rootTop = 
findPosY(theTarget);\n	  var rootHeight = theTarget.offsetHeight;\n	  \n
	  var popupLeft = rootLeft;\n	  var popupTop = rootTop + rootHeight;\n	
  \n	  var popupWidth = theAbout.offsetWidth;\n	  \n	  var winWidth = 
findWindowWidth();\n	  if(popupLeft + popupWidth &gt; winWidth)\n		  
popupLeft = winWidth - popupWidth;\n  		\n	  theAbout.style.left = 
popupLeft + "px";\n	  theAbout.style.top = popupTop + "px";\n	  
theAbout.style.display = "block";\n	  \n//    window.scrollTo(0,y);   //
 some bugs here\n    \n  }catch(ex){\n    
alert('apl_wikibar_displayAboutBox(): '+ex.description);\n  
}\n}\n\nfunction apl_wikibar_onClickAbout(e)\n{\n	if (!e) var e = 
window.event;\n	var theTarget = resolveTarget(e);\n	if(!theTarget) 
return(false);\n	\n  try{\n  \n    // check if already exist\n    var 
theAbout = document.getElementById("aboutWikibar");\n    \n    
if(theAbout){  // switch theAbout\n    	relateTo = 
theAbout.getAttribute("relateTo");\n    	if(relateTo == 
theTarget.parentNode.id){\n	    	theAbout.style.display = 
(theAbout.style.display=="block")? "none" : "block";\n    	}\n    	
else{\n    		theAbout.setAttribute("relateTo", 
theTarget.parentNode.id);\n    		apl_wikibar_displayAboutBox(theAbout, 
theTarget);\n    	}\n    }\n    else{	// create theAbout box\n      
theAbout = document.createElement("div");\n      
theAbout.setAttribute("id", "aboutWikibar");\n      
theAbout.setAttribute("style", "position:absolute; z-index:99; 
display:block; background-color:white; border:medium solid red;");\n    
  theAbout.setAttribute("class", "viewer");\n      ver = 
version.extensions.WikiBar.major + "." + 
version.extensions.WikiBar.minor + "." + 
version.extensions.WikiBar.revision;\n      theAbout.innerHTML = 	
'&lt;center&gt;WikiBarPlugin Version 
'+ver+'&lt;br&gt;&lt;/center&gt;&lt;hr&gt;&lt;ul&gt;'+\n      										
	'&lt;li&gt;Author: &lt;a href="mailto:arphenlin@gmail.com"&gt;Arphen 
Lin&lt;/a&gt;&lt;/li&gt;'+\n      											'&lt;li&gt;Web: &lt;a 
href="http://aiddlywiki.sourceforge.net/" 
target="new"&gt;AiddlyWiki&lt;/a&gt;&lt;/li&gt;'+\n      											
'&lt;/ul&gt;';\n			theAbout.onclick = function(){\n														
document.getElementById("aboutWikibar").style.display="none";\n									
				};											\n      theAbout.setAttribute("relateTo", 
theTarget.parentNode.id);\n      \n      
document.body.appendChild(theAbout);\n      \n      
apl_wikibar_displayAboutBox(theAbout, theTarget);\n    }\n    \n  
}catch(ex){\n  	alert('apl_wikibar_onClickAbout(): '+ ex.description);\n
  }		\n\n	e.cancelBubble = true;\n	if (e.stopPropagation) 
e.stopPropagation();\n	return(false);	\n}\n\nfunction 
apl_wikibar_onClickPreview(e)\n{\n	if (!e) var e = window.event;\n	var 
theTarget = resolveTarget(e);\n	if(!theTarget) return(false);\n	\n//	
displayMessage(theTarget);\n	\n  try{\n\n    var wikibar = 
theTarget.parentNode;\n    if(!wikibar)  return;\n    \n    title = 
wikibar.id.substring(13, wikibar.id.length); // "editorWikibar"+title\n 
   var editorWrapper = document.getElementById( 
"editorWrapper"+title);\n  \n  	var editor= 
document.getElementById("editorBody"+title);\n\n    // check if already 
exist\n    var previewer = document.getElementById("previewer"+title);\n
    if(previewer){  // switch previewer\n      
if(previewer.style.display=="block"){\n        previewer.style.display =
 "none";\n        editor.style.display = "block";\n      }\n      
else{\n        previewer.innerHTML = ''; // clear the contents\n        
wikify(editor.value, previewer, null, null);  // refresh the contents\n 
       previewer.style.display = "block";\n        editor.style.display =
 "none";\n      }\n    }\n    else{	// create previewer\n      previewer
 = document.createElement("div");\n      previewer.setAttribute("id", 
"previewer"+title);\n      previewer.setAttribute("style", 
"overflow:auto; display:block; border:solid 1px;");\n      
previewer.style.height = (editor.offsetHeight) + "px";\n      
previewer.setAttribute("class", "viewer");\n      
editorWrapper.insertBefore(previewer, editor);\n      \n      
wikify(editor.value, previewer, null, null);\n      \n      // hide 
editor\n      editor.style.display = "none";\n    }\n    \n    
apl_wikibar_switchWikibar(wikibar, (editor.style.display=="block") );\n 
   \n  }catch(ex){\n  	alert('apl_wikibar_onClickPreview(): '+ 
ex.description);\n  }		\n\n	e.cancelBubble = true;\n	if 
(e.stopPropagation) e.stopPropagation();\n	return(false);\n  
\n}\n\n\n//------------------------------------------------------------------------------------------------\n//
 onclick event 
handler\n//------------------------------------------------------------------------------------------------\nfunction
 apl_wikibar_onClickWikibarButton(e)\n{\n	if (!e) var e = 
window.event;\n	var theTarget = 
apl_wikibar_resolveClickButton(resolveTarget(e));\n	if(!theTarget) 
return(false);\n	\n  try{\n  \n  	title = 
theTarget.getAttribute("tiddler_title");\n  	\n  	var editor = 
document.getElementById("editorBody"+title);\n    if(!editor) return;\n 
   \n    var syntax = null;\n    cmd = "syntax = " + 
theTarget.getAttribute("syntax_obj");\n  	eval(cmd);\n  	if(!syntax) 
return;\n  	\n  	if(syntax.needParam)\n  	  syntax.needParam(editor, 
theTarget);\n  	else\n  	  syntax.format(editor);\n  		\n  }catch(ex){\n
  	alert('apl_wikibar_onClickWikibarButton(): '+ ex.description);\n  }		
\n\n	e.cancelBubble = true;\n	if (e.stopPropagation) 
e.stopPropagation();\n	
return(false);\n\n}\n\n\n//------------------------------------------------------------------------------------------------\n//
 create drop-down 
menu\n//------------------------------------------------------------------------------------------------\nfunction
 apl_wikibar_onClickWikibarMenu(e)\n{\n	if(!e) var e = window.event;\n	
var theTarget = resolveTarget(e);   // = &lt;span&gt;, the object we 
click on\n	\n  try{  		\n	\n	  title = 
theTarget.getAttribute("tiddler_title");\n	  \n    // retrieve the 
string and eval() it \n    my_syntaxes = 
theTarget.getAttribute("syntax_objs");\n    var items=null;\n    cmd = 
"items = "+my_syntaxes;\n    eval(cmd);\n  	if(!items) return;\n\n  	var
 popup = createTiddlerPopup(this);\n  	if(!popup) return;\n\n  	for 
(i=0; i&lt;items.length; i++){\n		  var theItem = createTiddlyButton(\n 
                       createTiddlyElement(popup, "li"),\n              
          items[i].name,\n                        items[i].tip,\n       
                 apl_wikibar_onClickWikibarButton\n                     
   );\n\n  		theItem.setAttribute("syntax_obj", my_syntaxes + 
"["+i+"]");\n  		theItem.setAttribute("tiddler_title", title);\n		}\n\n 
 	scrollToTiddlerPopup(popup,false);\n  	\n  }catch(ex){\n    
alert('apl_wikibar_onClickWikibarMenu(): '+ex.description);\n  }	\n  \n	
e.cancelBubble = true;\n	if (e.stopPropagation) e.stopPropagation();\n	
return(false);\n  
\n}\n\n\n//------------------------------------------------------------------------------------------------\n//
 apl_wikibar_ColorPicker 
class\n//------------------------------------------------------------------------------------------------\nfunction
 apl_wikibar_ColorPicker(theAction){\n  \n  // 16x16 colors\n  
this.colorTable = [  \n    
"#FFFFFF","#DDDDDD","#CCCCCC","#BBBBBB","#AAAAAA","#999999","#666666","#333333","#111111","#000000","#FFCC00","#FF9900","#FF6600","#FF3300","#CC3300","#CC0033",\n
    
"#99CC00","#99DD00","#99EE00","#EE9900","#DD9900","#CC9900","#FFCC33","#FFCC66","#FF9966","#FF6633","#660000","#990000","#CC0000","#FF0000","#FF3366","#FF0033",\n
    
"#CCFF00","#CCFF33","#333300","#666600","#999900","#CCCC00","#FFFF00","#CC9933","#CC6633","#330000","#993333","#CC3333","#FF3333","#CC3366","#FF6699","#FF0066",\n
    
"#99FF00","#CCFF66","#99CC33","#666633","#999933","#CCCC33","#FFFF33","#996600","#993300","#663333","#CC6666","#FF6666","#990033","#CC3399","#FF66CC","#FF0099",\n
    
"#66FF00","#99FF66","#66CC33","#669900","#999966","#CCCC66","#FFFF66","#996633","#663300","#996666","#FF9999","#FF3399","#CC0066","#990066","#FF33CC","#FF00CC",\n
    
"#33FF00","#66FF33","#339900","#66CC00","#99FF33","#CCCC99","#FFFF99","#CC9966","#CC6600","#CC9999","#FF99CC","#CC6699","#993366","#660033","#CC0099","#330033",\n
    
"#00CC00","#33CC00","#336600","#669933","#99CC66","#CCFF99","#FFFFCC","#FFCC99","#FF9933","#FFCCCC","#CC99CC","#996699","#993399","#990099","#663366","#660066",\n
    
"#006600","#33CC33","#66CC66","#00FF00","#33FF33","#66FF66","#99FF99","#CCFFCC","#99CCFF","#FFCCFF","#FF99FF","#FF66FF","#FF33FF","#FF00FF","#CC66CC","#CC33CC",\n
    
"#003300","#336633","#009900","#339933","#669966","#99CC99","#CCFFFF","#3399FF","#6699CC","#CCCCFF","#CC99FF","#9966CC","#663399","#330066","#9900CC","#CC00CC",\n
    
"#00FF33","#00CC33","#006633","#339966","#66CC99","#99FFCC","#99CCCC","#0066CC","#336699","#9999FF","#9999CC","#9933FF","#6600CC","#660099","#CC33FF","#CC00FF",\n
    
"#00FF66","#33FF66","#009933","#00CC66","#33FF99","#99FFFF","#669999","#003366","#003399","#6666FF","#6666CC","#666699","#330099","#9933CC","#CC66FF","#9900FF",\n
    
"#00FF99","#66FF99","#33CC66","#009966","#66FFFF","#66CCCC","#336666","#006699","#3366CC","#3333FF","#3333CC","#333399","#333366","#6633CC","#9966FF","#6600FF",\n
    
"#00FFCC","#66FFCC","#33CC99","#33FFFF","#33CCCC","#339999","#003333","#3399CC","#6699FF","#0000FF","#0000CC","#000099","#000066","#000033","#6633FF","#3300FF",\n
    
"#00CC99","#33FFCC","#00FFFF","#00CCCC","#009999","#006666","#33CCFF","#66CCFF","#0099CC","#3366FF","#00CCFF","#0099FF","#0066FF","#0033FF","#0033CC","#3300CC"\n
  ];\n\n	this.colorMap = null;		// div object\n\n  this.targetSyntax = 
null;   // the syntax object that called apl_wikibar_ColorPicker\n  
this.targetEditor = null;   // the editor object that will be applied 
selected color\n  this.theAction = theAction;\n  \n  
this.createColorMap();\n\n}\n\napl_wikibar_ColorPicker.prototype.showColorMap
 = function() \n{\n  if(this.colorMap){\n    this.colorMap.style.display
 = "block";\n  }\n}\n\napl_wikibar_ColorPicker.prototype.hideColorMap = 
function() \n{\n  if(this.colorMap){\n    this.colorMap.style.display = 
"none";\n  }\n}\n\n\napl_wikibar_ColorPicker.prototype.moveColorMap = 
function(theTarget)\n{\n  try{\n\n    var cm = this.colorMap; \n    
if(!cm) return;\n    \n  	var rootLeft = findPosX(theTarget);\n	  var 
rootTop = findPosY(theTarget);\n	  var rootHeight = 
theTarget.offsetHeight;\n	  \n	  var popupLeft = rootLeft;\n	  var 
popupTop = rootTop + rootHeight;\n	  \n	  var popupWidth = 
cm.offsetWidth;\n	  \n	  var winWidth = findWindowWidth();\n	  
if(popupLeft + popupWidth &gt; winWidth)\n		  popupLeft = winWidth - 
popupWidth;\n  		\n	  cm.style.left = popupLeft + "px";\n	  cm.style.top
 = popupTop + "px";\n	  cm.style.display = "block";\n	  \n//    
window.scrollTo(0,y);   // some bugs here\n    \n  }catch(ex){\n    
alert('moveColorMap(): '+ex.description);\n  
}\n}\n\napl_wikibar_ColorPicker.prototype.createColorMap = function() 
\n{\n	try{	\n\n    if(!this.theAction) return;\n        \n		
if(this.colorMap)	return;\n	\n    // create div\n		this.colorMap = 
document.createElement("div");\n		
this.colorMap.setAttribute("id","colorMap");\n		
this.colorMap.setAttribute("style","display:none; position:absolute; 
left:0px; top:0px; z-index:99; margin:0px; padding:0px; 
cursor:crosshair;");\n		document.body.appendChild(this.colorMap);\n\n   
 // create table\n    var theTable = document.createElement("table");\n 
   theTable.setAttribute("cellspacing", 0);\n    
theTable.setAttribute("cellpadding", 0);\n    
theTable.setAttribute("style", "border:solid 1px black;");\n    
this.colorMap.appendChild(theTable);\n    \n    // create tr/td\n    
cellsPerRow = 16;\n    var theTR=null;\n    for(i=0; 
i&lt;this.colorTable.length; i++){\n      // create new row\n      
if((i%cellsPerRow)==0){  // 16x16\n        theTR = 
document.createElement("tr");\n        theTable.appendChild(theTR);\n   
   }\n\n      var theTD = document.createElement("td");\n      
if(this.colorTable[i].trim() == '')\n        
theTD.setAttribute("bgcolor", "white");\n      else\n        
theTD.setAttribute("bgcolor", this.colorTable[i]);\n      
theTD.setAttribute("style", "border:solid 1px black;");\n      
theTD.onclick = this.theAction;\n      theTD.innerHTML = '&lt;span 
style="font-size:8px"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;';\n
      theTR.appendChild(theTD);\n    }\n    \n    // bottom row\n    
theTR = document.createElement("tr");\n		theTable.appendChild(theTR);\n	
	var theTD = document.createElement("td");\n		
theTD.setAttribute("bgcolor", "white");\n		theTD.setAttribute("style", 
"border:solid 1px black;");\n		
theTD.setAttribute("colspan",cellsPerRow);\n    theTD.onclick = 
function(){	if(apl_wikibar_colorPicker)	
apl_wikibar_colorPicker.hideColorMap(); };\n		theTD.innerHTML = 
'&lt;center&gt;&lt;span 
style="font-size:10px;"&gt;close&lt;/span&gt;&lt;/center&gt;';\n    
theTR.appendChild(theTD);\n		\n	}catch(ex){\n		alert('createColorMap: 
'+ex.description);\n	}\n	
\n}\n\n//------------------------------------------------------------------------------------------------\n//
 do on select a 
color\n//------------------------------------------------------------------------------------------------\nfunction
 apl_wikibar_onSelectColor(e) \n{\n  \n	if (!e) var e = window.event;\n	
var theTarget = resolveTarget(e);   //&lt;span&gt;\n	if(!theTarget) 
return(false);\n\n  try{\n\n  	if(!apl_wikibar_colorPicker)  return;\n  
	\n    apl_wikibar_colorPicker.hideColorMap();\n\n    // get the color  
	\n    theTD = theTarget.parentNode;\n    color = 
theTD.getAttribute("bgcolor");\n    if(!color)  return;\n    \n    
if(apl_wikibar_colorPicker.targetSyntax &amp;&amp; 
apl_wikibar_colorPicker.targetEditor)\n      
apl_wikibar_colorPicker.targetSyntax.format(apl_wikibar_colorPicker.targetEditor,
 color);\n      \n  }catch(ex){\n    alert('apl_wikibar_onSelectColor: 
'+ex.description);\n  }     \n  \n	e.cancelBubble = true;\n	if 
(e.stopPropagation) e.stopPropagation();\n	return(false);\n   
\n}\n\n\n//------------------------------------------------------------------------------------------------\n//
 global variables: color 
picker\n//------------------------------------------------------------------------------------------------\nvar
 apl_wikibar_colorPicker = new 
apl_wikibar_ColorPicker(apl_wikibar_onSelectColor);\n\n//------------------------------------------------------------------------------------------------\n//
 global variables: syntax object\n// \n// parameter syntax: %1,%2,... - 
parameter needed, [%1] - optional parameter\n//                   %N    
    - more than one parameter(1~n)\n//                   [%N]      - any
 
parameter(0~n)\n//------------------------------------------------------------------------------------------------\nvar
 apl_wikibar_syntaxes = {\n  formattings: [\n		{\n			name: 	"ignore",\n	
		tip:    "ignore wiki word",\n			symbol: "~",\n			syntax: 
"~user_text",\n			hint:   "wiki_word",\n			format:	
apl_wikibar_formatByWord\n		},\n		{\n			name: 	"bold",\n			tip:    
"bolder text",\n			symbol: "&lt;strong&gt;B&lt;/strong&gt;",\n			syntax:
 "''user_text''",\n			hint:		"bold_text",\n			format: 
apl_wikibar_formatByWord\n		},\n		{\n			name: 	"italic",\n			tip:    
"italic text",\n			symbol: "&lt;em&gt;I&lt;/em&gt;",\n			syntax: 
"//user_text//",\n			hint:		"italic_text",\n			format: 
apl_wikibar_formatByWord\n		},\n		{\n			name: 	"underline",\n			tip:    
"underline text",\n			symbol: "&lt;u&gt;U&lt;/u&gt;",\n			syntax: 
"__user_text__",\n			hint:		"underline_text",\n			format: 
apl_wikibar_formatByWord\n		},\n		{\n			name: 	"strike",\n			tip:    
"strikethrough text",\n			symbol: "&lt;strike&gt;S&lt;/strike&gt;",\n			
syntax: "==user_text==",\n			hint:		"strikethrough_text",\n			format: 
apl_wikibar_formatByWord\n		},\n		{\n			name: 	"sup",\n			tip:    
"superscript text",\n			symbol: "X&lt;sup&gt;2&lt;/sup&gt;",\n			syntax:
 "^^user_text^^",\n			hint:		"superscript_text",\n			format: 
apl_wikibar_formatByWord\n		},\n		{\n			name: 	"sub",\n			tip:    
"subscript text",\n			symbol: "X&lt;sub&gt;2&lt;/sub&gt;",\n			syntax: 
"~~user_text~~",\n			hint:		"subscript_text",\n			format: 
apl_wikibar_formatByWord\n		},\n		{\n			name: 	"comment",\n			tip:    
"comment text",\n			symbol: "/%",\n			syntax: "/%user_text%/",\n			hint:
		"comment_text",\n			format: apl_wikibar_formatByWord\n		},\n		{\n			
name: 	"monospaced",\n			tip:    "monospaced text",\n			symbol: 
"&lt;code&gt;mono&lt;/code&gt;",\n			syntax: "{{{user_text}}}",\n			
hint:		"monospaced_text",\n			format: apl_wikibar_formatByWord\n		},\n		
{\n			name: 	"line",\n			tip:    "horizontal line",\n			symbol: 
"&amp;mdash;",\n			syntax: "\sn----\sn",\n			format: 
apl_wikibar_formatByCursor\n		},\n		{\n			name: 	"crlf",\n			tip:    
"line break",\n			symbol: "&amp;para;",\n			syntax: "\sn",\n			format: 
apl_wikibar_formatByCursor\n		}\n  ],  // formattings\n  colors: [\n		
{\n			name: 	"highlight",\n			tip:    "highlight text",\n			syntax: 
"@@user_text@@",\n			hint:		"highlight_text",\n			format: 
apl_wikibar_formatByWord\n		},\n		{\n			name: 	"color",\n			tip:    
"text color",\n			hint:		"your_text",\n			syntax: 
"@@color(%1):user_text@@",\n			format: apl_wikibar_formatByWord,\n			
needParam: apl_wikibar_getColorCode\n		},\n		{\n			name: 	"bgcolor",\n		
	tip:    "background color",\n			hint:		"your_text",\n			syntax: 
"@@bgcolor(%1):user_text@@",\n			format: apl_wikibar_formatByWord,\n			
needParam: apl_wikibar_getColorCode\n		},\n    {\n      name:   
"colorcode",\n      tip:    "insert colorcode",\n      syntax: "%1",\n  
    format: apl_wikibar_formatByCursor,\n      needParam: 
apl_wikibar_getColorCode\n    }		\n  ],  // colors\n  lists:[\n		{\n			
name: 	"bullet",\n			tip:    "bullet point",\n			syntax: "*user_text",\n
			hint:		"bullet_text",\n			format: apl_wikibar_formatByLine\n		},\n		
{\n			name: 	"numbered",\n			tip:    "numbered list",\n			syntax: 
"#user_text",\n			hint:		"numbered_text",\n			format: 
apl_wikibar_formatByLine\n		}\n  ],  // lists\n  headings:[\n		{\n			
name: 	"Heading 1",\n			tip:    "Heading 1",\n			syntax: "!user_text",\n
			hint:		"heading_1",\n			format: apl_wikibar_formatByLine\n		},\n		{\n
			name: 	"Heading 2",\n			tip:    "Heading 2",\n			syntax: 
"!!user_text",\n			hint:		"heading_2",\n			format: 
apl_wikibar_formatByLine\n		},\n		{\n			name: 	"Heading 3",\n			tip:    
"Heading 3",\n			syntax: "!!!user_text",\n			hint:		"heading_3",\n			
format: apl_wikibar_formatByLine\n		},\n		{\n			name: 	"Heading 4",\n			
tip:    "Heading 4",\n			syntax: "!!!!user_text",\n			hint:		
"heading_4",\n			format: apl_wikibar_formatByLine\n		},\n		{\n			name: 	
"Heading 5",\n			tip:    "Heading 5",\n			syntax: "!!!!!user_text",\n			
hint:		"heading_5",\n			format: apl_wikibar_formatByLine\n		}\n  ],  // 
headings\n  paragraphs:[\n		{\n			name: 	"comment by line",\n			tip:    
"line comment",\n			syntax: "/%user_text%/",\n			hint:		
"comment_text",\n			format: apl_wikibar_formatByLine\n		},\n		{\n			
name: 	"comment by block",\n			tip:    "block comment",\n			syntax: 
"/%\snuser_text\sn%/",\n			hint:		"comment_text",\n			byBlock: true,			
\n			format: apl_wikibar_formatByLine\n		},\n		{\n			name: 	"monospaced 
by line",\n			tip:    "line monospaced",\n			syntax: 
"{{{\snuser_text\sn}}}",\n			hint:		"monospaced_text",\n			format: 
apl_wikibar_formatByLine\n		},\n		{\n			name: 	"monospaced by block",\n	
		tip:    "block monospaced",\n			syntax: "{{{\snuser_text\sn}}}",\n			
hint:		"monospaced_text",\n			byBlock: true,\n			format: 
apl_wikibar_formatByLine\n		},\n		{\n			name: 	"quote by line",\n			tip:
    "line quote",\n			syntax: "&gt;user_text",\n			hint:		
"quote_text",\n			format: apl_wikibar_formatByLine\n		},\n		{\n			name: 
	"quote by block",\n			tip:    "block quote",\n			syntax: 
"&lt;&lt;&lt;\snuser_text\sn&lt;&lt;&lt;",\n			hint:		"quote_text",\n			
byBlock: true,			\n			format: apl_wikibar_formatByLine\n		}\n  ],  // 
paragraphs\n  links:[\n		{\n			name: 	"wiki",\n			tip:    "wiki link",\n
			syntax: "[[user_text]]",\n			hint:		"wiki_word",\n			format: 
apl_wikibar_formatByWord\n		},\n		{\n			name: 	"pretty",\n			tip:    
"pretty link",\n			syntax: "[[user_text|%1]]", \n			hint:		
"pretty_word",\n			format: apl_wikibar_formatByWord,\n			needParam: 
apl_wikibar_getLinkUrl,\n			param:	"PrettyLink Target"\n		},\n		{\n			
name: 	"url",\n			tip:    "url link",\n			syntax: "[[user_text|%1]]", \n
			hint:		"your_text",\n			format: apl_wikibar_formatByWord,\n			
needParam: apl_wikibar_getLinkUrl,\n			param:	"http://..."\n		},\n		{\n	
		name: 	"image",\n			tip:    "image link",\n			syntax: 
"[img[user_text|%1]]", \n			hint:		"alt_text",\n			format: 
apl_wikibar_formatByWord,\n			needParam: apl_wikibar_getLinkUrl,\n			
param:	"image/icon.jpg"\n		}\n  ],  // links\n  plugins:[\n		{\n			name:
 	"codes area",\n			tip:    "block monospaced for plugin",\n			syntax: 
"//{{{\snuser_text\sn//}}}",\n			hint:		"monospaced_plugin_text",\n			
byBlock: true,\n			format: apl_wikibar_formatByLine\n		},  \n		{\n			
name: 	"comment by line",\n			tip:    "line comment",\n			syntax: 
"//user_text",\n			hint:		"plugin_comment",\n			format: 
apl_wikibar_formatByLine\n		},\n		{\n			name: 	"comment by block",\n			
tip:    "block comment",\n			syntax: "/***\snuser_text\sn***/",\n			
hint:		"plugin_comment",\n			byBlock: true,\n			format: 
apl_wikibar_formatByLine\n		}\n  ],  // plugins\n  tables:[\n		{\n			
name: 	"table",\n			tip:    "create a new table",\n			syntax: 
"\sn%1\sn",\n			format: apl_wikibar_formatByWord,\n			needParam: 
apl_wikibar_getTableRowCol\n		},\n		{\n			name: 	"table header",\n			
tip:    "table header text",\n			syntax: "|user_text|c",\n			hint:		
"table_header",\n			format: apl_wikibar_formatByWord\n		},		\n		{\n			
name: 	"cell",\n			tip:    "create a tabel cell",\n			syntax: 
"|user_text|",\n			hint:		"your_text",\n			format: 
apl_wikibar_formatByWord\n		},\n		{\n			name: 	"column header",\n			tip:
    "create a column header cell",\n			syntax: "|!user_text|",\n			hint:
		"column_header",\n			format: apl_wikibar_formatByWord\n		},\n		{\n			
name: 	"cell bgcolor",\n			tip:    "cell bgcolor",\n			syntax: 
"|bgcolor(%1):user_text|",\n			hint:		"your_text",\n			format: 
apl_wikibar_formatByTableCell,\n			needParam: apl_wikibar_getColorCode\n
		},\n		{\n			name: 	"align left",\n			tip:    "add a tabel cell",\n			
syntax: "|user_text|",\n			hint:		"your_text",\n			format: 
apl_wikibar_formatByTableCell\n		},\n		{\n			name: 	"align center",\n			
tip:    "add a tabel cell",\n			syntax: "| user_text |",\n			hint:		
"your_text",\n			format: apl_wikibar_formatByTableCell\n		},\n		{\n			
name: 	"align right",\n			tip:    "add a tabel cell",\n			syntax: "| 
user_text|",\n			hint:		"your_text",\n			format: 
apl_wikibar_formatByTableCell\n		}\n  ],  // tables\n  macros:[\n		{\n		
	name: 	"allTags",\n			tip:    "allTags",\n			syntax: 
"&lt;&lt;allTags&gt;&gt;",\n			format: apl_wikibar_formatByWord\n		},\n	
	{\n			name: 	"closeAll",\n			tip:    "closeAll",\n			syntax: 
"&lt;&lt;closeAll&gt;&gt;",\n			format: apl_wikibar_formatByWord\n		},\n
		{\n			name: 	"gradient",\n			tip:    "gradient",\n			syntax: 
"&lt;&lt;gradient vert #ffffff %1&gt;&gt;user_text&gt;&gt;",\n			format:
 apl_wikibar_formatByWord,\n      needParam: apl_wikibar_getColorCode\n	
	},\n		{\n			name: 	"list",\n			tip:    "list",\n			syntax: 
"&lt;&lt;list&gt;&gt;",\n			format: apl_wikibar_formatByWord\n		},\n		
{\n			name: 	"list missing",\n			tip:    "list missing",\n			syntax: 
"&lt;&lt;list missing&gt;&gt;",\n			format: apl_wikibar_formatByWord\n		
},\n		{\n			name: 	"list orphans",\n			tip:    "list orphans",\n			
syntax: "&lt;&lt;list orphans&gt;&gt;",\n			format: 
apl_wikibar_formatByWord\n		},		\n		{\n			name: 	"newJournal",\n			tip: 
   "newJournal",\n			syntax: "&lt;&lt;newJournal&gt;&gt;",\n			format: 
apl_wikibar_formatByWord\n		},		\n		{\n			name: 	"newTiddler",\n			tip: 
   "newTiddler",\n			syntax: "&lt;&lt;newTiddler&gt;&gt;",\n			format: 
apl_wikibar_formatByWord\n		},		\n		{\n			name: 	"option",\n			tip:    
"option",\n			syntax: "&lt;&lt;option %1&gt;&gt;[%2]\sn",\n			format: 
apl_wikibar_formatByWord,\n			needParam: apl_wikibar_getMacroParam,\n			
param: 	'chkOpenInNewWindow "Open link in new window"'\n		},		\n		{\n			
name: 	"permaview",\n			tip:    "permaview",\n			syntax: 
"&lt;&lt;permaview&gt;&gt;",\n			format: apl_wikibar_formatByWord\n		},	
	\n		{\n			name: 	"saveChanges",\n			tip:    "saveChanges",\n			syntax: 
"&lt;&lt;saveChanges&gt;&gt;",\n			format: apl_wikibar_formatByWord\n		
},		\n		{\n			name: 	"search",\n			tip:    "search",\n			syntax: 
"&lt;&lt;search&gt;&gt;",\n			format: apl_wikibar_formatByWord\n		},		\n
		{\n			name: 	"slider",\n			tip:    "slider",\n			syntax: 
"&lt;&lt;slider %1 %2 %3&gt;&gt;",\n			format: 
apl_wikibar_formatByWord,\n			needParam: apl_wikibar_getMacroParam,\n			
param: 	"sliderID sliderTiddler sliderLabel"\n		},		\n		{\n			name: 	
"sparkline",\n			tip:    "sparkline",\n			syntax: "&lt;&lt;sparkline 
%N&gt;&gt;", \n			format: apl_wikibar_formatByWord,\n			needParam: 
apl_wikibar_getMacroParam,\n			param:	"number_list(ex: 100 123 ...)"\n		
},		\n		{\n			name: 	"tabs",\n			tip:    "tabs",\n			syntax: 
"&lt;&lt;tabs [%N]&gt;&gt;",\n			format: apl_wikibar_formatByWord,\n			
needParam: apl_wikibar_getMacroParam,\n			param: 	"indentifier tabLabel 
tabName Tiddler"\n		},		\n		{\n			name: 	"tag",\n			tip:    "tag",\n			
syntax: "&lt;&lt;tag %1&gt;&gt;",\n			format: 
apl_wikibar_formatByWord,\n			needParam: apl_wikibar_getMacroParam,\n			
param: 	"tagName(ex: systemConfig)"\n		},		\n		{\n			name: 	"tiddler",\n
			tip:    "tiddler",\n			syntax: "&lt;&lt;tiddler %1&gt;&gt;",\n			
format: apl_wikibar_formatByWord,\n			needParam: 
apl_wikibar_getMacroParam,\n			param: 	"Tiddler"\n		},		\n		{\n			name: 
	"timeline",\n			tip:    "timeline",\n			syntax: 
"&lt;&lt;timeline&gt;&gt;",\n			format: apl_wikibar_formatByWord\n		},		
\n		{\n			name: 	"today",\n			tip:    "today",\n			syntax: 
"&lt;&lt;today [%1]&gt;&gt;", \n			format: apl_wikibar_formatByWord,\n		
	needParam: apl_wikibar_getMacroParam,\n			param:  '"YYYY/MM/DD 
hh:mm:ss"'\n		},		\n		{\n			name: 	"version",\n			tip:    "version",\n		
	syntax: "&lt;&lt;version&gt;&gt;",\n			format: 
apl_wikibar_formatByWord\n		}\n  ], // macros\n  dates:[\n    {\n      
name:   "YYYY",\n      tip:    "full year",\n      syntax: "YYYY",\n    
  format: apl_wikibar_formatByCursor\n    },\n    {\n      name:   
"YY",\n      tip:    "2-digit year",\n      syntax: "YY",\n      format:
 apl_wikibar_formatByCursor\n    },\n    {\n      name:   "MMM",\n      
tip:    "month name",\n      syntax: "MMM",\n      format: 
apl_wikibar_formatByCursor\n    },\n    {\n      name:   "MM",\n      
tip:    "month",\n      syntax: "MM",\n      format: 
apl_wikibar_formatByCursor\n    },\n    {\n      name:   "0MM",\n      
tip:    "zero-leading month",\n      syntax: "0MM",\n      format: 
apl_wikibar_formatByCursor\n    },\n    {\n      name:   "DDD",\n      
tip:    "week day",\n      syntax: "DDD",\n      format: 
apl_wikibar_formatByCursor\n    },\n    {\n      name:   "DD",\n      
tip:    "day",\n      syntax: "DD",\n      format: 
apl_wikibar_formatByCursor\n    },\n    {\n      name:   "0DD",\n      
tip:    "zero-leading day",\n      syntax: "0DD",\n      format: 
apl_wikibar_formatByCursor\n    },\n    {\n      name:   "hh",\n      
tip:    "hour",\n      syntax: "hh",\n      format: 
apl_wikibar_formatByCursor\n    },\n    {\n      name:   "mm",\n      
tip:    "minute",\n      syntax: "mm",\n      format: 
apl_wikibar_formatByCursor\n    },\n    {\n      name:   "ss",\n      
tip:    "second",\n      syntax: "ss",\n      format: 
apl_wikibar_formatByCursor\n    }    \n  ], // dates\n  htmls:[\n		{\n		
	name: 	"&lt;html&gt;",\n			tip:    "html tag",\n			syntax: 
"&lt;html&gt;\snuser_text\sn&lt;/html&gt;",\n			hint:		"html_content",\n
			byBlock: true,\n			format: apl_wikibar_formatByLine\n		}\n  ]	// 
htmls\n};\n\n\n//}}}</div>
<div tiddler="WikiBarPlugin 外掛" modified="200511032223" modifier="lss" tags="擴充套件 外掛 plugin">WikiBarPlugin
 是由 Arphen Lin 調製的外掛程式。他提供一個編輯工具列，上面有 TiddlyWiki 
大部份的語法格式按鈕，直接使用這些工具列按鈕就可以輸入 wiki 語法，讓你不必死記一堆 wiki 
語法格式，超級方便。\n\n&gt;官方網站展示： 
http://efms.emome.net/Web/Map/tiddlywiki/wikibar_demo.html\n&gt;官方下載： 
http://sourceforge.net/project/showfiles.php?group_id=150861\n\n&lt;&lt;tiddler
 安裝擴充套件提示&gt;&gt;</div>
<div tiddler="WikiWord" modified="200510051731" modifier="lss" tags="Introduction howto">WikiWord 是由兩個或兩個以上的英文單字連在一起所組成，而且每個英文單字的第一個字母必須是大寫。</div>
<div tiddler="gradient" modified="200510062207" modifier="lss" tags="Introduction howto">!
說明\n這個[[巨集]]在不需要任何繪圖函式庫的情形下，可以畫出水平漸層或垂直漸層背景色的文字標題。\n!用法
\n{{{\n&lt;&lt;gradient vert #ffffff #ffdddd 
#ff8888&gt;&gt;垂直漸層背景色&gt;&gt;\n&lt;&lt;gradient horiz #ff8888 #ffdddd 
#ffffff&gt;&gt;水平漸層背景色&gt;&gt;\n}}}\n!效果\n&lt;&lt;gradient vert #ffffff 
#ffdddd #ff8888&gt;&gt;垂直漸層背景色&gt;&gt;\n&lt;&lt;gradient horiz #ff8888 
#ffdddd #ffffff&gt;&gt;水平漸層背景色&gt;&gt;</div>
<div tiddler="list" modified="200510062121" modifier="lss" tags="Introduction howto">!
說明\n這個[[巨集]]會依字母順序將所有的 Tiddler 連結列出。中文的 Tiddler 
標題大概是依中文字編碼順序排序的吧！\n!用法\n{{{\n&lt;&lt;list&gt;&gt;\n}}}\n!效果
\n&lt;&lt;list&gt;&gt;</div>
<div tiddler="newJournal" modified="200510062050" modifier="lss" tags="Introduction howto">!
說明\n建立一個''新增日誌''的超連結，藉由這個超連結，我們可以創建新的 Tiddler ，並直接產生日期組成的標題。適合用來建立日誌式的 
Tiddler 。[[主選單]]裡的&lt;&lt;newJournal 'DD MM 
YYYY'&gt;&gt;便是用這個內建[[巨集]]產生的。\n!用法\n{{{\n&lt;&lt;newJournal 'DD MM 
YYYY'&gt;&gt;\n}}}\n!效果\n&lt;&lt;newJournal 'DD MM YYYY'&gt;&gt;</div>
<div tiddler="newTiddler" modified="200510062050" modifier="lss" tags="Introduction howto">!
說明\n建立一個''發表文章''的超連結，藉由這個超連結，我們可以創建新的 Tiddler 
。[[主選單]]裡的&lt;&lt;newTiddler&gt;&gt;便是用這個內建[[巨集]]產生的。\n!用法
\n{{{\n&lt;&lt;newTiddler&gt;&gt;\n}}}\n!效果\n&lt;&lt;newTiddler&gt;&gt;</div>
<div tiddler="slider" modified="200510062118" modifier="lss" tags="Introduction howto">!
說明\n這個[[巨集]]的功能很好玩，可以把一個 Tiddler 製作成''滑動式方塊''，用滑鼠點選產生的連結，可以滑動式的展開或收合 
Tiddler 的內容。\n!用法\n{{{\n&lt;&lt;slider chkSlider '如何做...' '如何做…' '所有如何做…
 Tiddler 列表'&gt;&gt;&gt;\n}}}\n*slider：這個巨集的名稱。\n*chkSlider：用來儲存 slider 
是展開或收合狀態的瀏覽器 cookie 變數名稱。\n*第一個"如何做…"： Tiddler 的標題。\n*第二個"如何做…"： 
產生的連結上顯示的文字。\n*'所有……'：滑鼠停在 slider 
連結上時會顯示在游標右下角的說明文字。\n!效果\n&lt;&lt;slider chkSlider 如何做… 如何做… '所有如何做… 
Tiddler 列表'&gt;&gt;</div>
<div tiddler="tabs" modified="200510062139" modifier="lss" tags="Introduction howto">!
說明\n這個[[巨集]]功能非常強大，可以讓我們建立''分頁標籤''式的頁面，每個分頁標籤負責顯示一個 Tiddler 
的內容。相對地，用法也比較複雜一點。(一點點而已啦！)\n!用法\n{{{\n&lt;&lt;tabs tabsClass\n如何做系列 
'列出所有如何做…系列的文章' 如何做…\n介紹巨集 '介紹內建巨集的功能' 
巨集\n&gt;&gt;\n}}}\n*第一行\n**tabsClass 是用來顯示分頁標籤效果的 CSS 樣式定義類別。可以在 
StyleSheet 
裡自行定義。\n*其它行(以第二行為例說明)\n**如何做系列：產生的分頁標籤上的文字，當做標題使用。\n**'列出所有........'：當滑
鼠停在分頁標籤上時顯示在游標右下角的說明文字。\n**如何做…：這個分頁標籤要顯示的 Tiddler 。\n!效果\n&lt;&lt;tabs 
tabsClass\n如何做系列 '列出所有如何做…系列的文章' 如何做…\n介紹巨集 '介紹內建巨集的功能' 巨集\n&gt;&gt;</div>
<div tiddler="tag" modified="200510062043" modifier="lss" tags="Introduction howto">!
說明\n產生一個下拉選單，列出屬於某個標籤的所有 Tiddler ，並可直接開啟 Tiddler 或將該標籤的所有 Tiddler 
一次全部開啟。\n!用法\n{{{\n&lt;&lt;tag howto&gt;&gt;\n}}}\n!效果\n產生 "howto" 標籤的 
Tiddler 選單&lt;&lt;tag howto&gt;&gt;</div>
<div tiddler="tiddler" modified="200510062057" modifier="lss" tags="Introduction howto">!
說明\n這個[[巨集]]讓我們引用其它 Tiddler 的內容。我們可以用 Tiddler 
隨時記下小段落的內容，最後再利用這個[[巨集]]將所有的 Tiddler 組織成一篇文章而不用將他們重寫。像在[[如何建立一個 
Tiddler|Tiddler]]裡面，我們就利用這個巨集引用了 FreeLink 這個 Tiddler 
。\n!用法\n{{{\n&lt;&lt;tiddler 歡迎&gt;&gt;\n}}}\n!效果\n以下引用[[歡迎]]這個 Tiddler 
的內容：\n&gt;&lt;&lt;tiddler 歡迎&gt;&gt;</div>
<div tiddler="today" modified="200510062038" modifier="lss" tags="Introduction howto">!說明\n顯示目前的時間。\n!用法\n{{{\n&lt;&lt;today&gt;&gt;\n}}}\n!效果\n現在是 &lt;&lt;today&gt;&gt;</div>
<div tiddler="version" modified="200510062059" modifier="lss" tags="Introduction howto">!
說明\n這個[[巨集]]的功能很簡單，用來顯示目前使用的 TiddlyWiki 
的版本號碼。\n!用法\n{{{\n&lt;&lt;version&gt;&gt;\n}}}\n!效果\n目前使用的 TiddlyWiki 
版本為：&lt;&lt;version&gt;&gt;</div>
<div tiddler="中文翻譯" modified="200511031059" modifier="YourName" tags="systemConfig systemTiddlers">//
 // ''套件:'' zh_TW\n// // ''功能:'' TiddliWiki 介面中文化\n// // ''作者:'' Bram 
Chen\n// // ''版本:'' 1.2.37 (2005/10/28)\n// // ''說明:''\n// // Oct 28, 
2005: 1 新增 config.messages.shadowedTiddlerToolTip\n// //                
          2.新增 config.macros.list.shadowed.prompt\n// //                
          3.修改 config.views.wikified.tag\n{{{\nversion.extensions.zh_TW =
 {major: 1, minor: 2, revision: 37, date: new Date("Oct 28, 2005")};\n//
 // ''Messages''\nconfig.messages= {\n customConfigError: "customConfig 
錯誤 - '%1' - %0",\n savedSnapshotError: "此 TiddlyWiki 未正確存檔，詳見 
http://www.tiddlywiki.com/#DownloadSoftware",\n subtitleUnknown: 
"(未知)",\n undefinedTiddlerToolTip: "'%0' 尚無內容",\n externalLinkTooltip: 
"外部連結至 %0",\n shadowedTiddlerToolTip: "'%0' 尚無內容, 但已定義隱藏的預設值",\n noTags:
 "未設定標籤的文章",\n notFileUrlError: "須先將此 TiddlyWiki 存至檔案，才可儲存變更",\n 
cantSaveError: "此瀏覽器無法儲存變更，建議使用FireFox",\n invalidFileError: " '%0' 非有效之
 TiddlyWiki",\n backupSaved: "已儲存備份",\n backupFailed: "無法儲存備份",\n 
rssSaved: "RSS feed 已儲存",\n rssFailed: "無法儲存 RSS feed ",\n emptySaved: 
"已儲存範本",\n emptyFailed: "無法儲存範本",\n mainSaved: "主要的TiddlyWiki已儲存",\n 
mainFailed: "無法儲存主要 TiddlyWiki. 所作的改變未儲存",\n macroError: "macro執行錯誤 
'%0'",\n overwriteWarning: "'%0' 已存在，[確定]覆寫之",\n unsavedChangesWarning: 
"注意！ 尚未儲存變更\sn\sn[確定]存檔，或[取消]放棄存檔？",\n dates: {\n months: ["一", "二", 
"三", "四", "五", "六", "七", "八", "九", "十", "十一", "十二"],\n days: ["日", 
"一","二", "三", "四", "五", "六"]\n }\n };\nconfig.views = {\n wikified: {\n 
tag: {labelNoTags: "未設標籤", labelTags: "標籤: ", tooltip: "顯示標籤為 '%0' 的文章",
 openAllText: "開啟以下所有文章", openAllTooltip: "開啟標籤為 '%0'  的文章", popupNone: 
"僅此文標籤為 '%0'"},\n toolbarClose: {text: "關閉", tooltip: "關閉本文"},\n 
toolbarEdit: {text: "編輯", tooltip: "編輯本文"},\n toolbarPermalink: {text: 
"引用連結", tooltip: "本文引用連結"},\n toolbarReferences: {text: "引用", tooltip: 
"引用本文的文章", popupNone: "本文未被引用"},\n defaultText: ""\n },\n editor: {\n 
tagPrompt: "設定標籤之間以空白區隔，[[標籤含空白時請使用雙中括弧]]，或點選現有之標籤加入",\n tagChooser: 
{text: "標籤", tooltip: "點選現有之標籤加至本文章", popupNone: "未設定標籤", tagTooltip: 
"加入標籤 '%0'"},\n toolbarDone: {text: "完成", tooltip: "確定修改"},\n 
toolbarCancel: {text: "取消", tooltip: "取消修改"},\n toolbarDelete: {text: 
"刪除", tooltip: "刪除文章"},\n defaultText: ""\n }\n };\n// // 
''SiderBar''\nconfig.shadowTiddlers.SideBarOptions = "&lt;&lt;gradient 
vert #ffffff 
#cc9900&gt;&gt;&lt;&lt;search&gt;&gt;&lt;&lt;closeAll&gt;&gt;&lt;&lt;permaview&gt;&gt;&lt;&lt;saveChanges&gt;&gt;&lt;&lt;slider
 chkSliderOptionsPanel OptionsPanel 偏好設定 '變更 TiddlyWiki 
選項'&gt;&gt;&gt;&gt;";\nconfig.shadowTiddlers.AdvancedOptions = 
"&lt;&lt;option chkOpenInNewWindow&gt;&gt; 連結開啟於新視窗\sn&lt;&lt;option 
chkSaveEmptyTemplate&gt;&gt; 儲存範本\sn&lt;&lt;option 
chkToggleLinks&gt;&gt; 點擊文章使已開啟者關閉\sn\sn&lt;&lt;option 
chkHttpReadOnly&gt;&gt; 隱藏編輯功能 ({{{http:}}})\sn&lt;&lt;option 
chkForceMinorUpdate&gt;&gt; 修改文章不變更日期時間\sn(確認修改同時按 Shift 鍵，或只按 
Ctrl-Shift-Enter)";\nconfig.shadowTiddlers.OptionsPanel = 
"這些設定將暫存於瀏覽器中，\sn請簽名&lt;&lt;option txtUserName&gt;&gt;\sn 
(範例：WikiWord)\sn\sn &lt;&lt;option chkSaveBackups&gt;&gt; 
[[儲存備份]]\sn&lt;&lt;option chkAutoSave&gt;&gt; [[自動儲存]]\sn&lt;&lt;option 
chkGenerateAnRssFeed&gt;&gt; [[產生 RssFeed]]\sn&lt;&lt;option 
chkRegExpSearch&gt;&gt; [[正規式搜尋]]\sn&lt;&lt;option 
chkCaseSensitiveSearch&gt;&gt; [[區分大小寫搜尋]]\sn&lt;&lt;option 
\snchkAnimate&gt;&gt; [[使用動畫顯示]]\sn\sn &lt;&lt;slider 
sliderAdvancedOptions AdvancedOptions 進階選項 
'進階選項'&gt;&gt;";\nconfig.shadowTiddlers.SideBarTabs = "&lt;&lt;tabs 
txtMainTab 最近更新 '依更新日期排序' TabTimeline 全部 '所有文章' TabAll 分類 '依標籤分類' 
TabTags 更多 '其他' TabMore&gt;&gt;";\nconfig.shadowTiddlers.TabMore = 
"&lt;&lt;tabs txtMoreTab 未完成 '內容空白的文章' TabMoreMissing 未引用 '未被引用的文章' 
TabMoreOrphans&gt;&gt;";\nconfig.shadowTiddlers.SliderTimeline = 
"&lt;&lt;slider sliderTimeline TabTimeline 最近更新 
'最近更新的文章'&gt;&gt;";\nconfig.macros.search.label = " 
尋找";\nconfig.macros.search.prompt = "搜尋本 
Wiki";\nconfig.macros.search.sizeTextbox = 
15;\nconfig.macros.search.accessKey = 
"F";\nconfig.macros.search.successMsg = " %0 
篇符合條件";\nconfig.macros.search.failureMsg = " 
無符合條件";\nconfig.macros.timeline.dateFormat = 
"YYYY0MM0DD";\nconfig.macros.allTags.tooltip = "顯示文章- 
標籤為'%0'";\nconfig.macros.allTags.noTags = 
"沒有標籤的文章";\nconfig.macros.list.all.prompt = 
"依字母排序";\nconfig.macros.list.missing.prompt = 
"被引用且內容空白的文章";\nconfig.macros.list.orphans.prompt = 
"未被引用的文章";\nconfig.macros.list.shadowed.prompt = "這些隱藏的文章已定義預設內容";\n// 
// ''ToolsBar''\nconfig.macros.closeAll.label = 
"全部關閉";\nconfig.macros.closeAll.prompt = "關閉所有開啟中的 tiddler 
(編輯中除外)";\nconfig.macros.saveChanges.label = 
"儲存變更";\nconfig.macros.saveChanges.prompt = 
"儲存所有文章，產生新的版本";\nconfig.macros.permaview.label = 
"引用連結";\nconfig.macros.permaview.prompt = 
"可存取現有開啟之文章的連結位址";\nconfig.macros.newTiddler.label = 
"發表文章";\nconfig.macros.newTiddler.prompt = "新增 
tiddler";\nconfig.macros.newJournal.label = 
"新增日誌";\nconfig.macros.newJournal.prompt = "新增 jounal";\n// // ''Date 
formatString''\nDate.prototype.formatString = function(template)\n{\n 
template = template.replace(/YYYY/g,this.getFullYear() + '年');\n 
template = 
template.replace(/YY/g,String.zeroPad(this.getFullYear()-1911,2) + 
'年');\n template = 
template.replace(/MMM/g,config.messages.dates.months[this.getMonth()] + 
'月');\n template = 
template.replace(/0MM/g,String.zeroPad(this.getMonth()+1,2) + '月');\n 
template = template.replace(/MM/g,this.getMonth()+1 + '月');\n template =
 
template.replace(/DDD/g,'星期
'+config.messages.dates.days[this.getDay()]);\n template = 
template.replace(/0DD/g,String.zeroPad(this.getDate(),2)+ '日');\n 
template = template.replace(/DD/g,this.getDate() + '日');\n template = 
template.replace(/hh/g,this.getHours());\n template = 
template.replace(/mm/g,this.getMinutes());\n template = 
template.replace(/ss/g,this.getSeconds());\n return template;\n};\n}}}</div>
<div tiddler="主選單" modified="200510061724" modifier="lss" tags="Introduction">左
側主選單的內容，同樣是放在一個特殊的 Tiddler 裡： MainMenu 。這讓我們修改網站選單時變得非常容易。\n\n關於如何修改一個 
Tiddler 的內容，這裡就不再廢話了。我們把重點放在主選單該放些什麼？\n\n主選單裡應該放的是連結，包括連至網站的其它內容，當然就是 
Tiddler 了；還有就是其它網站的超連結。\n\n如何連至一個 Tiddler ，請參考[[如何建立一個 
Tiddler]]。要連至其它網站，請參考[[如何建立外部連結]]。</div>
<div tiddler="使用教學" modified="200510051439" modifier="YourName" tags="Introduction">截
至目前為止，你已經開啟了兩篇文章。像這樣的文章段落，在 TiddlyWiki 裡把他稱為 Tiddler 。所謂 Tiddler 
，可以把他看成是一小段資訊，或是 MicroContent 。整個 TiddlyWiki 網站就是由許許多多的 Tiddler 組成的。每個 
Tiddler 都是一個可以開啟、編輯的超連結。我們可以用 Tiddler 紀錄下簡短的事項或短文章，再由相關的 Tidder 
組織成所要的完整內容。\n\n除了 Tiddler 之外， TiddlyWiki 還有[[容易攜帶]]和[[容易編輯]]的特點。這些特點讓 
TiddlyWiki 更具威力。</div>
<div tiddler="儲存變更" modified="200510051334" modifier="YourName" tags="Introduction">對
使用 FireFox 
的使用者來說，[[儲存變更]]很容易，你只有在第一次儲存的時候會遇到一個彈出式視窗如下：\n\n[img[images/save-in-
fx.png]]\n\n此時，選''允許''按鈕就可以存檔。若要省略 FireFox 
的每次詢問，只要將''記住此決定''選項打勾就行了。\n----\n對 IE 
的使用者來說，要[[儲存變更]]也不難，同樣地，在儲存時會跳出一個視窗如下：\n\n[img[images/save-in-ie.png]]\n
\n按下''確定''鈕就可以[[儲存變更]]了。</div>
<div tiddler="列表" modified="200511031517" modifier="lss" tags="Introduction 如何做系列 wiki語法">製
作段落的[[列表]]是 TiddlyWiki 
裡最容易的事情之一。列表分成兩種，分別說明如下：\n\n在任何一行的第一個字元加上星號(*)，則可以做項目符號列表。如果使用了一個以上的星號，還
可以做成階層式具縮排功能的列表。範例如下：\n\n*第一層、第一項。\n*第一層、第二項。\n**第二層、第一項。\n***第三層、第一項。
\n***第三層、第二項。\n**第二層、第二項。\n*第一層、第三項。\n\n上面範例的寫法如下：\n{{{\n*第一層、第一項。\n*第一
層、第二項。\n**第二層、第一項。\n***第三層、第一項。\n***第三層、第二項。\n**第二層、第二項。\n*第一層、第三項。\n}}}
\n----\n如果要做成編號列表的話，把星號換成井字號(#)即可。記得，要從每行的第一個字元開始。下面是範例：\n#第一層、第一項。\n#第一
層、第二項。\n##第二層、第一項。\n###第三層、第一項。\n###第三層、第二項。\n##第二層、第二項。\n#第一層、第三項。\n\n上
面範例的寫法如下：\n{{{\n#第一層、第一項。\n#第一層、第二項。\n##第二層、第一項。\n###第三層、第一項。\n###第三層、第二
項。\n##第二層、第二項。\n#第一層、第三項。\n}}}\n----\n兩種列表可不可以混著用？當然可以，看範例最快：\n\n*第一層、第一
項。\n*第一層、第二項。\n##第二層、第一項。\n***第三層、第一項。\n***第三層、第二項。\n##第二層、第二項。\n*第一層、第三
項。\n\n上面範例的寫法如下：\n{{{\n*第一層、第一項。\n*第一層、第二項。\n##第二層、第一項。\n***第三層、第一項。
\n***第三層、第二項。\n##第二層、第二項。\n*第一層、第三項。\n}}}\n\n混合使用時要注意一點，不論換用項目符號列表還是編號列
表，要謹記''在第幾層就使用幾個星號或井字號''的原則。</div>
<div tiddler="固定字" modified="200511031520" modifier="lss" tags="Introduction wiki語法 如何做系列">一
般網頁上所使用的字體是屬於調合字，每個字的寬度不一定相等。例如說字母 i 就比字母 w 
窄。而[[固定字]]是指每個字的寬度都一樣，像接下來的{{{字母 i 就與字母 w 
等寬}}}。\n\n要產生[[固定字]]的方法很簡單，只在在固定字的前後加上三個大括弧即可。如果用單獨一行的三個左大括弧和右大括弧，則其中的文字
還會有縮排並醒目的樣式。\n\n固定字在 TiddlyWiki 裡還有一個很重要的功能，就是使[[巨集]]和各種的 wiki 
語法失效。所以，在很多關於如何…的 Tiddler 裡，都是使用這種方法來顯示各種 wiki 
語法的用法。下面是一個使[[巨集]]失效的例子。\n{{{\n&lt;&lt;today&gt;&gt;\n}}}</div>
<div tiddler="外部連結" modified="200511031517" modifier="lss" tags="Introduction 如何做系列 wiki語法">要
連結到網際網路上，只要打上完整的網址，系統會自動處理成超連結。或者，使用 FreeLink 的方式也可以，只要把 Tiddler 
的名稱換成網址的 URL 
即可。請看下面的範例：\n\nhttp://www.tiddly.com\n[[一般網址|http://www.tiddly.com]]
\n[[相對網址|path/filename]]\n[[Windows 
的網路芳鄰|file://server/share/path/file]]\n[[Windows 
的本機檔案|file:///c:/path/file]]\n[[Unix-style 
的本機檔案|file:///path/file]]\n\n以上範例的寫法：\n{{{\nhttp://www.tiddly.com\n[[一般網
址|http://www.tiddly.com]]\n[[相對網址|path/filename]]\n[[Windows 
的網路芳鄰|file://server/share/path/file]]\n[[Windows 
的本機檔案|file:///c:/path/file]]\n[[Unix-style 
的本機檔案|file:///path/file]]\n}}}</div>
<div tiddler="如何使 WikiWord 失效" modified="200511031519" modifier="lss" tags="Introduction wiki語法 如何做系列">有
時候，滿篇的 Tiddler 連結，會讓人看得眼花瞭亂。為了版面的乾淨，我們不需要到處都是 ~WiKiWord 。那麼要如何讓 Tiddler 
連結失效呢？你注意到了嗎？在這一個 Tiddler 裡，我讓 ~WikiWord 失效了。\n\n答案是：在 ~WikiWord 前面加上一個 ~
 (蝌蚪符號)。像下面這樣：\n{{{\n~WikiWord\n}}}\n\n另外， ~FreeLink 形式的 Tiddler 
連結，只要我們不使用中括弧，就不會產生 Tiddler 了。</div>
<div tiddler="如何做…" modified="200511031751" modifier="lss" tags="Introduction">*
[[如何開始]]\n*[[如何建立一個 
Tiddler|Tiddler]]\n*[[如何格式化文字|格式化文字]]\n*[[如何插入圖檔|插入圖檔]]\n*[[如何建立列表|列表]]
\n*[[如何建立外部連結|外部連結]]\n*[[如何建立表格|表格]]\n*[[如何建立標題|標題]]\n*[[如何使用縮排|縮排]]\n*
[[如何插入水平線|水平線]]\n*[[如何使用樣式|樣式]]\n*[[如何使 WikiWord 
失效]]\n*[[如何使用固定字|固定字]]\n*[[如何使用註解|註解]]^^1.2.37 版新增功能^^\n*[[如何使用 HTML 
語法|HTML語法支援]]^^1.2.37 版新增功能^^\n*[[如何把 Tiddler 
加上標籤|標籤]]\n*[[如何使用巨集|巨集]]\n*[[如何更新版本|更新]]\n/%\n----\n&lt;&lt;listTags 
如何做系列 modified *&gt;&gt;\n%/</div>
<div tiddler="如何開始" modified="200511031514" modifier="lss" tags="Introduction 如何做系列">首
先，當然要先取得一份 TiddlyWiki 的檔案。請對「[[新的檔案|empty.html]]」按滑鼠右鍵，選擇''連結另存新檔''( 
FireFox )或''另存目標''( IE 
)，將檔案存在你的電腦裡。「我的文件」會是個不錯的地方。\n\n請注意：''存檔位置的完整路徑不可以包含任何中文或亞洲語系的名稱''，這是唯一的
限制。\n\n就這樣，安裝完成了。沒錯，就是這麼簡單。\n\n接下來你可以將他的主檔名 empty 
改成任何你想使用的檔名。同樣地，''請不要使用中文檔名''。副檔名則不需要做任何的修改。\n\n安裝完畢之後，你可以做網站的外觀設定，包括：
\n[[設定網站標題|網站標題]]、[[設定網站副標題|網站副標題]]、[[設定網站預設顯示的 Tiddler|首頁預設 
Tiddler]]、[[修改左側主選單|主選單]]；最後，當然是將所有的修改做[[儲存變更]]。</div>
<div tiddler="安裝擴充套件提示" modified="200511032220" modifier="lss" tags="如何做系列 擴充套件">如果你不知道如何安裝擴充套件，請參考[[新增擴充套件]]裡的說明，依步驟進行安裝。</div>
<div tiddler="容易攜帶" modified="200510051211" modifier="YourName" tags="Introduction">如
同前面所介紹的，功能強大的 TiddlyWiki 全部只需要一個小小的檔案(約 100 多 
KB)，放在隨身碟裡，就可以隨身攜帶，在任何有瀏覽器的電腦裡使用。甚至，我們還可以把 FireFox 也一起安裝在隨身碟裡(約佔 5 
MB)，讓攜帶與使用更加方便。\n\n但是這裡有一個小小的例外，儲存在 TiddlyWiki 
裡的部份只有''文字''，插入的圖檔或其它多媒體檔案則是外加的。詳細情形請看[[顯示圖片]]教學部份。</div>
<div tiddler="容易編輯" modified="200510051405" modifier="YourName" tags="Introduction">試
試看在這個 Tiddler 的標題上快按滑鼠左鍵兩次。現在，進入了這個 Tiddler 
的編輯模式。接著，試著在編輯區裡修改內容，然後用滑鼠按一下 Tiddler 右上方的''完成''，這樣就完成一個 Tiddler 
的編輯了。\n\n這樣是不是很''酷''！\n\n眼尖的你，應該也看到了。當滑鼠移入 Tiddler 
範圍時，右上方會自動出現四個連結，用滑鼠點選上面的''編輯''也可以進入 Tiddler 
的編輯模式。\n\n編輯完成，當然要存檔。你可以在[[如何開始]]課程裡找到[[儲存變更]]。\n\n接下來，我們以一連串的[[如何做…]]來進
行 TiddlyWiki 的教學，包括：\n&gt;&lt;&lt;tiddler 如何做…&gt;&gt;</div>
<div tiddler="巨集" modified="200511031521" modifier="lss" tags="Introduction 如何做系列 wiki語法">[[巨
集]]是 TiddlyWiki 作者 Jeremy Ruston 
新增的一個非常強大的功能。利用[[巨集]]，我們可以在不修改任何原始碼的情況下加入新功能。在 TiddlyWiki 
裡已經內建了很多有用的巨集。另外有很多玩家也在他們的 wiki 裡提供很多自家開發的巨集。像 
[[MonkeyPirateTiddlyWiki|http://homes.jcu.edu.au/~ccscb/mptw/]] 和 
[[TiddlerWiki|http://checketts.objectis.net/wiki/]]。在台灣， 
[[BramChen|http://bram.cozysite.com/ptw/]] 也不惶多讓的貢獻他所製作的巨集。\n\n以下列出 
TiddlyWiki 
內建的巨集：\n\n*[[today]]\n*[[tag]]\n*[[newJournal]]\n*[[newTiddler]]\n*
[[tiddler]]\n*[[slider]]\n*[[version]]\n*[[list]]\n*[[tabs]]\n*
[[Sparklines]]\n*[[gradient]]\n\n*[[自訂巨集]]</div>
<div tiddler="插入圖檔" modified="200511031517" modifier="lss" tags="Introduction 如何做系列 wiki語法">插
入的圖檔最簡單的語法是像下面這樣：\n{{{\n[img[images/ham.gif]]\n}}}\n\n其中，images/ham.gif 
是圖檔的路徑，示範的相對路徑是相對於 TiddlyWiki 的檔案所在位置，也就是說，images 目錄與 TiddlyWiki 
是在同一個目錄裡，而 ham.gif 圖檔則是在 images 
目錄底下。實際效果如下：\n[img[images/ham.gif]]\n\n插入圖檔還可以有下列各種變化：\n\n----\n加入圖檔的說明文
字(title 
屬性)，試試把滑鼠游標停在圖片上，游標的右下方會出現//感動的哈姆太郎//文字：\n{{{\n[img[感動的哈姆太郎|images
/ham.gif]]\n}}}\n[img[感動的哈姆太郎|images/ham.gif]]\n\n補充： FireFox 和 IE 對 
&lt;img&gt; 標籤的 title 屬性解釋不同。對 FireFox 來說， title 
屬性是當圖檔無法顯示時用來取代圖檔的說明文字。如果要做成滑鼠游標說明文字的效果，則要使用 alt 屬性。這個部份 TiddlyWiki 
目前沒有支援。也許向官方建議後可以納入未來版本的功能。\n----\n讓圖檔變成超連結，下例為連至 PHP 
的官方網站：\n{{{\n[img[images/php-logo.gif][http://www.php.net]]\n}}}
\n[img[php首頁|images/php-logo.gif][http://www.php.net]]\n----\n插入的圖檔還具有與文
章段落做靠左或靠右的文繞圖功能：\n{{{\n[&lt;img[哈姆太郎在左邊|images/ham.gif]]\n[&gt;img[PHP 
Logo 
在右邊|images/php-logo.gif]]\n}}}\n[&lt;img[哈姆太郎在左邊|images/ham.gif]]
[&gt;img[PHP Logo 在右邊|images/php-logo.gif]]在這個例子裡，可以看到感動的哈姆太郎在段落的左邊，而 
PHP 的標幟則是在段落的右邊。至於靠左或靠右，則是由 img 前面的小於符號及大於符號決定。</div>
<div tiddler="擴充套件" modified="200511101031" modifier="YourName" tags="Introduction 擴充套件">自
從 1.2.23 版起，TiddlyWiki 做了一次大幅的改版。這次的改版讓 Tidder 可以放入程式碼來擴充他的功能，於是乎網路上的 
~TiddlyWiki-er 
基於各式各樣的需求，調配出了各式各樣的[[擴充套件]]。\n\n各種的[[擴充套件]]基本上可以分成[[外掛程式]](''Plugins'')和
[[自訂巨集]](''Macros'')兩種。他們都是一些 JavaScript 程式，如果這些程式能直接擴充 TiddlyWiki 
的功能，例如 WikiBarPlugin 
，就稱為[[外掛程式]]。另外，如果是提供除了內建[[巨集]]之外的其它擴充的[[巨集]]功能，則稱為[[自訂巨集]]。\n
\n&lt;&lt;tiddler 新增擴充套件&gt;&gt;</div>
<div tiddler="新增擴充套件" modified="200511041521" modifier="YourName" tags="Introduction 如何做系列 擴充套件">新
增擴充套件的方法很簡單，因為這些[[擴充套件]]的程式碼都放在 Tiddler 裡，所以，只要在自己的 TiddlyWiki 裡面開啟一個新的 
Tiddler ，將找到的擴充套件程式碼複製到裡面，再經過一點小設定就行了。詳細步驟說明如下：\n\n#找到你要的擴充套件，使用編輯功能進入 
Tiddler ，將內容完全複製。\n#在自己的 TiddlyWiki 建立一個新的 Tiddler 
，給它適當的標題，並將複製的程式碼貼入編輯區。\n#替這個 Tiddler @@color(#ff3300):加上 systemConfig 
標籤@@。這個步驟超重要，絕對不能漏掉。\n#完成 Tiddler 
編輯，''儲存變更''後，重新整理網頁。\n完成！此時擴充套件應該生效了。\n\n這裡特別精選了幾個擴充套件如下：\n|!擴充套件名稱|!擴充套
件|!說明|\n|[[WikiBarPlugin 外掛]]|WikiBarPlugin|提供 Tiddler 編輯工具列，讓你編輯 
Tiddler 時不必死記各種 wiki 語法。|\n|[[DisplayDefaultMacro 
自訂巨集]]|DisplayDefaultMacro|建立一個超連結可以關閉所有開啟中的 Tiddler ，然後開啟 
DefaultTiddlers 裡的所有 Tiddler 。|\n|[[ListTagsMacro 
自訂巨集]]|ListTagsMacro|可以列出某個標籤的所有 Tiddler 連結。有了這個巨集， TiddlyWiki 
的應用空間大大的提昇了。|\n|[[CalendarPlugin 
自訂巨集]]|CalendarPlugin|產生一個年曆或月曆，並且每個日期都是一個 Tiddler 連結，可以應用在製作日誌方面。|</div>
<div tiddler="更新" modified="200511031648" modifier="lss" tags="Introduction 如何做系列">如
同其它軟體一樣，TiddlyWiki 也會更新版本。就在最近，官方網站推出了新的 1.2.37 
版本。新的版本會更正一些已經發現的問題，或是推出新功能。關於新版本的 ~ChangeLog ，都會固定在 
http://www.tiddlywiki.com/dev 裡說明。\n\n要更新 TiddlyWiki 
，請依照下面的步驟：\n\n#先確定''偏好設定''裡的''儲存備份''是否已經勾選？若沒有，記得要先勾選。\n#做''儲存變更''。這兩個步驟
是為了萬一更新後有任何不正常的地方，可以由備分檔還原。\n#請參照[[如何開始]]裡的方法下載新版的 TiddlyWiki 
。但是存檔時，@@color(#cc0000):請選擇覆寫目前正在使用的 TiddlyWiki 
檔案@@。\n#下載完成後，再做一次''儲存變更''，然後重新整理一次網頁即可。\n\n&lt;&lt;tiddler 
更新的原理&gt;&gt;</div>
<div tiddler="更新的原理" modified="200511031655" modifier="lss" tags="Introduction 如何做系列">TiddlyWiki
 在執行時，是把整個網頁檔案載入記憶體中執行。所以，當我們下載新版的 TiddlyWiki 並覆蓋舊版檔案時， TiddlyWiki 
檔變成新版的程式而沒有任何的 Tiddler 。但是所有的 Tiddler 
內容都還保留在記憶體中。此時，只要再做''儲存變更''便可以把記憶體裡的所有 Tiddler 內容再次寫回新版的 TiddlyWiki 
檔案裡。\n\n這就是更新版本所用的原理，也是官方網站裡所提供的更新步驟。</div>
<div tiddler="格式化文字" modified="200511031517" modifier="lss" tags="Introduction howto 如何做系列 wiki語法">TiddlyWiki
 
支援各種的文字格式處理：\n*在文字前後加上兩個單引號可以產生''粗體字''效果如下：\n{{{\n''粗體字''\n}}}\n\n*在文字前後
加上兩個等號可以產生==刪除線==效果如下：\n{{{\n==加上刪除線==\n}}}\n\n*在文字前後加上兩個底線符號可以產生__底線文字
__的效果如下：\n{{{\n__底線文字__\n}}}\n\n*在文字前後加上兩個斜線可以產生//斜體字//效果如下：\n{{{\n//斜體字
//\n}}}\n\n*在文字前後加上兩個指數符號可以產生^^上標字^^效果如下：\n{{{\n^^上標字效果^^\n}}}\n\n*在文字前後
加上兩個蝌蚪符號可以產生~~下標字~~效果如下：\n{{{\n~~下標字效果~~\n}}}\n\n*在文字前後加上兩個 at 符號，並使用 
color(顏色代碼): 
，可以替@@color(green):文字改變顏色@@，效果如下：\n{{{\n@@color(顏色代碼):文字@@\n}}}\n\n*同樣地，
在文字前後加上兩個 at 符號，並使用 bgcolor(顏色代碼): 
，可以替@@bgcolor(red):文字改變背景色@@，效果如下：\n{{{\n@@bgcolor(顏色代碼):文字@@\n}}}</div>
<div tiddler="標籤" modified="200511031520" modifier="lss" tags="Introduction 如何做系列">標
籤讓我們可以對 Tiddler 做目錄分類。我們可以在這個 Tiddler 下面看到 "Introduction" 和 "howto" 
兩個標籤，由此可知， Tiddler 是可以有多個標籤的。\n\n另外，如果我們用滑鼠點選標籤，則會列出所有貼上這個標籤的 Tiddler 
。你可以開啟其中一個 Tiddler ，或將它們一次全部開啟。\n\n要替 Tiddler 
加上標籤，可以在編輯模式時，由下方的''標籤''連結選取所有現有的任何標籤加上，或是直接在標籤列輸入標籤名稱。是不是這樣就建立一個新的標籤了？沒
錯，就是這樣。\n\n要注意，標籤與標籤之間要加上空格。如果籤包含空格，則比照 FreeLink 
的方式，在前後加上兩個中括弧。\n\n另外，請參考[[特殊標籤]]。</div>
<div tiddler="標題" modified="200511031518" modifier="lss" tags="Introduction wiki語法 如何做系列">這
裡的[[標題]]，是對應到 HTML 裡的 &lt;H1&gt; 到 &lt;h5&gt; 
標籤。要建立標題很簡單，只要使用驚嘆號(!)即可。看範例最清楚：\n\n!標題 1\n!!標題 2\n!!!標題 3\n!!!!標題 
4\n!!!!!標題 5\n\n{{{\n!標題 1\n!!標題 2\n!!!標題 3\n!!!!標題 4\n!!!!!標題 5\n}}}</div>
<div tiddler="樣式" modified="200511031521" modifier="lss" tags="Introduction 如何做系列">你
可能對 TiddlyWiki 預設的以白色和棕色為主的樣式有意見， TiddlyWiki 的網站配色採用 CSS 樣式表的方式處理。而修改的 
CSS 代碼則可以放在 StyleSheet 這個特殊的 Tiddler 
。完成後[[儲存變更]]並重新整理網頁便可以看到更新後的效果。\n\n關於 CSS 樣式修改並不包括在本站的教學內容。建議可以參觀 
[[W3Schools|http://www.w3schools.com/css]] 的網站，裡面有很豐富的教學及參考資料。另外，也建議使用 
FireFox 搭配 web developer plugin ，可以很快的找到要改的 CSS ID，蠻方便的。</div>
<div tiddler="歡迎" modified="200510060956" modifier="YourName" tags="Introduction">歡
迎來到 TiddlyWiki [[使用教學]]中文版。這個網站主要內容為翻譯自 
[[TiddlyWikiTutorial|http://www.blogjones.com/TiddlyWikiTutorial.html]] 
網站，加上個人的一些心得，為 TiddlyWiki 的基本使用教學。當然，你所看到的內容，全部都是只用 TiddlyWiki 
所建立的，完全不需要任何其它的東西。\n\n如果你已經熟悉 TiddlyWiki 的用法，想看看其它網站的資料，在左側主選單裡，有我收集的 
[[TiddlyWiki 相關連結|TiddlyWikiLink]]。如果你是第一次接觸 TiddlyWiki 
，那麼，歡迎繼續參觀本站，希望內容讓你滿意。\n\n整個教學網站的內容，都是依據''一般使用者''的角度撰寫，所以對於進階的 
TiddlyWiki 調校、新增巨集或外掛、甚至是如何寫外掛…等，這裡是找不到的。請移駕到 [[TiddlyWiki 
相關連結|TiddlyWikiLink]] 找找看。建議可以加入[[TiddlyWiki 的中文 google 
group|http://groups.google.com/group/PrinceTiddlyWiki]]\n\n根據官方網站的說
法，TiddlyWiki 最好是使用 FireFox 操作才能發揮最大的效果，但是在 IE 瀏覽器或其他瀏覽器如 Safari 、 Oprea 
等也大都能正常工作。推薦使用 FireFox ，它是一個自由、免費、值得你下載使用的瀏覽器。\n\n接下來讓我們看看什麼是 TiddlyWiki
 。</div>
<div tiddler="水平線" modified="200511031519" modifier="lss" tags="Introduction 如何做系列 wiki語法">畫一條[[水平線]]做分隔線最簡單不過。只要在行開頭單行用四個減號(-)就行了。像這樣：\n{{{\n----\n}}}\n----</div>
<div tiddler="特殊標籤" modified="200510061732" modifier="lss" tags="Introduction howto">[[標
籤]]除了可以用來做 Tiddler 的分類整理，有幾個[[特殊標籤]]，還具有特殊的效果。\n\n*excludeSearch：加上這個標籤，
 Tiddler 就不會出現在搜尋的結果裡，可以用來隱藏不想讓人找到的 Tiddler 。\n*systemConfig：加上這個標籤的 
Tiddler 內容為 javascript 程式碼，用途則為[[自訂巨集]]。\n*systemTiddler：具有這個標籤的 Tiddler
 內容都具有特殊用途，像[[網站標題]]的 SiteTitle ，[[網站副標題]]的 SiteSubtitle ，左側[[主選單]]的 
MainMenu ，[[首頁預設 Tiddler]]的 DefaultTiddlers 等。當使用''進階選項''裡的''儲存範本''建立全新的
 TiddlyWiki 時，systemTiddler 標籤的 Tiddler 是唯一會複製到範本檔案的 Tiddler 
。\n*excludeLists：加上這個標籤的 Tiddler 便不會出現在 SideBar 的列表裡了。</div>
<div tiddler="網站副標題" modified="200510061722" modifier="lss" tags="Introduction">同樣地，網站副標題也是放在一個特殊的 Tiddler 裡面，你應該也猜到了： SiteSubtitle 。\n\n請依照修改網站主標題的方法，在 SiteSubtitle 裡修改網站副標題。別忘了要[[儲存變更]]，並重新整理網頁，才能看到更新的結果。</div>
<div tiddler="網站標題" modified="200510061722" modifier="lss" tags="Introduction">網
站的標題放在一個特殊的 Tiddler 裡面： SiteTitle 。\n\n現在你可以用滑鼠點選 SiteTitle ，然後在出現的 
Tiddler 裡面修改你的網站標題，修改完成後，在右側的 SideBar 
裡找到[[儲存變更]]，將修改結果存檔，最後，重新整理一次網頁。瞧！網站標題改好了。</div>
<div tiddler="網站設定" modified="200510130921" modifier="YourName" tags="systemTiddlers">[[網站標題|SiteTitle]]\n[[網站副標題|SiteSubtitle]]\n[[預設載入條目|DefaultTiddlers]]\n[[修改主選單|MainMenu]]\n[[修改網址|SiteUrl]](製作RSS Feed時會用到)</div>
<div tiddler="縮排" modified="200511031518" modifier="lss" tags="Introduction wiki語法 如何做系列">縮
排在網頁裡，通常用在回覆的引言。使用上也是很簡單，只要在每行的開頭加上大於符號(&gt;)就可以了。使用多個大於符號還可以建立多層縮排的效果。不
廢話，看例子：\n\n歡迎\n&gt;歡迎來到 TiddlyWiki 使用教學中文版。這個網站主要內容為翻譯自 
TiddlyWikiTutorial 網站，加上個人的一些心得，為 TiddlyWiki 的基本使用教學。\n&gt;&gt;如果你已經熟悉 
TiddlyWiki 的用法，想看看其它網站的資料，在左側主選單裡，有我收集的 TiddlyWiki 相關連結。如果你是第一次接觸 
TiddlyWiki 
，那麼，歡迎繼續參觀本站，希望內容讓你滿意。\n&gt;&gt;&gt;整個教學網站的內容，都是依據一般使用者的角度撰寫，所以對於進階的 
TiddlyWiki 調校、新增巨集或外掛、甚至是如何寫外掛…等，這裡是找不到的。請移駕到 TiddlyWiki 相關連結 
找找看。建議可以加入TiddlyWiki 的中文 google group\n&gt;根據官方網站的說法，TiddlyWiki 最好是使用 
FireFox 操作才能發揮最大的效果，但是在 IE 瀏覽器或其他瀏覽器如 Safari 、 Oprea 等也大都能正常工作。推薦使用 
FireFox ，它是一個自由、免費、值得你下載使用的瀏覽器。\n\n為了不浪費版面，這個例子的寫法請自己用編輯 Tiddler 
的方法觀看。\n\n如果要縮排的文字段落包括很多行，要在每行的開頭都加上大於符號是很麻煩的。沒關係，我們有個省力的寫法：用單行連續三個小寫符號
(&lt;&lt;&lt;)放在要縮排文章的上面和下面。格式如下：\n\n{{{\n&lt;&lt;&lt;\n第一個文章段落…\n…\n第 n
 個文章段落…\n&lt;&lt;&lt;\n}}}</div>
<div tiddler="自訂巨集" modified="200511031659" modifier="lss" tags="Introduction howto">除
了內建巨集之外， TiddlyWIki 
可以讓我們建立[[自訂巨集]]，擴充額外的功能。\n\n因為這個教學內容定位為''一般使用者''，也就是利用現成的 TiddlyWiki 
功能，並專注在內容的建置而不是功能的改造。有關利用[[自訂巨集]]擴充功能的部份，請參考相關網站：\n\n&lt;&lt;tiddler 
"TiddlyWiki 相關連結"&gt;&gt;</div>
<div tiddler="表格" modified="200511031518" modifier="lss" tags="Introduction 如何做系列 wiki語法">要
建立[[表格]]，只要在儲存格的兩側加上垂直線(|)，就是鍵盤上，用 Shift + 反斜線(\s) 
才能按出來的那個符號。要製作表格之前，建議先畫個草稿，再依草稿製作。下面是一個有合併儲存格的表格範例：\n\n|在第二個垂直線的後面加上小寫的英
文字母 c 
，則變成表格的標題|c\n|!標題儲存格：加一個驚嘆號(!)在第一個垂直線的後面，儲存格就變成標題儲存格。|!標題2|!標題3|\n| 
開頭有空白代表靠右對齊| 兩邊有空白代表置中 |結尾有空白代表靠左 
|\n|&gt;|&gt;|要橫向合併儲存格，則是在被合併的儲存格裡加上大於符號(&gt;)|\n|要縱向合併儲存格，則是在被合併的儲存格裡加上
蝌蚪符號(~)|&gt;|另一個靠左對齊的例子 |\n|~|&gt;| 
另一個靠右對齊的例子|\n|&gt;|&gt;|bgcolor(green):儲存格的背景顏色可以用bgcolor(顏色代碼): 
指定|\n\n上面的表格範例寫法如下：\n{{{\n|在第二個垂直線的後面加上小寫的英文字母 c 
，則變成表格的標題|c\n|!標題儲存格：加一個驚嘆號(!)在第一個垂直線的後面，儲存格就變成標題儲存格。|!標題2|!標題3|\n| 
開頭有空白代表靠右對齊| 兩邊有空白代表置中 |結尾有空白代表靠左 
|\n|&gt;|&gt;|要橫向合併儲存格，則是在被合併的儲存格裡加上大於符號(&gt;)|\n|要縱向合併儲存格，則是在被合併的儲存格裡加上
蝌蚪符號(~)|&gt;|另一個靠左對齊的例子 |\n|~|&gt;| 
另一個靠右對齊的例子|\n|&gt;|&gt;|bgcolor(green):儲存格的背景顏色可以用bgcolor(顏色代碼): 
指定|\n}}}</div>
<div tiddler="註解" modified="200511031531" modifier="lss" tags="Introduction wiki語法 如何做系列">有
時， Tiddler 
裡的內容寫到一半想先存起來，但不想被看到，這時就可以用''註解''的語法來@@隱藏@@內容。\n\n註解的語法如下：\n{{{\n/% 
不想被看到的內容 %/\n}}}\n\n這篇 Tiddler 
裡隱藏了一小段內容，請使用編輯功能查看。\n\n/%\n看不到，看不到，就是看不到！\n\n哇！被你看到了。那你應該學會註解語法了。\n%/</div>
<div tiddler="認識環境" modified="200510051351" modifier="YourName" tags="Introduction">TiddlyWiki
 的版面，主要分成四個部份：\n*標題區：包含主標題與副標題。\n*左側主選單：這裡可以讓我們設定導覽整個網站的超連結。\n*中央內容區：所有的
 Tiddler 都會出現在這一區。\n*右側 SideBar 區：這裡包括許多不同的功能，這部份請看 SideBar 
的詳細介紹。\n\n當我們把滑鼠移到一個 Tiddler 的範圍時，可以在 Tiddler 
的左上方看到四個連結，這四個連結的功能如下：\n*關閉：把目前的 Tiddler 關掉。當看完一個 Tiddler 
之後，可以直接關閉它，把版面空出來顯示其它 Tiddler 。\n*編輯：讓 Tiddler 進入編輯模式。\n*引用連結：在網址列顯示這個 
Tiddler 的連結。當我們或別人想在 TiddlyWiki 之外直接連至網站裡的 Tiddler 
時，就會用到它。\n*引用：列出所有連到這篇文章的 Tiddler 。</div>
<div tiddler="關於我" modified="200510062252" modifier="lss" tags="about">李順孝，內壢高中電腦科教師。\n\n電子郵件： lsslss@gmail.com</div>
<div tiddler="關於本站" modified="200510071315" modifier="YourName" tags="about">這
個使用教學，是為了個人教學上的需要所製作的。準備在課堂上推廣給學生使用。\n\n因為發現，網路上的中文資源，
[[BramChen|http://bram.cozysite.com/ptw/]] 
的站似乎比較適合進階玩家，而[[MilchFlasche|http://linshi.twbbs.org/usr/m/milchflasche
/TiddlyWiki.html]] 的站很吸引人，讓人很想趕快去體驗 TiddlyWiki 的威力，但是對 wiki 
這個領域完全不熟悉的人會找不到施力點。\n\n後來到了官網介紹的 
[[TiddlyWikiTutorial|http://www.blogjones.com/TiddlyWikiTutorial.html]] 
，詳讀之後，終於對 TiddlyWiki 有了比較深入而清楚的認識。可惜這是一個英文網站，所以花了三天的時間把這幾天的心得用 
[[TiddlyWikiTutorial|http://www.blogjones.com/TiddlyWikiTutorial.html]] 
的架構寫下來。做為上課用的教材。\n\n既然做好了，當然不能藏私。畢竟取之於網路，就要回饋回網路。\n\n[&lt;img[姓名標
示|images/by.gif]][&lt;img[非商業性|images/nc.gif]][&lt;img[相同方式分享|images
/sa.gif]]本站裡的一切內容，由本人撰寫的，一律以 ''姓名標示-非商業性-相同方式分享 2.0 台灣 
(~Attribution-NonCommercial-ShareAlike 2.0 Taiwan)'' 
方式分享。非由本人撰寫的部份會列出原作及出處。如有疏漏，煩請告知，定當立即改進。連絡方式請看[[關於我]]。\n\nTiddlyWiki 
版本：&lt;&lt;version&gt;&gt;\n\n本站新增 
[img[RSS|images/rss.gif][TiddlyWikiTutorialTW.xml]] ，歡迎利用。</div>
<div tiddler="首頁預設 Tiddler" modified="200510061723" modifier="lss" tags="Introduction">當
我們開啟 TiddlyWiki 之後，除了左邊的主選單和右邊的 SideBar 之外，中間會出現我們所設定的 Tiddler 
。以本站為例，預設開啟時會出[[歡迎]]和 TiddlyWiki 兩個 Tiddler。\n\n這個設定也是放在一個特殊的 Tiddler 
裡面： DefaultTiddlers 。\n\n接下來，請修改 DefaultTiddlers ，裡面是 Tiddler 列表，每行一個 
Tiddler 。當開啟 TiddlyWiki 時，在這裡所列出的 Tiddler 就會顯示在中央區域。\n\n關於 Tiddler 
的詳細說明，請參考[[如何建立一個 Tiddler]]教學。</div>
		</div>
	

<div id="colorMap" style="display:none; position:absolute; left:0px; top:0px; z-index:99; margin:0px; padding:0px; cursor:crosshair;"><table style="border:solid 1px black;" cellspacing="0" cellpadding="0"><tr><td style="border:solid 1px black;" bgcolor="#FFFFFF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#DDDDDD"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CCCCCC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#BBBBBB"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#AAAAAA"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#999999"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#666666"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#333333"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#111111"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#000000"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FFCC00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF9900"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF6600"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF3300"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC3300"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC0033"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" bgcolor="#99CC00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#99DD00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#99EE00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#EE9900"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#DD9900"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC9900"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FFCC33"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FFCC66"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF9966"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF6633"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#660000"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#990000"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC0000"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF0000"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF3366"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF0033"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" bgcolor="#CCFF00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CCFF33"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#333300"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#666600"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#999900"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CCCC00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FFFF00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC9933"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC6633"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#330000"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#993333"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC3333"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF3333"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC3366"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF6699"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF0066"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" bgcolor="#99FF00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CCFF66"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#99CC33"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#666633"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#999933"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CCCC33"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FFFF33"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#996600"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#993300"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#663333"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC6666"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF6666"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#990033"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC3399"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF66CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF0099"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" bgcolor="#66FF00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#99FF66"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#66CC33"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#669900"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#999966"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CCCC66"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FFFF66"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#996633"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#663300"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#996666"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF9999"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF3399"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC0066"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#990066"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF33CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF00CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" bgcolor="#33FF00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#66FF33"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#339900"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#66CC00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#99FF33"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CCCC99"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FFFF99"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC9966"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC6600"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC9999"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF99CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC6699"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#993366"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#660033"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC0099"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#330033"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" bgcolor="#00CC00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#33CC00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#336600"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#669933"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#99CC66"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CCFF99"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FFFFCC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FFCC99"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF9933"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FFCCCC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC99CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#996699"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#993399"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#990099"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#663366"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#660066"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" bgcolor="#006600"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#33CC33"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#66CC66"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#00FF00"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#33FF33"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#66FF66"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#99FF99"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CCFFCC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#99CCFF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FFCCFF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF99FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF66FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF33FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#FF00FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC66CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC33CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" bgcolor="#003300"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#336633"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#009900"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#339933"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#669966"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#99CC99"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CCFFFF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#3399FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#6699CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CCCCFF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC99FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#9966CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#663399"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#330066"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#9900CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC00CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" bgcolor="#00FF33"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#00CC33"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#006633"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#339966"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#66CC99"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#99FFCC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#99CCCC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#0066CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#336699"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#9999FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#9999CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#9933FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#6600CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#660099"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC33FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC00FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" bgcolor="#00FF66"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#33FF66"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#009933"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#00CC66"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#33FF99"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#99FFFF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#669999"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#003366"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#003399"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#6666FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#6666CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#666699"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#330099"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#9933CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#CC66FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#9900FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" bgcolor="#00FF99"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#66FF99"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#33CC66"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#009966"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#66FFFF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#66CCCC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#336666"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#006699"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#3366CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#3333FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#3333CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#333399"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#333366"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#6633CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#9966FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#6600FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" bgcolor="#00FFCC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#66FFCC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#33CC99"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#33FFFF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#33CCCC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#339999"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#003333"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#3399CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#6699FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#0000FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#0000CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#000099"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#000066"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#000033"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#6633FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#3300FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" bgcolor="#00CC99"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#33FFCC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#00FFFF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#00CCCC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#009999"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#006666"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#33CCFF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#66CCFF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#0099CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#3366FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#00CCFF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#0099FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#0066FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#0033FF"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#0033CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td><td style="border:solid 1px black;" bgcolor="#3300CC"><span style="font-size:8px">&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td style="border:solid 1px black;" colspan="16" bgcolor="white"><center><span style="font-size:10px;">close</span></center></td></tr></table></div></body></html>